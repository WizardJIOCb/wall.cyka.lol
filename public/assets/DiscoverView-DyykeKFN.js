import{r,w as V,f as F,e as W,g as n,k as e,t as l,O as S,V as B,s as H,W as R,G as j,X as x,F as T,x as D,u as K,U as q,j as M,i as a}from"./vendor-B5QdKGWw.js";import{g as z,b as g,_ as G}from"./index-CN8zmFAe.js";import"./utils-i9HKr1_Q.js";function O(h,w=300){const u=r(h),c=r(h);let i=null;return V(u,d=>{i&&clearTimeout(i),i=setTimeout(()=>{c.value=d},w)}),{value:u,debouncedValue:c,clearDebounce:()=>{i&&(clearTimeout(i),i=null)}}}const Q={class:"discover-view"},X={class:"discover-header"},A={class:"search-section"},J={class:"search-container"},Y=["placeholder"],Z={class:"content-section"},I={class:"section-header"},ss={key:0,class:"loading-container"},es={key:1,class:"empty-state"},ts={key:2,class:"walls-carousel"},os=["onClick"],ns={class:"wall-content"},as={class:"wall-owner"},ls={key:0,class:"wall-desc"},is={class:"wall-stats"},rs={class:"content-section"},cs={key:0,class:"loading-container"},us={key:1,class:"empty-state"},ds={key:2,class:"posts-grid"},vs={class:"post-header"},_s=["src","alt"],ps={class:"post-meta"},fs={class:"post-author"},gs={class:"post-time"},ms={class:"post-content"},hs=["innerHTML"],ws={key:1},ys={class:"post-actions"},bs={class:"action-btn"},ks={class:"action-btn"},$s={class:"action-btn"},Ts={class:"content-section"},Ds={key:0,class:"loading-container"},Cs={key:1,class:"empty-state"},Us={key:2,class:"users-grid"},Ss=["src","alt"],Ms={class:"user-username"},Vs={key:0,class:"user-bio"},Ls={class:"user-stats"},Ps=["onClick"],Ns=F({__name:"DiscoverView",setup(h){const w=K(),u=z(),{value:c,debouncedValue:i}=O("",300),m=r("7d"),d=r([]),p=r([]),v=r([]),y=r(!1),b=r(!1),k=r(!1),L=o=>{const s=new Date(o),_=new Date().getTime()-s.getTime(),f=Math.floor(_/36e5),U=Math.floor(_/864e5);return f<1?"just now":f<24?`${f}h ago`:U<7?`${U}d ago`:s.toLocaleDateString()},$=()=>{i.value.trim().length>=2?w.push(`/search?q=${encodeURIComponent(i.value)}`):c.value.trim().length>0&&c.value.trim().length<2&&u.warning("Please enter at least 2 characters to search")};V(i,o=>{o.trim().length>=2&&$()});const C=async()=>{var o;try{y.value=!0;const s=await g.get(`/discover/trending-walls?timeframe=${m.value}&limit=6`);s&&s.data?d.value=s.data.walls||((o=s.data.data)==null?void 0:o.walls)||[]:d.value=[]}catch(s){console.error("Error loading trending walls:",s),d.value=[]}finally{y.value=!1}},P=async()=>{var o;try{b.value=!0;const s=await g.get("/discover/popular-posts?timeframe=7d&limit=10");s&&s.data?p.value=s.data.posts||((o=s.data.data)==null?void 0:o.posts)||[]:p.value=[]}catch(s){console.error("Error loading popular posts:",s),p.value=[]}finally{b.value=!1}},N=async()=>{var o;try{k.value=!0;const s=await g.get("/discover/suggested-users?limit=8");s&&s.data?v.value=s.data.users||((o=s.data.data)==null?void 0:o.users)||[]:v.value=[]}catch(s){console.error("Error loading suggested users:",s),v.value=[]}finally{k.value=!1}},E=async o=>{try{const s=v.value.find(f=>f.user_id===o);if(!s)return;const t=s.is_following,_=s.followers_count;s.is_following=!t,s.followers_count+=s.is_following?1:-1,t?(await g.delete(`/users/${o}/follow`),u.success("Unfollowed successfully")):(await g.post(`/users/${o}/follow`),u.success("Following successfully"))}catch(s){const t=v.value.find(_=>_.user_id===o);t&&(t.is_following=!t.is_following,t.followers_count+=t.is_following?1:-1),u.error(s.message||"Failed to update follow status")}};return W(()=>{C(),P(),N()}),(o,s)=>(a(),n("div",Q,[e("div",X,[e("h1",null,l(o.$t("navigation.discover")),1)]),e("div",A,[e("div",J,[S(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>j(c)?c.value=t:null),type:"text",placeholder:o.$t("common.actions.search")+"...",onKeyup:R($,["enter"]),class:"search-input"},null,40,Y),[[B,H(c)]]),e("button",{onClick:$,class:"search-button"}," 🔍 ")])]),e("section",Z,[e("div",I,[s[3]||(s[3]=e("h2",null,"🔥 Trending Walls",-1)),S(e("select",{"onUpdate:modelValue":s[1]||(s[1]=t=>m.value=t),onChange:C,class:"timeframe-select"},[...s[2]||(s[2]=[e("option",{value:"24h"},"Last 24 hours",-1),e("option",{value:"7d"},"Last 7 days",-1),e("option",{value:"30d"},"Last 30 days",-1)])],544),[[x,m.value]])]),y.value?(a(),n("div",ss,[...s[4]||(s[4]=[e("div",{class:"spinner"},null,-1)])])):d.value.length===0?(a(),n("div",es,[...s[5]||(s[5]=[e("p",null,"No trending walls found",-1)])])):(a(),n("div",ts,[(a(!0),n(T,null,D(d.value,t=>(a(),n("div",{key:t.wall_id,class:"wall-card",onClick:_=>o.$router.push(`/wall/${t.wall_id}`)},[e("div",{class:"wall-banner",style:q({background:t.theme||"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"})},null,4),e("div",ns,[e("h3",null,l(t.display_name),1),e("p",as,"@"+l(t.owner_username),1),t.description?(a(),n("p",ls,l(t.description),1)):M("",!0),e("div",is,[e("span",null,"📝 "+l(t.post_count||0),1),e("span",null,"👥 "+l(t.follower_count||0),1),e("span",null,"👁️ "+l(t.view_count||0),1)])])],8,os))),128))]))]),e("section",rs,[s[11]||(s[11]=e("div",{class:"section-header"},[e("h2",null,"⭐ Popular Posts")],-1)),b.value?(a(),n("div",cs,[...s[6]||(s[6]=[e("div",{class:"spinner"},null,-1)])])):p.value.length===0?(a(),n("div",us,[...s[7]||(s[7]=[e("p",null,"No popular posts found",-1)])])):(a(),n("div",ds,[(a(!0),n(T,null,D(p.value,t=>(a(),n("div",{key:t.post_id,class:"post-card"},[e("div",vs,[e("img",{src:t.author_avatar||"/assets/images/default-avatar.svg",alt:t.author_username,class:"post-avatar"},null,8,_s),e("div",ps,[e("span",fs,"@"+l(t.author_username),1),e("span",gs,l(L(t.created_at)),1)])]),e("div",ms,[t.content_html?(a(),n("div",{key:0,innerHTML:t.content_html},null,8,hs)):(a(),n("p",ws,l(t.content_text),1))]),e("div",ys,[e("button",bs,[s[8]||(s[8]=e("span",null,"👍",-1)),e("span",null,l(t.reaction_count||0),1)]),e("button",ks,[s[9]||(s[9]=e("span",null,"💬",-1)),e("span",null,l(t.comment_count||0),1)]),e("button",$s,[s[10]||(s[10]=e("span",null,"👁️",-1)),e("span",null,l(t.view_count||0),1)])])]))),128))]))]),e("section",Ts,[s[14]||(s[14]=e("div",{class:"section-header"},[e("h2",null,"👥 Suggested Users")],-1)),k.value?(a(),n("div",Ds,[...s[12]||(s[12]=[e("div",{class:"spinner"},null,-1)])])):v.value.length===0?(a(),n("div",Cs,[...s[13]||(s[13]=[e("p",null,"No user suggestions available",-1)])])):(a(),n("div",Us,[(a(!0),n(T,null,D(v.value,t=>(a(),n("div",{key:t.user_id,class:"user-card"},[e("img",{src:t.avatar_url||"/assets/images/default-avatar.svg",alt:t.username,class:"user-avatar"},null,8,Ss),e("h3",Ms,"@"+l(t.username),1),t.bio?(a(),n("p",Vs,l(t.bio),1)):M("",!0),e("div",Ls,[e("span",null,l(t.followers_count||0)+" followers",1),e("span",null,l(t.posts_count||0)+" posts",1)]),e("button",{onClick:_=>E(t.user_id),class:"btn-follow"},l(t.is_following?o.$t("common.actions.unfollow"):o.$t("common.actions.follow")),9,Ps)]))),128))]))])]))}}),Bs=G(Ns,[["__scopeId","data-v-d65cabda"]]);export{Bs as default};
//# sourceMappingURL=DiscoverView-DyykeKFN.js.map
