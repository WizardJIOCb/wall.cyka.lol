import{f as J,r as d,b as K,e as Q,g as i,k as e,t as o,F as _,x as y,j as b,O as m,V as f,X as D,S as T,n as k,U as Y,i as c}from"./vendor-B5QdKGWw.js";import{u as Z,h as x,i as ee,b as p,s as se,_ as ae}from"./index-kSWk4E7S.js";import"./utils-i9HKr1_Q.js";const te={class:"settings-view"},oe={class:"settings-header"},le={class:"settings-container"},ne={class:"tabs-nav"},ie=["onClick"],ce={class:"tab-icon"},re={class:"tab-label"},ue={class:"tab-content"},de={key:0,class:"tab-panel"},me={class:"panel-title"},pe={class:"form-section"},ve={class:"form-label"},be=["placeholder"],fe={class:"form-section"},he={class:"form-label"},ge=["placeholder"],_e={class:"form-section"},ye=["placeholder"],ke=["placeholder"],we=["placeholder"],$e={class:"form-section danger-zone"},Ce={class:"warning-text"},Se={key:1,class:"tab-panel"},Pe={class:"panel-title"},Ne={class:"form-section"},Ve={class:"char-count"},Ue={class:"form-section"},Ae={class:"avatar-upload"},Be=["src"],De={key:2,class:"tab-panel"},Te={class:"panel-title"},ze={class:"form-section"},Fe={value:"public"},Le={value:"private"},We={value:"followers"},Me={key:3,class:"tab-panel"},Ee={class:"panel-title"},Re={class:"form-section"},je={class:"checkbox-label"},Ge={class:"form-section"},He={class:"checkbox-label"},Oe={key:4,class:"tab-panel"},Xe={class:"panel-title"},qe={class:"form-section"},Ie={class:"form-label"},Je={class:"theme-selector"},Ke=["onClick"],Qe={class:"form-section"},Ye={class:"form-label"},Ze={class:"language-selector"},xe=["onClick"],es={class:"language-flag"},ss={class:"language-name"},as={class:"form-section"},ts={class:"form-label"},os={key:5,class:"tab-panel"},ls={class:"panel-title"},ns={class:"bricks-balance"},is={class:"balance-display"},cs={class:"balance-value"},rs=["disabled"],us={class:"transactions-section"},ds={key:0,class:"empty-state"},ms={key:1,class:"transactions-list"},ps={class:"settings-footer"},vs=["disabled"],bs=J({__name:"SettingsView",setup(fs){var V,U,A,B;const u=Z(),N=x(),v=d("appearance"),h=d(!1),w=d(ee()),z=[{id:"account",icon:"👤",label:"Account"},{id:"profile",icon:"📝",label:"Profile"},{id:"privacy",icon:"🔒",label:"Privacy"},{id:"notifications",icon:"🔔",label:"Notifications"},{id:"appearance",icon:"🎨",label:"Appearance"},{id:"bricks",icon:"🧱",label:"Bricks"}],F=[{code:"en",name:"English",flag:"🇬🇧"},{code:"ru",name:"Русский",flag:"🇷🇺"}],L=[{id:"light",name:"Light",color:"#ffffff"},{id:"dark",name:"Dark",color:"#1a1a1a"},{id:"green",name:"Green",color:"#10b981"},{id:"blue",name:"Blue",color:"#3b82f6"},{id:"cream",name:"Cream",color:"#fef3c7"},{id:"high-contrast",name:"High Contrast",color:"#000000"}],l=d({username:((V=u.user)==null?void 0:V.username)||"",email:((U=u.user)==null?void 0:U.email)||"",bio:((A=u.user)==null?void 0:A.bio)||"",defaultWallPrivacy:"public",emailNotifications:!0,pushNotifications:!0,fontSize:"medium"}),r=d({current:"",new:"",confirm:""}),$=d(N.currentTheme||"light"),W=K(()=>{var s;return((s=u.user)==null?void 0:s.avatar_url)||"/assets/images/default-avatar.svg"}),C=d(((B=u.user)==null?void 0:B.bricks_balance)||0),S=d(!0),M=d(""),P=d([]),E=async s=>{try{se(s),w.value=s,await p.patch("/users/me/settings",{language:s}),console.log("Language changed to:",s)}catch(a){console.error("Failed to save language preference:",a)}},R=s=>{$.value=s,N.setTheme(s)},j=async()=>{var s,a;if(r.value.new!==r.value.confirm){alert("Passwords do not match");return}try{await p.post("/users/me/change-password",{current_password:r.value.current,new_password:r.value.new}),r.value={current:"",new:"",confirm:""},alert("Password changed successfully")}catch(n){alert(((a=(s=n.response)==null?void 0:s.data)==null?void 0:a.message)||"Failed to change password")}},G=()=>{console.log("Avatar upload coming soon")},H=()=>{confirm("Are you sure you want to delete your account? This action cannot be undone.")&&O()},O=async()=>{var s,a;try{await p.delete("/users/me/account"),u.logout()}catch(n){alert(((a=(s=n.response)==null?void 0:s.data)==null?void 0:a.message)||"Failed to delete account")}},X=async()=>{var s,a;try{const n=await p.post("/bricks/claim");n.data.success&&(C.value=n.data.data.new_balance,S.value=!1)}catch(n){alert(((a=(s=n.response)==null?void 0:s.data)==null?void 0:a.message)||"Failed to claim daily bricks")}},q=async()=>{try{const[s,a]=await Promise.all([p.get("/bricks/balance"),p.get("/bricks/transactions?limit=10")]);s.success&&(C.value=s.data.balance,u.updateUser({bricks_balance:s.data.balance})),a.success&&(P.value=a.data.transactions||[])}catch(s){console.error("Failed to load bricks data:",s)}},I=async()=>{var s,a,n,t;try{h.value=!0,await p.patch("/users/me/settings",{theme:$.value,language:w.value,default_wall_privacy:l.value.defaultWallPrivacy,email_notifications:l.value.emailNotifications,push_notifications:l.value.pushNotifications,font_size:l.value.fontSize}),(l.value.username!==((s=u.user)==null?void 0:s.username)||l.value.email!==((a=u.user)==null?void 0:a.email))&&await p.patch("/users/me",{username:l.value.username,email:l.value.email,bio:l.value.bio}),alert("Settings saved successfully")}catch(g){alert(((t=(n=g.response)==null?void 0:n.data)==null?void 0:t.message)||"Failed to save settings")}finally{h.value=!1}};return Q(async()=>{try{const s=await p.get("/auth/me");s.success&&s.data.user&&u.updateUser(s.data.user)}catch(s){console.error("Failed to refresh user data:",s)}q()}),(s,a)=>{var n;return c(),i("div",te,[e("div",oe,[e("h1",null,o(s.$t("settings.title")),1)]),e("div",le,[e("div",ne,[(c(),i(_,null,y(z,t=>e("button",{key:t.id,class:k(["tab-button",{active:v.value===t.id}]),onClick:g=>v.value=t.id},[e("span",ce,o(t.icon),1),e("span",re,o(s.$t(`settings.tabs.${t.id}`)),1)],10,ie)),64))]),e("div",ue,[v.value==="account"?(c(),i("div",de,[e("h2",me,o(s.$t("settings.tabs.account")),1),e("div",pe,[e("label",ve,o(s.$t("settings.account.username")),1),m(e("input",{"onUpdate:modelValue":a[0]||(a[0]=t=>l.value.username=t),type:"text",class:"form-input",placeholder:s.$t("settings.account.username")},null,8,be),[[f,l.value.username]])]),e("div",fe,[e("label",he,o(s.$t("settings.account.email")),1),m(e("input",{"onUpdate:modelValue":a[1]||(a[1]=t=>l.value.email=t),type:"email",class:"form-input",placeholder:s.$t("settings.account.email")},null,8,ge),[[f,l.value.email]])]),e("div",_e,[e("h3",null,o(s.$t("settings.account.changePassword")),1),m(e("input",{"onUpdate:modelValue":a[2]||(a[2]=t=>r.value.current=t),type:"password",class:"form-input",placeholder:s.$t("settings.account.currentPassword")},null,8,ye),[[f,r.value.current]]),m(e("input",{"onUpdate:modelValue":a[3]||(a[3]=t=>r.value.new=t),type:"password",class:"form-input",placeholder:s.$t("settings.account.newPassword")},null,8,ke),[[f,r.value.new]]),m(e("input",{"onUpdate:modelValue":a[4]||(a[4]=t=>r.value.confirm=t),type:"password",class:"form-input",placeholder:s.$t("settings.account.confirmNewPassword")},null,8,we),[[f,r.value.confirm]]),e("button",{onClick:j,class:"btn-primary"},o(s.$t("common.buttons.update")),1)]),e("div",$e,[e("h3",null,o(s.$t("settings.account.deleteAccount")),1),e("p",Ce,o(s.$t("settings.account.deleteAccountWarning")),1),e("button",{onClick:H,class:"btn-danger"},o(s.$t("common.buttons.delete")),1)])])):b("",!0),v.value==="profile"?(c(),i("div",Se,[e("h2",Pe,o(s.$t("settings.tabs.profile")),1),e("div",Ne,[a[10]||(a[10]=e("label",{class:"form-label"},"Bio",-1)),m(e("textarea",{"onUpdate:modelValue":a[5]||(a[5]=t=>l.value.bio=t),class:"form-textarea",placeholder:"Tell us about yourself...",rows:"4",maxlength:"500"},null,512),[[f,l.value.bio]]),e("span",Ve,o(((n=l.value.bio)==null?void 0:n.length)||0)+"/500",1)]),e("div",Ue,[a[11]||(a[11]=e("label",{class:"form-label"},"Avatar",-1)),e("div",Ae,[e("img",{src:W.value,alt:"Avatar",class:"avatar-preview"},null,8,Be),e("button",{onClick:G,class:"btn-secondary"},o(s.$t("common.actions.upload")),1)])])])):b("",!0),v.value==="privacy"?(c(),i("div",De,[e("h2",Te,o(s.$t("settings.tabs.privacy")),1),e("div",ze,[a[12]||(a[12]=e("label",{class:"form-label"},"Default Wall Privacy",-1)),m(e("select",{"onUpdate:modelValue":a[6]||(a[6]=t=>l.value.defaultWallPrivacy=t),class:"form-select"},[e("option",Fe,o(s.$t("walls.public")),1),e("option",Le,o(s.$t("walls.private")),1),e("option",We,o(s.$t("walls.followers")),1)],512),[[D,l.value.defaultWallPrivacy]])])])):b("",!0),v.value==="notifications"?(c(),i("div",Me,[e("h2",Ee,o(s.$t("settings.tabs.notifications")),1),e("div",Re,[e("label",je,[m(e("input",{"onUpdate:modelValue":a[7]||(a[7]=t=>l.value.emailNotifications=t),type:"checkbox"},null,512),[[T,l.value.emailNotifications]]),a[13]||(a[13]=e("span",null,"Email Notifications",-1))])]),e("div",Ge,[e("label",He,[m(e("input",{"onUpdate:modelValue":a[8]||(a[8]=t=>l.value.pushNotifications=t),type:"checkbox"},null,512),[[T,l.value.pushNotifications]]),a[14]||(a[14]=e("span",null,"Push Notifications",-1))])])])):b("",!0),v.value==="appearance"?(c(),i("div",Oe,[e("h2",Xe,o(s.$t("settings.tabs.appearance")),1),e("div",qe,[e("label",Ie,o(s.$t("settings.appearance.theme")),1),e("div",Je,[(c(),i(_,null,y(L,t=>e("button",{key:t.id,class:k(["theme-option",{active:$.value===t.id}]),onClick:g=>R(t.id)},[e("span",{class:"theme-preview",style:Y({background:t.color})},null,4),e("span",null,o(t.name),1)],10,Ke)),64))])]),e("div",Qe,[e("label",Ye,o(s.$t("settings.appearance.language")),1),e("div",Ze,[(c(),i(_,null,y(F,t=>e("button",{key:t.code,class:k(["language-option",{active:w.value===t.code}]),onClick:g=>E(t.code)},[e("span",es,o(t.flag),1),e("span",ss,o(t.name),1)],10,xe)),64))])]),e("div",as,[e("label",ts,o(s.$t("settings.appearance.fontSize")),1),m(e("select",{"onUpdate:modelValue":a[9]||(a[9]=t=>l.value.fontSize=t),class:"form-select"},[...a[15]||(a[15]=[e("option",{value:"small"},"Small",-1),e("option",{value:"medium"},"Medium",-1),e("option",{value:"large"},"Large",-1)])],512),[[D,l.value.fontSize]])])])):b("",!0),v.value==="bricks"?(c(),i("div",os,[e("h2",ls,o(s.$t("settings.tabs.bricks")),1),e("div",ns,[e("div",is,[a[16]||(a[16]=e("span",{class:"balance-label"},"Current Balance",-1)),e("span",cs,o(C.value)+" 🧱",1)]),e("button",{onClick:X,disabled:!S.value,class:"btn-primary"},o(S.value?"Claim Daily Bricks":`Next claim in ${M.value}`),9,rs)]),e("div",us,[a[17]||(a[17]=e("h3",null,"Recent Transactions",-1)),P.value.length===0?(c(),i("div",ds," No transactions yet ")):(c(),i("div",ms,[(c(!0),i(_,null,y(P.value,t=>(c(),i("div",{key:t.id,class:"transaction-item"},[e("span",null,o(t.description),1),e("span",{class:k(["transaction-amount",t.amount>0?"positive":"negative"])},o(t.amount>0?"+":"")+o(t.amount)+" 🧱 ",3)]))),128))]))])])):b("",!0)])]),e("div",ps,[e("button",{onClick:I,class:"btn-primary btn-large",disabled:h.value},o(h.value?"Saving...":s.$t("common.buttons.save")),9,vs)])])}}}),ys=ae(bs,[["__scopeId","data-v-04aa16f5"]]);export{ys as default};
//# sourceMappingURL=SettingsView-gK2EdKtC.js.map
