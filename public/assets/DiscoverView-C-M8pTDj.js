import{e as V,r,i as N,f as a,k as s,t as l,N as C,U as P,W as E,X as W,F as w,s as y,V as B,S as F,h as D,o as n}from"./vendor-Cy2yCxOA.js";import{b as u,_ as H}from"./index-CKQhb95x.js";import"./utils-i9HKr1_Q.js";const K={class:"discover-view"},R={class:"discover-header"},j={class:"search-section"},q={class:"search-bar"},x=["placeholder"],z={class:"content-section"},Q={class:"section-header"},X={key:0,class:"loading-container"},A={key:1,class:"empty-state"},G={key:2,class:"walls-carousel"},I=["onClick"],J={class:"wall-content"},O={class:"wall-owner"},Y={key:0,class:"wall-desc"},Z={class:"wall-stats"},ss={class:"content-section"},ts={key:0,class:"loading-container"},es={key:1,class:"empty-state"},os={key:2,class:"posts-grid"},as={class:"post-header"},ns=["src","alt"],ls={class:"post-meta"},is={class:"post-author"},rs={class:"post-time"},ds={class:"post-content"},cs=["innerHTML"],us={key:1},vs={class:"post-actions"},_s={class:"action-btn"},ps={class:"action-btn"},fs={class:"action-btn"},gs={class:"content-section"},ms={key:0,class:"loading-container"},hs={key:1,class:"empty-state"},ws={key:2,class:"users-grid"},ys=["src","alt"],ks={class:"user-username"},bs={key:0,class:"user-bio"},$s={class:"user-stats"},Cs=["onClick"],Ds=V({__name:"DiscoverView",setup(Ts){const T=B(),v=r(""),f=r("7d"),_=r([]),p=r([]),d=r([]),g=r(!1),m=r(!1),h=r(!1),U=o=>{const e=new Date(o),i=new Date().getTime()-e.getTime(),c=Math.floor(i/36e5),$=Math.floor(i/864e5);return c<1?"just now":c<24?`${c}h ago`:$<7?`${$}d ago`:e.toLocaleDateString()},k=()=>{v.value.trim()&&T.push(`/search?q=${encodeURIComponent(v.value)}`)},b=async()=>{try{g.value=!0;const o=await u.get(`/discover/trending-walls?timeframe=${f.value}&limit=6`);o.data.success&&o.data.data.walls&&(_.value=o.data.data.walls)}catch(o){console.error("Error loading trending walls:",o),_.value=[]}finally{g.value=!1}},M=async()=>{try{m.value=!0;const o=await u.get("/discover/popular-posts?timeframe=7d&limit=10");o.data.success&&o.data.data.posts&&(p.value=o.data.data.posts)}catch(o){console.error("Error loading popular posts:",o),p.value=[]}finally{m.value=!1}},S=async()=>{try{h.value=!0;const o=await u.get("/discover/suggested-users?limit=8");o.data.success&&o.data.data.users&&(d.value=o.data.data.users)}catch(o){console.error("Error loading suggested users:",o),d.value=[]}finally{h.value=!1}},L=async o=>{var e,t;try{const i=d.value.find(c=>c.user_id===o);if(!i)return;i.is_following?(await u.delete(`/users/${o}/follow`),i.is_following=!1,i.followers_count--):(await u.post(`/users/${o}/follow`),i.is_following=!0,i.followers_count++)}catch(i){alert(((t=(e=i.response)==null?void 0:e.data)==null?void 0:t.message)||"Failed to update follow status")}};return N(()=>{b(),M(),S()}),(o,e)=>(n(),a("div",K,[s("div",R,[s("h1",null,l(o.$t("navigation.discover")),1)]),s("div",j,[s("div",q,[C(s("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>v.value=t),type:"text",placeholder:o.$t("common.actions.search")+"...",onKeyup:E(k,["enter"]),class:"search-input"},null,40,x),[[P,v.value]]),s("button",{onClick:k,class:"search-btn"},[...e[2]||(e[2]=[s("span",null,"🔍",-1)])])])]),s("section",z,[s("div",Q,[e[4]||(e[4]=s("h2",null,"🔥 Trending Walls",-1)),C(s("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>f.value=t),onChange:b,class:"timeframe-select"},[...e[3]||(e[3]=[s("option",{value:"24h"},"Last 24 hours",-1),s("option",{value:"7d"},"Last 7 days",-1),s("option",{value:"30d"},"Last 30 days",-1)])],544),[[W,f.value]])]),g.value?(n(),a("div",X,[...e[5]||(e[5]=[s("div",{class:"spinner"},null,-1)])])):_.value.length===0?(n(),a("div",A,[...e[6]||(e[6]=[s("p",null,"No trending walls found",-1)])])):(n(),a("div",G,[(n(!0),a(w,null,y(_.value,t=>(n(),a("div",{key:t.wall_id,class:"wall-card",onClick:i=>o.$router.push(`/wall/${t.wall_id}`)},[s("div",{class:"wall-banner",style:F({background:t.theme||"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"})},null,4),s("div",J,[s("h3",null,l(t.display_name),1),s("p",O,"@"+l(t.owner_username),1),t.description?(n(),a("p",Y,l(t.description),1)):D("",!0),s("div",Z,[s("span",null,"📝 "+l(t.post_count||0),1),s("span",null,"👥 "+l(t.follower_count||0),1),s("span",null,"👁️ "+l(t.view_count||0),1)])])],8,I))),128))]))]),s("section",ss,[e[12]||(e[12]=s("div",{class:"section-header"},[s("h2",null,"⭐ Popular Posts")],-1)),m.value?(n(),a("div",ts,[...e[7]||(e[7]=[s("div",{class:"spinner"},null,-1)])])):p.value.length===0?(n(),a("div",es,[...e[8]||(e[8]=[s("p",null,"No popular posts found",-1)])])):(n(),a("div",os,[(n(!0),a(w,null,y(p.value,t=>(n(),a("div",{key:t.post_id,class:"post-card"},[s("div",as,[s("img",{src:t.author_avatar||"/assets/images/default-avatar.svg",alt:t.author_username,class:"post-avatar"},null,8,ns),s("div",ls,[s("span",is,"@"+l(t.author_username),1),s("span",rs,l(U(t.created_at)),1)])]),s("div",ds,[t.content_html?(n(),a("div",{key:0,innerHTML:t.content_html},null,8,cs)):(n(),a("p",us,l(t.content_text),1))]),s("div",vs,[s("button",_s,[e[9]||(e[9]=s("span",null,"👍",-1)),s("span",null,l(t.reaction_count||0),1)]),s("button",ps,[e[10]||(e[10]=s("span",null,"💬",-1)),s("span",null,l(t.comment_count||0),1)]),s("button",fs,[e[11]||(e[11]=s("span",null,"👁️",-1)),s("span",null,l(t.view_count||0),1)])])]))),128))]))]),s("section",gs,[e[15]||(e[15]=s("div",{class:"section-header"},[s("h2",null,"👥 Suggested Users")],-1)),h.value?(n(),a("div",ms,[...e[13]||(e[13]=[s("div",{class:"spinner"},null,-1)])])):d.value.length===0?(n(),a("div",hs,[...e[14]||(e[14]=[s("p",null,"No user suggestions available",-1)])])):(n(),a("div",ws,[(n(!0),a(w,null,y(d.value,t=>(n(),a("div",{key:t.user_id,class:"user-card"},[s("img",{src:t.avatar_url||"/assets/images/default-avatar.svg",alt:t.username,class:"user-avatar"},null,8,ys),s("h3",ks,"@"+l(t.username),1),t.bio?(n(),a("p",bs,l(t.bio),1)):D("",!0),s("div",$s,[s("span",null,l(t.followers_count||0)+" followers",1),s("span",null,l(t.posts_count||0)+" posts",1)]),s("button",{onClick:i=>L(t.user_id),class:"btn-follow"},l(t.is_following?o.$t("common.actions.unfollow"):o.$t("common.actions.follow")),9,Cs)]))),128))]))])]))}}),Ls=H(Ds,[["__scopeId","data-v-2a5a0a6c"]]);export{Ls as default};
//# sourceMappingURL=DiscoverView-C-M8pTDj.js.map
