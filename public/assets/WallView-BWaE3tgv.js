import{f as j,r as _,b as C,e as R,o as U,g as i,j as v,k as s,t as c,U as x,F as A,x as T,v as O,n as J,u as K,i as r}from"./vendor-B5QdKGWw.js";import{u as Q,b as y,_ as X}from"./index-CHwN07cR.js";import"./utils-i9HKr1_Q.js";const Y={class:"wall-view"},Z={key:0,class:"loading-container"},ss={key:1,class:"error-container"},ts={key:2,class:"wall-content"},es={class:"wall-header"},as={class:"wall-info"},ls={class:"wall-avatar"},os=["src","alt"],ns={class:"wall-details"},is={class:"wall-title"},rs={key:0,class:"wall-owner"},us={key:1,class:"wall-description"},cs={class:"wall-stats"},ds={class:"stat"},_s={class:"stat-value"},vs={class:"stat"},ps={class:"stat-value"},ms={class:"posts-section"},fs={key:0,class:"loading-posts"},gs={key:1,class:"empty-state"},hs={key:2,class:"posts-grid"},ws={key:0,class:"ai-generation-status"},ys={class:"progress-bar"},bs={class:"status-text"},ks={class:"post-header"},Ps=["src","alt"],Ms={class:"post-meta"},Is={class:"post-author"},Cs={class:"post-time"},xs={class:"post-content"},As=["innerHTML"],Ts={key:1},$s={key:1,class:"post-media"},Ls=["src","alt"],Ds={class:"post-actions"},Es={class:"action-btn"},Fs={class:"action-btn"},Ss={class:"action-btn"},Ws={key:3,class:"load-more"},b=20,qs=j({__name:"WallView",props:{wallId:{}},setup($){const L=$;K();const D=O(),k=Q(),g=_(!0),f=_(!1),p=_(null),n=_(null),d=_([]),h=_(1),P=_(!0);let m=null;const E=C(()=>n.value&&k.user&&n.value.user_id===k.user.id),F=C(()=>{var l;return(l=n.value)!=null&&l.theme?{backgroundColor:n.value.theme}:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"}}),S=l=>{const t=new Date(l),o=new Date().getTime()-t.getTime(),a=Math.floor(o/6e4),u=Math.floor(o/36e5),I=Math.floor(o/864e5);return a<1?"just now":a<60?`${a}m ago`:u<24?`${u}h ago`:I<7?`${I}d ago`:t.toLocaleDateString()},W=async()=>{var l,t,e,o;try{g.value=!0,p.value=null;let a=L.wallId||D.params.wallId;if(!a)throw new Error("No wall identifier provided");let u;if(a==="me"?u=await y.get("/walls/me"):u=await y.get(`/walls/${a}`),u!=null&&u.success&&((l=u==null?void 0:u.data)!=null&&l.wall))n.value=u.data.wall,await w();else throw new Error((u==null?void 0:u.message)||"Wall not found")}catch(a){console.error("Error loading wall:",a),((t=a.response)==null?void 0:t.status)===404?p.value="The requested wall could not be found. It may not exist or you may not have permission to view it.":p.value=((o=(e=a.response)==null?void 0:e.data)==null?void 0:o.message)||a.message||"Failed to load wall"}finally{g.value=!1}},w=async(l=!1)=>{var t;if(n.value)try{l||(f.value=!0);const e=(h.value-1)*b,o=await y.get(`/walls/${n.value.wall_id}/posts?limit=${b}&offset=${e}`);if(o!=null&&o.success&&((t=o==null?void 0:o.data)!=null&&t.posts)){const a=o.data.posts;h.value===1?l?q(a):d.value=a:d.value=[...d.value,...a],P.value=a.length===b,G()}}catch(e){console.error("Error loading posts:",e)}finally{l||(f.value=!1)}},q=l=>{const t=new Map(l.map(e=>[e.post_id,e]));d.value.forEach((e,o)=>{const a=t.get(e.post_id);a&&(e.ai_status!==a.ai_status&&(d.value[o]={...e,...a}),t.delete(e.post_id))}),t.size>0&&(d.value=[...Array.from(t.values()),...d.value])},G=()=>{d.value.some(t=>t.post_type==="ai_app"&&(t.ai_status==="queued"||t.ai_status==="processing"))?H():M()},H=()=>{m||(m=setInterval(async()=>{await w(!0)},3e3))},M=()=>{m&&(clearInterval(m),m=null)},N=()=>{h.value++,w()},V=()=>{console.log("Create post functionality coming soon")},z=l=>({queued:10,processing:60,completed:100,failed:0})[l]||0,B=l=>({queued:"Waiting in queue...",processing:"Generating your application...",completed:"Generation complete!",failed:"Generation failed"})[l]||"Processing...";return R(()=>{W()}),U(()=>{M()}),(l,t)=>(r(),i("div",Y,[g.value?(r(),i("div",Z,[...t[1]||(t[1]=[s("div",{class:"spinner"},null,-1),s("p",null,"Loading wall...",-1)])])):p.value?(r(),i("div",ss,[t[2]||(t[2]=s("h2",null,"Error Loading Wall",-1)),s("p",null,c(p.value),1),s("button",{onClick:t[0]||(t[0]=e=>l.$router.push("/")),class:"btn-primary"},"Go Home")])):n.value?(r(),i("div",ts,[s("div",es,[s("div",{class:"wall-banner",style:x(F.value)},null,4),s("div",as,[s("div",ls,[s("img",{src:n.value.owner_avatar||n.value.avatar_url||"/assets/images/default-avatar.svg",alt:n.value.owner_username||n.value.display_name},null,8,os)]),s("div",ns,[s("h1",is,c(n.value.display_name),1),n.value.owner_username?(r(),i("p",rs,"by @"+c(n.value.owner_username),1)):v("",!0),n.value.description?(r(),i("p",us,c(n.value.description),1)):v("",!0)]),s("div",cs,[s("div",ds,[s("span",_s,c(n.value.posts_count||0),1),t[3]||(t[3]=s("span",{class:"stat-label"},"Posts",-1))]),s("div",vs,[s("span",ps,c(n.value.subscribers_count||0),1),t[4]||(t[4]=s("span",{class:"stat-label"},"Followers",-1))])])])]),s("div",ms,[t[11]||(t[11]=s("h2",{class:"section-title"},"Posts",-1)),f.value?(r(),i("div",fs,[...t[5]||(t[5]=[s("div",{class:"spinner"},null,-1),s("p",null,"Loading posts...",-1)])])):d.value.length===0?(r(),i("div",gs,[t[6]||(t[6]=s("p",null,"No posts yet on this wall.",-1)),E.value?(r(),i("button",{key:0,onClick:V,class:"btn-primary"},"Create First Post")):v("",!0)])):(r(),i("div",hs,[(r(!0),i(A,null,T(d.value,e=>(r(),i("div",{key:e.post_id,class:J(["post-card",{"ai-post":e.post_type==="ai_app"}])},[e.post_type==="ai_app"&&e.ai_status!=="completed"?(r(),i("div",ws,[t[7]||(t[7]=s("div",{class:"status-header"},[s("span",{class:"status-icon"},"ğŸ¤–"),s("h3",null,"AI Application Generating...")],-1)),s("div",ys,[s("div",{class:"progress-fill",style:x({width:z(e.ai_status)+"%"})},null,4)]),s("p",bs,c(B(e.ai_status)),1)])):v("",!0),s("div",ks,[s("img",{src:e.author_avatar||"/assets/images/default-avatar.svg",alt:e.author_username,class:"post-avatar"},null,8,Ps),s("div",Ms,[s("span",Is,"@"+c(e.author_username),1),s("span",Cs,c(S(e.created_at)),1)])]),s("div",xs,[e.content_html?(r(),i("div",{key:0,innerHTML:e.content_html},null,8,As)):(r(),i("p",Ts,c(e.content_text),1))]),e.media_attachments&&e.media_attachments.length>0?(r(),i("div",$s,[(r(!0),i(A,null,T(e.media_attachments,o=>(r(),i("img",{key:o.attachment_id,src:o.file_url,alt:o.file_name},null,8,Ls))),128))])):v("",!0),s("div",Ds,[s("button",Es,[t[8]||(t[8]=s("span",{class:"icon"},"ğŸ‘",-1)),s("span",null,c(e.reaction_count||0),1)]),s("button",Fs,[t[9]||(t[9]=s("span",{class:"icon"},"ğŸ’¬",-1)),s("span",null,c(e.comment_count||0),1)]),s("button",Ss,[t[10]||(t[10]=s("span",{class:"icon"},"ğŸ‘",-1)),s("span",null,c(e.view_count||0),1)])])],2))),128))])),P.value&&!f.value?(r(),i("div",Ws,[s("button",{onClick:N,class:"btn-secondary"},"Load More")])):v("",!0)])])):v("",!0)]))}}),Vs=X(qs,[["__scopeId","data-v-46f21187"]]);export{Vs as default};
//# sourceMappingURL=WallView-BWaE3tgv.js.map
