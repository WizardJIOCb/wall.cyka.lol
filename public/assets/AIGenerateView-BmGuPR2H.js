import{e as J,r,b as j,i as O,j as Y,f as n,k as e,h as S,S as K,t as l,v as x,N as I,U as W,X as U,F as X,s as Q,V as Z,n as ee,u as se,o as i}from"./vendor-Cy2yCxOA.js";import{b as v,_ as te}from"./index-OxM2XMo-.js";import"./utils-i9HKr1_Q.js";const ae={class:"ai-generate-view"},oe={key:0,class:"job-status-section"},le={class:"status-card"},ne={class:"progress-info"},ie={class:"progress-bar"},re={class:"progress-text"},ue={key:0,class:"queue-info"},de={class:"job-details"},ce={key:1,class:"result-section"},pe={class:"app-preview"},ve=["src"],be={key:1,class:"preview-placeholder"},ge={class:"code-viewer"},me={class:"code-content"},ye={key:2,class:"generation-form"},fe={class:"form-header"},_e={class:"prompt-section"},he={class:"form-label"},ke={class:"char-count"},Ce={class:"options-section"},we={class:"option-group"},je={class:"option-group"},xe={class:"cost-section"},Ie={class:"cost-display"},Pe={class:"cost-value"},Ge={class:"balance-display"},Se={class:"balance-value"},Ue={key:0,class:"warning-text"},ze=["disabled"],qe={class:"history-section"},Ae={key:0,class:"loading-container"},Be={key:1,class:"empty-state"},Re={key:2,class:"history-grid"},Ve=["onClick"],De={class:"history-content"},Le={class:"history-prompt"},Me={class:"history-meta"},Te={class:"history-status-text"},Ee={class:"history-date"},$e=J({__name:"AIGenerateView",props:{jobId:{}},setup(z){const m=z;se();const q=Z(),u=r(""),y=r("deepseek-coder"),b=r("normal"),d=r(100),c=r(0),g=r(!1),a=r(null),f=r([]),_=r(!1);let p=null;const A=j(()=>u.value.length>=50&&d.value<=c.value),B=j(()=>a.value&&{queued:10,analyzing:30,generating:60,finalizing:90,completed:100,failed:0}[a.value.status]||0),R=j(()=>a.value?{queued:"Waiting in queue...",analyzing:"Analyzing your prompt...",generating:"Generating code...",finalizing:"Finalizing application...",completed:"Generation complete!",failed:"Generation failed"}[a.value.status]||"Processing...":""),h=()=>{let t=100;const s=Math.ceil(u.value.length/200),o={normal:0,high:50,urgent:150};d.value=t+s*10+o[b.value]},P=t=>new Date(t).toLocaleString(),V=(t,s)=>t.length>s?t.substring(0,s)+"...":t,D=t=>({queued:"⏳",analyzing:"🔍",generating:"⚙️",finalizing:"🔧",completed:"✅",failed:"❌"})[t]||"📝",L=async()=>{try{const t=await v.get("/bricks/balance");t.data.success&&(c.value=t.data.data.balance||0)}catch(t){console.error("Error loading bricks balance:",t)}},M=async()=>{try{_.value=!0;const t=await v.get("/ai/history?limit=10");t.data.success&&t.data.data.jobs&&(f.value=t.data.data.jobs)}catch(t){console.error("Error loading history:",t)}finally{_.value=!1}},T=async()=>{var t,s;try{g.value=!0;const o=await v.post("/ai/generate",{prompt:u.value,model:y.value,priority:b.value});o.data.success&&o.data.data.job&&(a.value=o.data.data.job,q.push(`/ai/${a.value.job_id}`),G())}catch(o){alert(((s=(t=o.response)==null?void 0:t.data)==null?void 0:s.message)||"Failed to start generation")}finally{g.value=!1}},k=async t=>{try{const s=t||m.jobId;if(!s)return;const o=await v.get(`/ai/jobs/${s}`);o.data.success&&o.data.data.job&&(a.value=o.data.data.job,a.value.status!=="completed"&&a.value.status!=="failed"&&G())}catch(s){console.error("Error loading job:",s)}},G=()=>{p||(p=setInterval(async()=>{if(a.value&&(a.value.status==="completed"||a.value.status==="failed")){C();return}await k()},3e3))},C=()=>{p&&(clearInterval(p),p=null)},E=async()=>{var t,s;if(a.value)try{await v.post(`/queue/jobs/${a.value.job_id}/cancel`),a.value.status="cancelled",C()}catch(o){alert(((s=(t=o.response)==null?void 0:t.data)==null?void 0:s.message)||"Failed to cancel job")}},$=()=>{var w;if(!((w=a.value)!=null&&w.generated_code))return;const t=new Blob([a.value.generated_code],{type:"text/html"}),s=URL.createObjectURL(t),o=document.createElement("a");o.href=s,o.download=`ai-app-${a.value.job_id}.html`,o.click(),URL.revokeObjectURL(s)},F=()=>{console.log("Publish app functionality coming soon")},N=()=>{a.value&&(u.value=a.value.prompt,a.value=null)},H=()=>{var t;(t=a.value)!=null&&t.generated_code&&(navigator.clipboard.writeText(a.value.generated_code),alert("Code copied to clipboard!"))};return O(()=>{L(),M(),m.jobId&&k(m.jobId)}),Y(()=>{C()}),(t,s)=>(i(),n("div",ae,[a.value&&a.value.status!=="completed"?(i(),n("div",oe,[e("div",le,[e("div",{class:"status-header"},[s[3]||(s[3]=e("h2",null,"🤖 AI Generation in Progress",-1)),e("button",{onClick:E,class:"btn-danger-sm"},"Cancel")]),e("div",ne,[e("div",ie,[e("div",{class:"progress-fill",style:K({width:`${B.value}%`})},null,4)]),e("p",re,l(R.value),1)]),a.value.queue_position>0?(i(),n("div",ue,[s[4]||(s[4]=e("span",{class:"icon"},"⏳",-1)),e("span",null,"Position "+l(a.value.queue_position)+" in queue",1)])):S("",!0),e("div",de,[e("p",null,[s[5]||(s[5]=e("strong",null,"Prompt:",-1)),x(" "+l(a.value.prompt),1)]),e("p",null,[s[6]||(s[6]=e("strong",null,"Status:",-1)),x(" "+l(a.value.status),1)]),e("p",null,[s[7]||(s[7]=e("strong",null,"Started:",-1)),x(" "+l(P(a.value.created_at)),1)])])])])):a.value&&a.value.status==="completed"?(i(),n("div",ce,[e("div",{class:"result-header"},[s[11]||(s[11]=e("h2",null,"✅ Generation Complete!",-1)),e("div",{class:"result-actions"},[e("button",{onClick:$,class:"btn-secondary"},[...s[8]||(s[8]=[e("span",{class:"icon"},"📥",-1),e("span",null,"Download",-1)])]),e("button",{onClick:F,class:"btn-primary"},[...s[9]||(s[9]=[e("span",{class:"icon"},"📤",-1),e("span",null,"Publish",-1)])]),e("button",{onClick:N,class:"btn-secondary"},[...s[10]||(s[10]=[e("span",{class:"icon"},"🔄",-1),e("span",null,"Remix",-1)])])])]),e("div",pe,[a.value.result_url?(i(),n("iframe",{key:0,src:a.value.result_url,class:"preview-frame",sandbox:"allow-scripts allow-forms"},null,8,ve)):(i(),n("div",be,[...s[12]||(s[12]=[e("p",null,"Preview not available",-1)])]))]),e("div",ge,[e("div",{class:"code-header"},[s[13]||(s[13]=e("h3",null,"Generated Code",-1)),e("button",{onClick:H,class:"btn-copy"},"Copy")]),e("pre",me,l(a.value.generated_code||"Code not available"),1)])])):(i(),n("div",ye,[e("div",fe,[e("h1",null,l(t.$t("navigation.aiGenerate")),1),s[14]||(s[14]=e("p",{class:"subtitle"},"Describe your web application and let AI build it for you",-1))]),e("div",_e,[e("label",he,[s[15]||(s[15]=e("span",null,"Prompt",-1)),e("span",ke,l(u.value.length)+"/2000",1)]),I(e("textarea",{"onUpdate:modelValue":s[0]||(s[0]=o=>u.value=o),class:"prompt-input",placeholder:"Example: Create a simple todo list app with add, delete, and mark as complete functionality. Use a clean, modern design with blue colors.",rows:"6",maxlength:"2000",onInput:h},null,544),[[W,u.value]]),s[16]||(s[16]=e("div",{class:"prompt-tips"},[e("p",null,[e("strong",null,"Tips for better results:")]),e("ul",null,[e("li",null,"Be specific about functionality and features"),e("li",null,"Describe the design style and colors"),e("li",null,"Mention any specific technologies if needed"),e("li",null,"Keep it under 2000 characters")])],-1))]),e("div",Ce,[e("div",we,[s[18]||(s[18]=e("label",{class:"form-label"},"Model",-1)),I(e("select",{"onUpdate:modelValue":s[1]||(s[1]=o=>y.value=o),class:"form-select",onChange:h},[...s[17]||(s[17]=[e("option",{value:"deepseek-coder"},"DeepSeek Coder (Recommended)",-1),e("option",{value:"llama-coder"},"Llama Coder",-1),e("option",{value:"codellama"},"CodeLlama",-1)])],544),[[U,y.value]])]),e("div",je,[s[20]||(s[20]=e("label",{class:"form-label"},"Priority",-1)),I(e("select",{"onUpdate:modelValue":s[2]||(s[2]=o=>b.value=o),class:"form-select",onChange:h},[...s[19]||(s[19]=[e("option",{value:"normal"},"Normal (Free)",-1),e("option",{value:"high"},"High (+50 🧱)",-1),e("option",{value:"urgent"},"Urgent (+150 🧱)",-1)])],544),[[U,b.value]])])]),e("div",xe,[e("div",Ie,[s[21]||(s[21]=e("span",{class:"cost-label"},"Estimated Cost:",-1)),e("span",Pe,l(d.value)+" 🧱",1)]),e("div",Ge,[s[22]||(s[22]=e("span",null,"Your Balance:",-1)),e("span",Se,l(c.value)+" 🧱",1)]),d.value>c.value?(i(),n("p",Ue," ⚠️ Insufficient bricks. You need "+l(d.value-c.value)+" more bricks. ",1)):S("",!0)]),e("button",{onClick:T,disabled:!A.value||g.value,class:"btn-generate"},l(g.value?"Submitting...":"Generate Application"),9,ze)])),e("div",qe,[s[25]||(s[25]=e("h2",null,"Recent Generations",-1)),_.value?(i(),n("div",Ae,[...s[23]||(s[23]=[e("div",{class:"spinner"},null,-1)])])):f.value.length===0?(i(),n("div",Be,[...s[24]||(s[24]=[e("p",null,"No generation history yet",-1)])])):(i(),n("div",Re,[(i(!0),n(X,null,Q(f.value,o=>(i(),n("div",{key:o.job_id,class:"history-card",onClick:w=>k(o.job_id)},[e("div",{class:ee(["history-status",o.status])},l(D(o.status)),3),e("div",De,[e("p",Le,l(V(o.prompt,100)),1),e("div",Me,[e("span",Te,l(o.status),1),e("span",Ee,l(P(o.created_at)),1)])])],8,Ve))),128))]))])]))}}),Je=te($e,[["__scopeId","data-v-2c296e71"]]);export{Je as default};
//# sourceMappingURL=AIGenerateView-BmGuPR2H.js.map
