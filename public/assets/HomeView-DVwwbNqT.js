import{d as re,r as C,b as D,f as j,w as de,e as J,g as d,i as a,R as W,k as n,j as k,O as te,V as ie,W as ae,s as b,n as X,t as w,p as Y,U as me,l as V,m as A,y as O,z as B,F as q,x as G,o as oe,X as ue,B as ve,T as pe,h as le}from"./vendor-B5QdKGWw.js";import{b as F,c as ne,_ as H,u as ce,d as fe,f as he,e as ye,A as Z}from"./index-DlFs-B9o.js";import"./utils-i9HKr1_Q.js";const N={async getFeed(e){return F.get("/posts/feed",e)},async getWallPosts(e,s){return F.get(`/walls/${e}/posts`,s)},async getPost(e){return F.get(`/posts/${e}`)},async createPost(e){const s=new FormData;return s.append("wall_id",e.wall_id.toString()),s.append("content",e.content),e.post_type&&s.append("post_type",e.post_type),e.visibility&&s.append("visibility",e.visibility),e.ai_application_id&&s.append("ai_application_id",e.ai_application_id.toString()),e.media_files&&e.media_files.forEach((t,c)=>{s.append(`media_files[${c}]`,t)}),F.upload("/posts",s)},async updatePost(e,s){return F.patch(`/posts/${e}`,s)},async deletePost(e){return F.delete(`/posts/${e}`)},async reactToPost(e,s){return F.post(`/posts/${e}/reactions`,{reaction_type:s})},async removeReaction(e){return F.delete(`/posts/${e}/reactions`)},async sharePost(e,s,t){return F.post(`/posts/${e}/share`,{wall_id:s,content:t})}},ge=re("posts",()=>{const e=C([]),s=C([]),t=C(1),c=C(1),l=C(!0),i=C(!1),u=C({content_type:"all",time_range:"all",sort_by:"recent"}),h=D(()=>g=>e.value.find(o=>o.id===g)),r=async(g=1,o=!1)=>{var m,P,U;i.value=!0;try{const E=await N.getFeed({page:g,per_page:20,content_type:u.value.content_type!=="all"?u.value.content_type:void 0,time_range:u.value.time_range!=="all"?u.value.time_range:void 0,sort_by:u.value.sort_by}),K=Array.isArray(E.data)?E.data:[];o?s.value=K:s.value.push(...K),t.value=((m=E.pagination)==null?void 0:m.current_page)||g,c.value=((P=E.pagination)==null?void 0:P.total_pages)||1,l.value=((U=E.pagination)==null?void 0:U.has_more)||!1,K.forEach(_=>{const y=e.value.findIndex(z=>z.id===_.id);y>=0?e.value[y]=_:e.value.push(_)})}catch(E){throw console.error("Failed to fetch feed:",E),o&&(s.value=[]),E}finally{i.value=!1}},$=async()=>{l.value&&!i.value&&await r(t.value+1,!1)},f=async()=>{t.value=1,await r(1,!0)};return{posts:e,feedPosts:s,currentPage:t,totalPages:c,hasMore:l,loading:i,filters:u,getPostById:h,fetchFeed:r,loadMore:$,refreshFeed:f,createPost:async g=>{try{const o=await N.createPost(g);return s.value.unshift(o),e.value.unshift(o),o}catch(o){throw console.error("Failed to create post:",o),o}},updatePost:async(g,o)=>{try{const m=await N.updatePost(g,o),P=s.value.findIndex(E=>E.id===g);P>=0&&(s.value[P]=m);const U=e.value.findIndex(E=>E.id===g);return U>=0&&(e.value[U]=m),m}catch(m){throw console.error("Failed to update post:",m),m}},deletePost:async g=>{try{await N.deletePost(g),s.value=s.value.filter(o=>o.id!==g),e.value=e.value.filter(o=>o.id!==g)}catch(o){throw console.error("Failed to delete post:",o),o}},reactToPost:async(g,o)=>{try{await N.reactToPost(g,o);const m=e.value.find(P=>P.id===g);m&&(m.reactions_count=(m.reactions_count||0)+1)}catch(m){throw console.error("Failed to react to post:",m),m}},removeReaction:async g=>{try{await N.removeReaction(g);const o=e.value.find(m=>m.id===g);o&&o.reactions_count>0&&o.reactions_count--}catch(o){throw console.error("Failed to remove reaction:",o),o}},setFilters:g=>{u.value={...u.value,...g},f()},clearFilters:()=>{u.value={content_type:"all",time_range:"all",sort_by:"recent"},f()}}}),_e={class:"form-group"},Ce=["placeholder","rows","onKeydown"],we={class:"form-footer"},ke={class:"form-actions"},$e=["disabled"],be=["disabled"],Pe={key:0,class:"error-message"},Ie=j({__name:"CommentForm",props:{postId:{},parentCommentId:{},commentId:{},initialContent:{},placeholder:{},rows:{default:3},showCancel:{type:Boolean,default:!0}},emits:["comment-created","comment-updated","cancel"],setup(e,{emit:s}){const t=e,c=s,{t:l}=ne(),i=C(t.initialContent||""),u=C(!1),h=C(null),r=C(null),$=D(()=>i.value.length),f=D(()=>{const S=i.value.trim();return S.length>0&&S.length<=2e3&&!u.value}),v=D(()=>t.commentId?l("comments.updateComment"):t.parentCommentId?l("comments.reply"):l("comments.comment")),p=S=>{const I=r.value;I&&(I.style.height="auto",I.style.height=I.scrollHeight+"px")},R=async()=>{var S,I;if(f.value){u.value=!0,h.value=null;try{let x;t.commentId?(x=await F.patch(`/comments/${t.commentId}`,{content:i.value.trim()}),c("comment-updated",x.data.data)):t.parentCommentId?(x=await F.post(`/comments/${t.parentCommentId}/replies`,{content:i.value.trim()}),c("comment-created",x.data.data)):t.postId&&(x=await F.post(`/posts/${t.postId}/comments`,{content:i.value.trim()}),c("comment-created",x.data.data)),i.value="",r.value&&(r.value.style.height="auto")}catch(x){h.value=((I=(S=x.response)==null?void 0:S.data)==null?void 0:I.message)||l("comments.errorPosting")}finally{u.value=!1}}},T=()=>{i.value=t.initialContent||"",h.value=null,c("cancel")};return de(()=>t.initialContent,S=>{i.value=S||""}),J(()=>{p()}),(S,I)=>(a(),d("form",{onSubmit:W(R,["prevent"]),class:"comment-form"},[n("div",_e,[te(n("textarea",{ref_key:"textareaRef",ref:r,"onUpdate:modelValue":I[0]||(I[0]=x=>i.value=x),placeholder:e.placeholder||b(l)("comments.write"),maxlength:2e3,rows:e.rows,onInput:p,onKeydown:[ae(W(R,["meta"]),["enter"]),ae(W(R,["ctrl"]),["enter"])],class:"comment-textarea"},null,40,Ce),[[ie,i.value]]),n("div",we,[n("span",{class:X(["char-count",{warning:$.value>1800,error:$.value>2e3}])},w($.value)+" / 2000 ",3),n("div",ke,[e.showCancel?(a(),d("button",{key:0,type:"button",onClick:T,class:"btn btn-secondary",disabled:u.value},w(b(l)("comments.cancel")),9,$e)):k("",!0),n("button",{type:"submit",disabled:!f.value||u.value,class:"btn btn-primary"},w(u.value?b(l)("comments.posting"):v.value),9,be)])])]),h.value?(a(),d("div",Pe,w(h.value),1)):k("",!0)],32))}}),ee=H(Ie,[["__scopeId","data-v-818beb56"]]),xe={class:"comment-header"},Se=["src","alt"],Me={class:"comment-meta"},Re={class:"timestamp"},Fe={key:0,class:"edited-badge"},Ee={key:0,class:"comment-actions"},Te=["disabled","title"],De=["title"],Ve={class:"comment-content"},Le=["innerHTML"],Ae={class:"comment-footer"},Be={key:0,class:"user-reaction"},je={key:1},He={key:2,class:"count"},Ue={key:0,class:"count"},ze=["onClick","title"],Ne={key:1,class:"reply-form"},We={key:2,class:"replies"},Oe=j({__name:"CommentItem",props:{comment:{},postId:{},depth:{default:0},maxDepth:{default:4}},emits:["reply-created","comment-updated","comment-deleted"],setup(e,{emit:s}){const t=e,c=s,{t:l}=ne(),i=ce(),u=C(!1),h=C(!1),r=C(!1),$=C(!0),f=[{type:"like",emoji:"ðŸ‘",label:"Like"},{type:"dislike",emoji:"ðŸ‘Ž",label:"Dislike"},{type:"heart",emoji:"â¤ï¸",label:"Love"},{type:"laugh",emoji:"ðŸ˜‚",label:"Laugh"},{type:"wow",emoji:"ðŸ˜®",label:"Wow"},{type:"sad",emoji:"ðŸ˜¢",label:"Sad"},{type:"angry",emoji:"ðŸ˜ ",label:"Angry"}],v=D(()=>{var _;return((_=i.user)==null?void 0:_.user_id)===t.comment.author_id}),p=D(()=>{const _=new Date(t.comment.created_at).getTime();return(Date.now()-_)/1e3/60<15}),R=D(()=>{if(t.depth===0)return"0";const _=window.innerWidth>768?24:12;return`${t.depth*_}px`}),T=_=>{const y=new Date(_),Q=new Date().getTime()-y.getTime(),M=Math.floor(Q/6e4);if(M<1)return l("comments.justNow");if(M<60)return l("comments.minutesAgo",{count:M});const L=Math.floor(M/60);if(L<24)return l("comments.hoursAgo",{count:L});const se=Math.floor(L/24);return se<7?l("comments.daysAgo",{count:se}):y.toLocaleDateString()},S=_=>_>=1e6?(_/1e6).toFixed(1)+"M":_>=1e3?(_/1e3).toFixed(1)+"K":_.toString(),I=_=>{const y=f.find(z=>z.type===_);return(y==null?void 0:y.emoji)||"ðŸ‘"},x=()=>{p.value&&(u.value=!0)},g=async()=>{if(confirm(l("comments.deleteConfirm")))try{await F.delete(`/comments/${t.comment.comment_id}`),c("comment-deleted",t.comment.comment_id)}catch(_){console.error("Failed to delete comment:",_)}},o=()=>{h.value=!h.value,h.value&&(r.value=!1)},m=()=>{$.value=!$.value},P=()=>{r.value=!r.value,r.value&&(h.value=!1)},U=async _=>{try{const y=await F.post(`/comments/${t.comment.comment_id}/reactions`,{reaction_type:_});t.comment.reaction_count=y.data.data.reaction_count,t.comment.like_count=y.data.data.like_count,t.comment.dislike_count=y.data.data.dislike_count,y.data.data.action==="removed"?t.comment.user_reaction=null:t.comment.user_reaction=_,r.value=!1}catch(y){console.error("Failed to react:",y)}},E=_=>{u.value=!1,c("comment-updated",_)},K=_=>{h.value=!1,t.comment.replies||(t.comment.replies=[]),t.comment.replies.push(_),t.comment.reply_count++,c("reply-created",_)};return(_,y)=>{const z=Y("router-link"),Q=Y("CommentItem",!0);return a(),d("div",{class:X(["comment-item",`depth-${e.depth}`]),style:me({marginLeft:R.value})},[n("div",xe,[n("img",{src:e.comment.author_avatar||"/default-avatar.png",alt:e.comment.author_name,class:"avatar"},null,8,Se),n("div",Me,[V(z,{to:`/users/${e.comment.author_id}`,class:"author-name"},{default:A(()=>[O(w(e.comment.author_name),1)]),_:1},8,["to"]),n("span",Re,w(T(e.comment.created_at)),1),e.comment.is_edited?(a(),d("span",Fe,w(b(l)("comments.edited")),1)):k("",!0)]),v.value?(a(),d("div",Ee,[n("button",{onClick:x,disabled:!p.value,title:p.value?b(l)("comments.edit"):b(l)("comments.editExpired"),class:"action-btn"},[...y[7]||(y[7]=[n("span",null,"âœï¸",-1)])],8,Te),n("button",{onClick:g,title:b(l)("comments.delete"),class:"action-btn"},[...y[8]||(y[8]=[n("span",null,"ðŸ—‘ï¸",-1)])],8,De)])):k("",!0)]),n("div",Ve,[u.value?(a(),B(ee,{key:1,"comment-id":e.comment.comment_id,"initial-content":e.comment.content_text,"show-cancel":!0,rows:2,onCommentUpdated:E,onCancel:y[0]||(y[0]=M=>u.value=!1)},null,8,["comment-id","initial-content"])):(a(),d("p",{key:0,innerHTML:e.comment.content_html},null,8,Le))]),n("div",Ae,[n("button",{class:X(["reaction-btn",{active:e.comment.user_reaction}]),onClick:P},[e.comment.user_reaction?(a(),d("span",Be,w(I(e.comment.user_reaction)),1)):(a(),d("span",je,"ðŸ‘")),e.comment.reaction_count>0?(a(),d("span",He,w(S(e.comment.reaction_count)),1)):k("",!0)],2),e.depth<e.maxDepth?(a(),d("button",{key:0,onClick:o,class:"reply-btn"},[O(w(b(l)("comments.reply"))+" ",1),e.comment.reply_count>0?(a(),d("span",Ue," ("+w(e.comment.reply_count)+") ",1)):k("",!0)])):k("",!0),e.comment.reply_count>0&&e.comment.replies?(a(),d("button",{key:1,onClick:m,class:"collapse-btn"},w($.value?b(l)("comments.hideReplies"):b(l)("comments.showReplies")),1)):k("",!0)]),r.value?(a(),d("div",{key:0,class:"reaction-picker",onClick:y[2]||(y[2]=W(()=>{},["stop"]))},[(a(),d(q,null,G(f,M=>n("button",{key:M.type,onClick:L=>U(M.type),class:X(["reaction-option",{selected:e.comment.user_reaction===M.type}]),title:M.label},w(M.emoji),11,ze)),64)),n("button",{onClick:y[1]||(y[1]=M=>r.value=!1),class:"close-picker"}," âœ• ")])):k("",!0),h.value?(a(),d("div",Ne,[V(ee,{"post-id":e.postId,"parent-comment-id":e.comment.comment_id,placeholder:b(l)("comments.writeReply"),rows:2,onCommentCreated:K,onCancel:y[3]||(y[3]=M=>h.value=!1)},null,8,["post-id","parent-comment-id","placeholder"])])):k("",!0),$.value&&e.comment.replies&&e.comment.replies.length>0?(a(),d("div",We,[(a(!0),d(q,null,G(e.comment.replies,M=>(a(),B(Q,{key:M.comment_id,comment:M,"post-id":e.postId,depth:e.depth+1,"max-depth":e.maxDepth,onReplyCreated:y[4]||(y[4]=L=>_.$emit("reply-created",L)),onCommentUpdated:y[5]||(y[5]=L=>_.$emit("comment-updated",L)),onCommentDeleted:y[6]||(y[6]=L=>_.$emit("comment-deleted",L))},null,8,["comment","post-id","depth","max-depth"]))),128))])):k("",!0)],6)}}}),Ke=H(Oe,[["__scopeId","data-v-eb97aa55"]]),Xe={class:"comment-section"},qe={class:"comment-section-header"},Ge={class:"section-title"},Je={class:"comment-controls"},Qe={value:"created_asc"},Ye={value:"created_desc"},Ze={value:"reactions"},et={key:0,class:"comment-form-container"},tt={key:1,class:"loading-state"},ot={key:2,class:"empty-state"},nt={key:3,class:"comments-list"},st={key:5,class:"loading-more"},at=j({__name:"CommentSection",props:{postId:{},initialComments:{default:()=>[]},allowComments:{type:Boolean,default:!0}},setup(e){const s=e,{t}=ne(),c=C(s.initialComments),l=C(!1),i=C(!1),u=C("created_asc"),h=C(0),r=C(null),$=D(()=>c.value.filter(o=>!o.parent_comment_id)),f=async()=>{l.value=!0;try{const o=await F.get(`/posts/${s.postId}/comments`,{params:{sort:u.value,limit:50}});c.value=o.data.data.comments||[],i.value=o.data.data.has_more||!1,h.value=o.data.data.count||0,v()}catch(o){console.error("Failed to fetch comments:",o)}finally{l.value=!1}},v=()=>{const o=new Map;c.value.forEach(m=>{m.replies=[],o.set(m.comment_id,m)}),c.value.forEach(m=>{if(m.parent_comment_id){const P=o.get(m.parent_comment_id);P&&P.replies&&P.replies.push(m)}})},p=async()=>{console.log("Load more comments")},R=o=>{c.value.unshift(o),h.value++,v()},T=o=>{h.value++},S=o=>{const m=c.value.findIndex(P=>P.comment_id===o.comment_id);m!==-1&&(c.value[m]={...c.value[m],...o},v())},I=o=>{c.value=c.value.filter(m=>m.comment_id!==o),h.value--,v()},x=()=>{r.value=window.setInterval(()=>{l.value||f()},1e4)},g=()=>{r.value&&(clearInterval(r.value),r.value=null)};return J(()=>{c.value.length===0?f():(v(),h.value=c.value.length),x()}),oe(()=>{g()}),(o,m)=>(a(),d("div",Xe,[n("div",qe,[n("h3",Ge,w(b(t)("comments.title"))+" ("+w(h.value)+") ",1),n("div",Je,[te(n("select",{"onUpdate:modelValue":m[0]||(m[0]=P=>u.value=P),class:"sort-select",onChange:f},[n("option",Qe,w(b(t)("comments.sortOldest")),1),n("option",Ye,w(b(t)("comments.sortNewest")),1),n("option",Ze,w(b(t)("comments.sortReactions")),1)],544),[[ue,u.value]])])]),e.allowComments?(a(),d("div",et,[V(ee,{"post-id":e.postId,"show-cancel":!1,onCommentCreated:R},null,8,["post-id"])])):k("",!0),l.value&&c.value.length===0?(a(),d("div",tt,[m[1]||(m[1]=n("div",{class:"spinner"},null,-1)),n("p",null,w(b(t)("comments.loading")),1)])):c.value.length===0?(a(),d("div",ot,[n("p",null,w(b(t)("comments.noComments")),1)])):(a(),d("div",nt,[(a(!0),d(q,null,G($.value,P=>(a(),B(Ke,{key:P.comment_id,comment:P,"post-id":e.postId,depth:0,"max-depth":4,onReplyCreated:T,onCommentUpdated:S,onCommentDeleted:I},null,8,["comment","post-id"]))),128))])),i.value&&!l.value?(a(),d("button",{key:4,onClick:p,class:"load-more-btn"},w(b(t)("comments.loadMore")),1)):k("",!0),l.value&&c.value.length>0?(a(),d("div",st,[...m[2]||(m[2]=[n("div",{class:"spinner-small"},null,-1)])])):k("",!0)]))}}),lt=H(at,[["__scopeId","data-v-972002bb"]]),it={class:"post-card"},ct={class:"post-header"},rt={class:"post-author"},dt={class:"post-time"},mt=["innerHTML"],ut={key:0,class:"post-media"},vt=["src"],pt={class:"post-actions"},ft={key:0},ht={key:0},yt={key:0},gt=j({__name:"PostCard",props:{post:{}},emits:["edit","delete","comment","share","react"],setup(e,{emit:s}){const t=e,c=s,l=ce(),i=C(!1),u=D(()=>!1),h=D(()=>{var v;return((v=l.user)==null?void 0:v.id)===t.post.user_id}),r=v=>he(v),$=()=>c("react","like"),f=()=>{i.value=!i.value};return(v,p)=>{var T,S,I,x;const R=Y("router-link");return a(),d("article",it,[n("div",ct,[V(fe,{src:(T=e.post.user)==null?void 0:T.avatar_url,name:((S=e.post.user)==null?void 0:S.display_name)||((I=e.post.user)==null?void 0:I.username),size:"md"},null,8,["src","name"]),n("div",rt,[V(R,{to:`/profile/${(x=e.post.user)==null?void 0:x.username}`,class:"author-name"},{default:A(()=>{var g,o;return[O(w(((g=e.post.user)==null?void 0:g.display_name)||((o=e.post.user)==null?void 0:o.username)),1)]}),_:1},8,["to"]),n("span",dt,w(r(e.post.created_at)),1)]),h.value?(a(),B(ye,{key:0,position:"bottom-right"},{trigger:A(()=>[...p[3]||(p[3]=[n("button",{class:"btn-icon"},"â‹®",-1)])]),default:A(()=>[n("button",{class:"dropdown-item",onClick:p[0]||(p[0]=g=>v.$emit("edit"))},"Edit"),n("button",{class:"dropdown-item danger",onClick:p[1]||(p[1]=g=>v.$emit("delete"))},"Delete")]),_:1})):k("",!0)]),n("div",{class:"post-content",innerHTML:e.post.content_html||e.post.content},null,8,mt),e.post.media&&e.post.media.length?(a(),d("div",ut,[(a(!0),d(q,null,G(e.post.media,g=>(a(),d("img",{key:g.id,src:g.file_path,alt:"Media"},null,8,vt))),128))])):k("",!0),n("div",pt,[n("button",{class:"action-btn",onClick:$},[n("span",null,w(u.value?"â¤ï¸":"ðŸ¤"),1),e.post.reactions_count?(a(),d("span",ft,w(e.post.reactions_count),1)):k("",!0)]),n("button",{class:"action-btn",onClick:f},[p[4]||(p[4]=n("span",null,"ðŸ’¬",-1)),e.post.comments_count?(a(),d("span",ht,w(e.post.comments_count),1)):k("",!0)]),n("button",{class:"action-btn",onClick:p[2]||(p[2]=g=>v.$emit("share"))},[p[5]||(p[5]=n("span",null,"ðŸ”„",-1)),e.post.shares_count?(a(),d("span",yt,w(e.post.shares_count),1)):k("",!0)])]),i.value?(a(),B(lt,{key:1,"post-id":e.post.post_id,"allow-comments":!0},null,8,["post-id"])):k("",!0)])}}}),_t=H(gt,[["__scopeId","data-v-1391c0e5"]]),Ct={class:"post-list"},wt={key:0,class:"loading"},kt={key:1,class:"end-message"},$t=j({__name:"PostList",props:{posts:{},loading:{type:Boolean},hasMore:{type:Boolean}},emits:["react","comment","share","edit","delete"],setup(e,{emit:s}){const t=s,c=(r,$)=>t("react",r,$),l=r=>t("comment",r),i=r=>t("share",r),u=r=>t("edit",r),h=r=>t("delete",r);return(r,$)=>(a(),d("div",Ct,[(a(!0),d(q,null,G(e.posts,f=>(a(),B(_t,{key:f.id,post:f,onReact:v=>c(f.id,v),onComment:v=>l(f.id),onShare:v=>i(f.id),onEdit:v=>u(f.id),onDelete:v=>h(f.id)},null,8,["post","onReact","onComment","onShare","onEdit","onDelete"]))),128)),e.loading?(a(),d("div",wt,[...$[0]||($[0]=[n("div",{class:"spinner"},null,-1),n("p",null,"Loading posts...",-1)])])):k("",!0),!e.loading&&!e.hasMore?(a(),d("div",kt,"No more posts")):k("",!0)]))}}),bt=H($t,[["__scopeId","data-v-220026a9"]]),Pt={key:0,class:"modal-header"},It={key:0,class:"modal-title"},xt={class:"modal-body"},St={key:1,class:"modal-footer"},Mt=j({__name:"AppModal",props:{modelValue:{type:Boolean},title:{},size:{default:"md"},closeable:{type:Boolean,default:!0}},emits:["update:modelValue"],setup(e,{emit:s}){const t=e,c=s,l=D(()=>["modal",`modal-${t.size}`]),i=()=>{t.closeable&&c("update:modelValue",!1)},u=()=>{i()},h=r=>{r.key==="Escape"&&t.modelValue&&i()};return J(()=>{document.addEventListener("keydown",h)}),oe(()=>{document.removeEventListener("keydown",h)}),(r,$)=>(a(),B(ve,{to:"body"},[V(pe,{name:"modal"},{default:A(()=>[e.modelValue?(a(),d("div",{key:0,class:"modal-overlay",onClick:u},[n("div",{class:X(l.value),role:"dialog","aria-modal":"true",onClick:$[0]||($[0]=W(()=>{},["stop"]))},[e.title||e.closeable?(a(),d("div",Pt,[e.title?(a(),d("h3",It,w(e.title),1)):k("",!0),e.closeable?(a(),d("button",{key:1,class:"modal-close","aria-label":"Close modal",onClick:i}," âœ• ")):k("",!0)])):k("",!0),n("div",xt,[le(r.$slots,"default",{},void 0,!0)]),r.$slots.footer?(a(),d("div",St,[le(r.$slots,"footer",{},void 0,!0)])):k("",!0)],2)])):k("",!0)]),_:3})]))}}),Rt=H(Mt,[["__scopeId","data-v-3ba69d9b"]]),Ft={class:"form-actions"},Et=j({__name:"PostCreator",props:{modelValue:{type:Boolean},wallId:{}},emits:["update:modelValue","submit"],setup(e,{emit:s}){const t=e,c=s,l=C(t.modelValue),i=C(""),u=C([]),h=C(),r=C(!1),$=v=>{const p=v.target;p.files&&(u.value=Array.from(p.files))},f=()=>{i.value.trim()&&(c("submit",{wall_id:t.wallId,content:i.value,media_files:u.value}),i.value="",u.value=[],c("update:modelValue",!1))};return(v,p)=>(a(),B(Rt,{modelValue:l.value,"onUpdate:modelValue":p[2]||(p[2]=R=>l.value=R),title:"Create Post",size:"md"},{default:A(()=>[n("form",{onSubmit:W(f,["prevent"])},[te(n("textarea",{"onUpdate:modelValue":p[0]||(p[0]=R=>i.value=R),placeholder:"What's on your mind?",rows:"6",class:"post-input"},null,512),[[ie,i.value]]),n("div",Ft,[n("input",{type:"file",ref_key:"fileInput",ref:h,onChange:$,accept:"image/*,video/*",multiple:"",hidden:""},null,544),V(Z,{type:"button",variant:"ghost",onClick:p[1]||(p[1]=R=>{var T;return(T=h.value)==null?void 0:T.click()})},{default:A(()=>[...p[3]||(p[3]=[O("ðŸ“Ž Add Media",-1)])]),_:1}),V(Z,{type:"submit",variant:"primary",loading:r.value},{default:A(()=>[...p[4]||(p[4]=[O("Post",-1)])]),_:1},8,["loading"])])],32)]),_:1},8,["modelValue"]))}}),Tt=H(Et,[["__scopeId","data-v-3d8180a6"]]),Dt=(e,s={threshold:.8})=>{const t=C(),c=C(!1),l=()=>{if(!t.value||c.value)return;const{scrollTop:i,scrollHeight:u,clientHeight:h}=t.value;(i+h)/u>=s.threshold&&(c.value=!0,e(),setTimeout(()=>{c.value=!1},1e3))};return J(()=>{var i;(i=t.value)==null||i.addEventListener("scroll",l),window.addEventListener("scroll",l)}),oe(()=>{var i;(i=t.value)==null||i.removeEventListener("scroll",l),window.removeEventListener("scroll",l)}),{targetRef:t,isLoading:c}},Vt={class:"home-view"},Lt={class:"feed-header"},At=j({__name:"HomeView",setup(e){const s=ge(),t=C(!1),c=C(1);J(()=>{s.fetchFeed()}),Dt(()=>{s.hasMore&&!s.loading&&s.loadMore()});const l=async f=>{await s.createPost(f)},i=(f,v)=>{s.reactToPost(f,v)},u=f=>{console.log("Comment on post",f)},h=f=>{console.log("Share post",f)},r=f=>{console.log("Edit post",f)},$=async f=>{confirm("Delete this post?")&&await s.deletePost(f)};return(f,v)=>(a(),d("div",Vt,[n("div",Lt,[v[3]||(v[3]=n("h1",null,"Home Feed",-1)),V(Z,{variant:"primary",onClick:v[0]||(v[0]=p=>t.value=!0)},{default:A(()=>[...v[2]||(v[2]=[O("+ Create Post",-1)])]),_:1})]),V(bt,{posts:b(s).feedPosts,loading:b(s).loading,"has-more":b(s).hasMore,onReact:i,onComment:u,onShare:h,onEdit:r,onDelete:$},null,8,["posts","loading","has-more"]),V(Tt,{modelValue:t.value,"onUpdate:modelValue":v[1]||(v[1]=p=>t.value=p),"wall-id":c.value,onSubmit:l},null,8,["modelValue","wall-id"])]))}}),Ut=H(At,[["__scopeId","data-v-b469c97f"]]);export{Ut as default};
//# sourceMappingURL=HomeView-DVwwbNqT.js.map
