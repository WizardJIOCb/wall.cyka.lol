import{f as ae,r,b as se,e as te,g as i,k as e,t as l,F as $,z as C,j as g,s as p,v as b,X as j,V as E,n as P,W as le,i as c}from"./vendor-Bfvy7Eak.js";import{u as oe,i as ne,j as ie,c as v,s as ce,_ as re}from"./index-D53KQBf3.js";import"./utils-Cb2jxgch.js";const ue={class:"settings-view"},de={class:"settings-header"},pe={class:"settings-container"},ve={class:"tabs-nav"},me=["onClick"],fe={class:"tab-icon"},ge={class:"tab-label"},be={class:"tab-content"},he={key:0,class:"tab-panel"},_e={class:"panel-title"},ye={class:"form-section"},we={class:"form-label"},ke=["placeholder"],$e={class:"form-section"},Ce={class:"form-label"},Pe=["placeholder"],Se={class:"form-section"},Ue=["placeholder"],Ne=["placeholder"],Ae=["placeholder"],Ve={class:"form-section danger-zone"},Fe={class:"warning-text"},ze={key:1,class:"tab-panel"},De={class:"panel-title"},Be={class:"form-section"},Te={class:"char-count"},Le={class:"form-section"},We={class:"avatar-upload"},Me=["src"],je=["disabled"],Ee={key:2,class:"tab-panel"},Re={class:"panel-title"},Ge={class:"form-section"},Ie={value:"public"},He={value:"private"},Je={value:"followers"},Oe={key:3,class:"tab-panel"},Xe={class:"panel-title"},qe={class:"form-section"},Ke={class:"checkbox-label"},Qe={class:"form-section"},Ye={class:"checkbox-label"},Ze={key:4,class:"tab-panel"},xe={class:"panel-title"},ea={class:"form-section"},aa={class:"form-label"},sa={class:"theme-selector"},ta=["onClick"],la={class:"form-section"},oa={class:"form-label"},na={class:"language-selector"},ia=["onClick"],ca={class:"language-flag"},ra={class:"language-name"},ua={class:"form-section"},da={class:"form-label"},pa={key:5,class:"tab-panel"},va={class:"panel-title"},ma={class:"bricks-balance"},fa={class:"balance-display"},ga={class:"balance-value"},ba=["disabled"],ha={class:"transactions-section"},_a={key:0,class:"empty-state"},ya={key:1,class:"transactions-list"},wa={class:"settings-footer"},ka=["disabled"],$a=ae({__name:"SettingsView",setup(Ca){var B,T,L,W;const u=oe(),F=ne(),m=r("appearance"),h=r(!1),S=r(ie()),R=[{id:"account",icon:"ðŸ‘¤",label:"Account"},{id:"profile",icon:"ðŸ“",label:"Profile"},{id:"privacy",icon:"ðŸ”’",label:"Privacy"},{id:"notifications",icon:"ðŸ””",label:"Notifications"},{id:"appearance",icon:"ðŸŽ¨",label:"Appearance"},{id:"bricks",icon:"ðŸ§±",label:"Bricks"}],G=[{code:"en",name:"English",flag:"ðŸ‡¬ðŸ‡§"},{code:"ru",name:"Ð ÑƒÑÑÐºÐ¸Ð¹",flag:"ðŸ‡·ðŸ‡º"}],I=[{id:"light",name:"Light",color:"#ffffff"},{id:"dark",name:"Dark",color:"#1a1a1a"},{id:"green",name:"Green",color:"#10b981"},{id:"blue",name:"Blue",color:"#3b82f6"},{id:"cream",name:"Cream",color:"#fef3c7"},{id:"high-contrast",name:"High Contrast",color:"#000000"}],o=r({username:((B=u.user)==null?void 0:B.username)||"",email:((T=u.user)==null?void 0:T.email)||"",bio:((L=u.user)==null?void 0:L.bio)||"",defaultWallPrivacy:"public",emailNotifications:!0,pushNotifications:!0,fontSize:"medium"}),d=r({current:"",new:"",confirm:""}),U=r(F.currentTheme||"light"),z=se(()=>{var a;return((a=u.user)==null?void 0:a.avatar_url)||"/assets/images/default-avatar.svg"}),_=r(z.value),y=r(!1),D=r(null),N=r(((W=u.user)==null?void 0:W.bricks_balance)||0),A=r(!0),H=r(""),V=r([]),J=async a=>{try{ce(a),S.value=a,await v.patch("/users/me/settings",{language:a}),console.log("Language changed to:",a)}catch(s){console.error("Failed to save language preference:",s)}},O=a=>{U.value=a,F.setTheme(a)},X=async()=>{var a,s;if(d.value.new!==d.value.confirm){alert("Passwords do not match");return}try{await v.post("/users/me/change-password",{current_password:d.value.current,new_password:d.value.new}),d.value={current:"",new:"",confirm:""},alert("Password changed successfully")}catch(n){alert(((s=(a=n.response)==null?void 0:a.data)==null?void 0:s.message)||"Failed to change password")}},q=()=>{var a;console.log("triggerAvatarUpload called - opening file picker"),(a=D.value)==null||a.click()},K=async a=>{var M;console.log("handleAvatarSelect called");const s=a.target,n=(M=s.files)==null?void 0:M[0];if(!n){console.log("No file selected");return}if(console.log("File selected:",n.name,n.type,n.size),!["image/jpeg","image/png","image/webp"].includes(n.type)){alert("Please select a valid image file (JPEG, PNG, or WebP)");return}const f=5*1024*1024;if(n.size>f){alert("Image must be smaller than 5MB");return}try{y.value=!0,_.value=URL.createObjectURL(n);const w=new FormData;w.append("avatar",n);const k=await v.upload("/upload/avatar",w);if(!k.success)throw new Error(k.message||"Upload failed");u.updateUser({avatar_url:k.data.avatar_url}),_.value=k.data.avatar_url,alert("Avatar uploaded successfully!")}catch(w){_.value=z.value,alert(w.message||"Failed to upload avatar. Please try again.")}finally{y.value=!1,s&&(s.value="")}},Q=()=>{confirm("Are you sure you want to delete your account? This action cannot be undone.")&&Y()},Y=async()=>{var a,s;try{await v.delete("/users/me/account"),u.logout()}catch(n){alert(((s=(a=n.response)==null?void 0:a.data)==null?void 0:s.message)||"Failed to delete account")}},Z=async()=>{var a,s;try{const n=await v.post("/bricks/claim");n.data.success&&(N.value=n.data.data.new_balance,A.value=!1)}catch(n){alert(((s=(a=n.response)==null?void 0:a.data)==null?void 0:s.message)||"Failed to claim daily bricks")}},x=async()=>{try{const[a,s]=await Promise.all([v.get("/bricks/balance"),v.get("/bricks/transactions?limit=10")]);a.success&&(N.value=a.data.balance,u.updateUser({bricks_balance:a.data.balance})),s.success&&(V.value=s.data.transactions||[])}catch(a){console.error("Failed to load bricks data:",a)}},ee=async()=>{var a,s,n,t;try{h.value=!0,await v.patch("/users/me/settings",{theme:U.value,language:S.value,default_wall_privacy:o.value.defaultWallPrivacy,email_notifications:o.value.emailNotifications,push_notifications:o.value.pushNotifications,font_size:o.value.fontSize}),(o.value.username!==((a=u.user)==null?void 0:a.username)||o.value.email!==((s=u.user)==null?void 0:s.email))&&await v.patch("/users/me",{username:o.value.username,email:o.value.email,bio:o.value.bio}),alert("Settings saved successfully")}catch(f){alert(((t=(n=f.response)==null?void 0:n.data)==null?void 0:t.message)||"Failed to save settings")}finally{h.value=!1}};return te(async()=>{try{const a=await v.get("/auth/me");a.success&&a.data.user&&u.updateUser(a.data.user)}catch(a){console.error("Failed to refresh user data:",a)}x()}),(a,s)=>{var n;return c(),i("div",ue,[e("div",de,[e("h1",null,l(a.$t("settings.title")),1)]),e("div",pe,[e("div",ve,[(c(),i($,null,C(R,t=>e("button",{key:t.id,class:P(["tab-button",{active:m.value===t.id}]),onClick:f=>m.value=t.id},[e("span",fe,l(t.icon),1),e("span",ge,l(a.$t(`settings.tabs.${t.id}`)),1)],10,me)),64))]),e("div",be,[m.value==="account"?(c(),i("div",he,[e("h2",_e,l(a.$t("settings.tabs.account")),1),e("div",ye,[e("label",we,l(a.$t("settings.account.username")),1),p(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>o.value.username=t),type:"text",class:"form-input",placeholder:a.$t("settings.account.username")},null,8,ke),[[b,o.value.username]])]),e("div",$e,[e("label",Ce,l(a.$t("settings.account.email")),1),p(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>o.value.email=t),type:"email",class:"form-input",placeholder:a.$t("settings.account.email")},null,8,Pe),[[b,o.value.email]])]),e("div",Se,[e("h3",null,l(a.$t("settings.account.changePassword")),1),p(e("input",{"onUpdate:modelValue":s[2]||(s[2]=t=>d.value.current=t),type:"password",class:"form-input",placeholder:a.$t("settings.account.currentPassword")},null,8,Ue),[[b,d.value.current]]),p(e("input",{"onUpdate:modelValue":s[3]||(s[3]=t=>d.value.new=t),type:"password",class:"form-input",placeholder:a.$t("settings.account.newPassword")},null,8,Ne),[[b,d.value.new]]),p(e("input",{"onUpdate:modelValue":s[4]||(s[4]=t=>d.value.confirm=t),type:"password",class:"form-input",placeholder:a.$t("settings.account.confirmNewPassword")},null,8,Ae),[[b,d.value.confirm]]),e("button",{onClick:X,class:"btn-primary"},l(a.$t("common.buttons.update")),1)]),e("div",Ve,[e("h3",null,l(a.$t("settings.account.deleteAccount")),1),e("p",Fe,l(a.$t("settings.account.deleteAccountWarning")),1),e("button",{onClick:Q,class:"btn-danger"},l(a.$t("common.buttons.delete")),1)])])):g("",!0),m.value==="profile"?(c(),i("div",ze,[e("h2",De,l(a.$t("settings.tabs.profile")),1),e("div",Be,[s[10]||(s[10]=e("label",{class:"form-label"},"Bio",-1)),p(e("textarea",{"onUpdate:modelValue":s[5]||(s[5]=t=>o.value.bio=t),class:"form-textarea",placeholder:"Tell us about yourself...",rows:"4",maxlength:"500"},null,512),[[b,o.value.bio]]),e("span",Te,l(((n=o.value.bio)==null?void 0:n.length)||0)+"/500",1)]),e("div",Le,[s[11]||(s[11]=e("label",{class:"form-label"},"Avatar",-1)),e("div",We,[e("img",{src:_.value,alt:"Avatar",class:"avatar-preview"},null,8,Me),e("input",{ref_key:"avatarFileInput",ref:D,type:"file",accept:"image/jpeg,image/png,image/webp",onChange:K,style:{display:"none"}},null,544),e("button",{onClick:q,class:"btn-secondary",disabled:y.value},l(y.value?"Uploading...":a.$t("common.actions.upload")),9,je)])])])):g("",!0),m.value==="privacy"?(c(),i("div",Ee,[e("h2",Re,l(a.$t("settings.tabs.privacy")),1),e("div",Ge,[s[12]||(s[12]=e("label",{class:"form-label"},"Default Wall Privacy",-1)),p(e("select",{"onUpdate:modelValue":s[6]||(s[6]=t=>o.value.defaultWallPrivacy=t),class:"form-select"},[e("option",Ie,l(a.$t("walls.public")),1),e("option",He,l(a.$t("walls.private")),1),e("option",Je,l(a.$t("walls.followers")),1)],512),[[j,o.value.defaultWallPrivacy]])])])):g("",!0),m.value==="notifications"?(c(),i("div",Oe,[e("h2",Xe,l(a.$t("settings.tabs.notifications")),1),e("div",qe,[e("label",Ke,[p(e("input",{"onUpdate:modelValue":s[7]||(s[7]=t=>o.value.emailNotifications=t),type:"checkbox"},null,512),[[E,o.value.emailNotifications]]),s[13]||(s[13]=e("span",null,"Email Notifications",-1))])]),e("div",Qe,[e("label",Ye,[p(e("input",{"onUpdate:modelValue":s[8]||(s[8]=t=>o.value.pushNotifications=t),type:"checkbox"},null,512),[[E,o.value.pushNotifications]]),s[14]||(s[14]=e("span",null,"Push Notifications",-1))])])])):g("",!0),m.value==="appearance"?(c(),i("div",Ze,[e("h2",xe,l(a.$t("settings.tabs.appearance")),1),e("div",ea,[e("label",aa,l(a.$t("settings.appearance.theme")),1),e("div",sa,[(c(),i($,null,C(I,t=>e("button",{key:t.id,class:P(["theme-option",{active:U.value===t.id}]),onClick:f=>O(t.id)},[e("span",{class:"theme-preview",style:le({background:t.color})},null,4),e("span",null,l(t.name),1)],10,ta)),64))])]),e("div",la,[e("label",oa,l(a.$t("settings.appearance.language")),1),e("div",na,[(c(),i($,null,C(G,t=>e("button",{key:t.code,class:P(["language-option",{active:S.value===t.code}]),onClick:f=>J(t.code)},[e("span",ca,l(t.flag),1),e("span",ra,l(t.name),1)],10,ia)),64))])]),e("div",ua,[e("label",da,l(a.$t("settings.appearance.fontSize")),1),p(e("select",{"onUpdate:modelValue":s[9]||(s[9]=t=>o.value.fontSize=t),class:"form-select"},[...s[15]||(s[15]=[e("option",{value:"small"},"Small",-1),e("option",{value:"medium"},"Medium",-1),e("option",{value:"large"},"Large",-1)])],512),[[j,o.value.fontSize]])])])):g("",!0),m.value==="bricks"?(c(),i("div",pa,[e("h2",va,l(a.$t("settings.tabs.bricks")),1),e("div",ma,[e("div",fa,[s[16]||(s[16]=e("span",{class:"balance-label"},"Current Balance",-1)),e("span",ga,l(N.value)+" ðŸ§±",1)]),e("button",{onClick:Z,disabled:!A.value,class:"btn-primary"},l(A.value?"Claim Daily Bricks":`Next claim in ${H.value}`),9,ba)]),e("div",ha,[s[17]||(s[17]=e("h3",null,"Recent Transactions",-1)),V.value.length===0?(c(),i("div",_a," No transactions yet ")):(c(),i("div",ya,[(c(!0),i($,null,C(V.value,t=>(c(),i("div",{key:t.id,class:"transaction-item"},[e("span",null,l(t.description),1),e("span",{class:P(["transaction-amount",t.amount>0?"positive":"negative"])},l(t.amount>0?"+":"")+l(t.amount)+" ðŸ§± ",3)]))),128))]))])])):g("",!0)])]),e("div",wa,[e("button",{onClick:ee,class:"btn-primary btn-large",disabled:h.value},l(h.value?"Saving...":a.$t("common.buttons.save")),9,ka)])])}}}),Na=re($a,[["__scopeId","data-v-8eb62e58"]]);export{Na as default};
//# sourceMappingURL=SettingsView-BfTOeNDt.js.map
import{f as ae,r,b as se,e as te,g as i,k as e,t as l,F as $,z as C,j as g,s as p,v as b,X as j,V as E,n as P,W as le,i as c}from"./vendor-Bfvy7Eak.js";import{u as oe,i as ne,j as ie,c as v,s as ce,_ as re}from"./index-D53KQBf3.js";import"./utils-Cb2jxgch.js";const ue={class:"settings-view"},de={class:"settings-header"},pe={class:"settings-container"},ve={class:"tabs-nav"},me=["onClick"],fe={class:"tab-icon"},ge={class:"tab-label"},be={class:"tab-content"},he={key:0,class:"tab-panel"},_e={class:"panel-title"},ye={class:"form-section"},we={class:"form-label"},ke=["placeholder"],$e={class:"form-section"},Ce={class:"form-label"},Pe=["placeholder"],Se={class:"form-section"},Ue=["placeholder"],Ne=["placeholder"],Ae=["placeholder"],Ve={class:"form-section danger-zone"},Fe={class:"warning-text"},ze={key:1,class:"tab-panel"},De={class:"panel-title"},Be={class:"form-section"},Te={class:"char-count"},Le={class:"form-section"},We={class:"avatar-upload"},Me=["src"],je=["disabled"],Ee={key:2,class:"tab-panel"},Re={class:"panel-title"},Ge={class:"form-section"},Ie={value:"public"},He={value:"private"},Je={value:"followers"},Oe={key:3,class:"tab-panel"},Xe={class:"panel-title"},qe={class:"form-section"},Ke={class:"checkbox-label"},Qe={class:"form-section"},Ye={class:"checkbox-label"},Ze={key:4,class:"tab-panel"},xe={class:"panel-title"},ea={class:"form-section"},aa={class:"form-label"},sa={class:"theme-selector"},ta=["onClick"],la={class:"form-section"},oa={class:"form-label"},na={class:"language-selector"},ia=["onClick"],ca={class:"language-flag"},ra={class:"language-name"},ua={class:"form-section"},da={class:"form-label"},pa={key:5,class:"tab-panel"},va={class:"panel-title"},ma={class:"bricks-balance"},fa={class:"balance-display"},ga={class:"balance-value"},ba=["disabled"],ha={class:"transactions-section"},_a={key:0,class:"empty-state"},ya={key:1,class:"transactions-list"},wa={class:"settings-footer"},ka=["disabled"],$a=ae({__name:"SettingsView",setup(Ca){var B,T,L,W;const u=oe(),F=ne(),m=r("appearance"),h=r(!1),S=r(ie()),R=[{id:"account",icon:"ðŸ‘¤",label:"Account"},{id:"profile",icon:"ðŸ“",label:"Profile"},{id:"privacy",icon:"ðŸ”’",label:"Privacy"},{id:"notifications",icon:"ðŸ””",label:"Notifications"},{id:"appearance",icon:"ðŸŽ¨",label:"Appearance"},{id:"bricks",icon:"ðŸ§±",label:"Bricks"}],G=[{code:"en",name:"English",flag:"ðŸ‡¬ðŸ‡§"},{code:"ru",name:"Ð ÑƒÑÑÐºÐ¸Ð¹",flag:"ðŸ‡·ðŸ‡º"}],I=[{id:"light",name:"Light",color:"#ffffff"},{id:"dark",name:"Dark",color:"#1a1a1a"},{id:"green",name:"Green",color:"#10b981"},{id:"blue",name:"Blue",color:"#3b82f6"},{id:"cream",name:"Cream",color:"#fef3c7"},{id:"high-contrast",name:"High Contrast",color:"#000000"}],o=r({username:((B=u.user)==null?void 0:B.username)||"",email:((T=u.user)==null?void 0:T.email)||"",bio:((L=u.user)==null?void 0:L.bio)||"",defaultWallPrivacy:"public",emailNotifications:!0,pushNotifications:!0,fontSize:"medium"}),d=r({current:"",new:"",confirm:""}),U=r(F.currentTheme||"light"),z=se(()=>{var a;return((a=u.user)==null?void 0:a.avatar_url)||"/assets/images/default-avatar.svg"}),_=r(z.value),y=r(!1),D=r(null),N=r(((W=u.user)==null?void 0:W.bricks_balance)||0),A=r(!0),H=r(""),V=r([]),J=async a=>{try{ce(a),S.value=a,await v.patch("/users/me/settings",{language:a}),console.log("Language changed to:",a)}catch(s){console.error("Failed to save language preference:",s)}},O=a=>{U.value=a,F.setTheme(a)},X=async()=>{var a,s;if(d.value.new!==d.value.confirm){alert("Passwords do not match");return}try{await v.post("/users/me/change-password",{current_password:d.value.current,new_password:d.value.new}),d.value={current:"",new:"",confirm:""},alert("Password changed successfully")}catch(n){alert(((s=(a=n.response)==null?void 0:a.data)==null?void 0:s.message)||"Failed to change password")}},q=()=>{var a;console.log("triggerAvatarUpload called - opening file picker"),(a=D.value)==null||a.click()},K=async a=>{var M;console.log("handleAvatarSelect called");const s=a.target,n=(M=s.files)==null?void 0:M[0];if(!n){console.log("No file selected");return}if(console.log("File selected:",n.name,n.type,n.size),!["image/jpeg","image/png","image/webp"].includes(n.type)){alert("Please select a valid image file (JPEG, PNG, or WebP)");return}const f=5*1024*1024;if(n.size>f){alert("Image must be smaller than 5MB");return}try{y.value=!0,_.value=URL.createObjectURL(n);const w=new FormData;w.append("avatar",n);const k=await v.upload("/upload/avatar",w);if(!k.success)throw new Error(k.message||"Upload failed");u.updateUser({avatar_url:k.data.avatar_url}),_.value=k.data.avatar_url,alert("Avatar uploaded successfully!")}catch(w){_.value=z.value,alert(w.message||"Failed to upload avatar. Please try again.")}finally{y.value=!1,s&&(s.value="")}},Q=()=>{confirm("Are you sure you want to delete your account? This action cannot be undone.")&&Y()},Y=async()=>{var a,s;try{await v.delete("/users/me/account"),u.logout()}catch(n){alert(((s=(a=n.response)==null?void 0:a.data)==null?void 0:s.message)||"Failed to delete account")}},Z=async()=>{var a,s;try{const n=await v.post("/bricks/claim");n.data.success&&(N.value=n.data.data.new_balance,A.value=!1)}catch(n){alert(((s=(a=n.response)==null?void 0:a.data)==null?void 0:s.message)||"Failed to claim daily bricks")}},x=async()=>{try{const[a,s]=await Promise.all([v.get("/bricks/balance"),v.get("/bricks/transactions?limit=10")]);a.success&&(N.value=a.data.balance,u.updateUser({bricks_balance:a.data.balance})),s.success&&(V.value=s.data.transactions||[])}catch(a){console.error("Failed to load bricks data:",a)}},ee=async()=>{var a,s,n,t;try{h.value=!0,await v.patch("/users/me/settings",{theme:U.value,language:S.value,default_wall_privacy:o.value.defaultWallPrivacy,email_notifications:o.value.emailNotifications,push_notifications:o.value.pushNotifications,font_size:o.value.fontSize}),(o.value.username!==((a=u.user)==null?void 0:a.username)||o.value.email!==((s=u.user)==null?void 0:s.email))&&await v.patch("/users/me",{username:o.value.username,email:o.value.email,bio:o.value.bio}),alert("Settings saved successfully")}catch(f){alert(((t=(n=f.response)==null?void 0:n.data)==null?void 0:t.message)||"Failed to save settings")}finally{h.value=!1}};return te(async()=>{try{const a=await v.get("/auth/me");a.success&&a.data.user&&u.updateUser(a.data.user)}catch(a){console.error("Failed to refresh user data:",a)}x()}),(a,s)=>{var n;return c(),i("div",ue,[e("div",de,[e("h1",null,l(a.$t("settings.title")),1)]),e("div",pe,[e("div",ve,[(c(),i($,null,C(R,t=>e("button",{key:t.id,class:P(["tab-button",{active:m.value===t.id}]),onClick:f=>m.value=t.id},[e("span",fe,l(t.icon),1),e("span",ge,l(a.$t(`settings.tabs.${t.id}`)),1)],10,me)),64))]),e("div",be,[m.value==="account"?(c(),i("div",he,[e("h2",_e,l(a.$t("settings.tabs.account")),1),e("div",ye,[e("label",we,l(a.$t("settings.account.username")),1),p(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>o.value.username=t),type:"text",class:"form-input",placeholder:a.$t("settings.account.username")},null,8,ke),[[b,o.value.username]])]),e("div",$e,[e("label",Ce,l(a.$t("settings.account.email")),1),p(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>o.value.email=t),type:"email",class:"form-input",placeholder:a.$t("settings.account.email")},null,8,Pe),[[b,o.value.email]])]),e("div",Se,[e("h3",null,l(a.$t("settings.account.changePassword")),1),p(e("input",{"onUpdate:modelValue":s[2]||(s[2]=t=>d.value.current=t),type:"password",class:"form-input",placeholder:a.$t("settings.account.currentPassword")},null,8,Ue),[[b,d.value.current]]),p(e("input",{"onUpdate:modelValue":s[3]||(s[3]=t=>d.value.new=t),type:"password",class:"form-input",placeholder:a.$t("settings.account.newPassword")},null,8,Ne),[[b,d.value.new]]),p(e("input",{"onUpdate:modelValue":s[4]||(s[4]=t=>d.value.confirm=t),type:"password",class:"form-input",placeholder:a.$t("settings.account.confirmNewPassword")},null,8,Ae),[[b,d.value.confirm]]),e("button",{onClick:X,class:"btn-primary"},l(a.$t("common.buttons.update")),1)]),e("div",Ve,[e("h3",null,l(a.$t("settings.account.deleteAccount")),1),e("p",Fe,l(a.$t("settings.account.deleteAccountWarning")),1),e("button",{onClick:Q,class:"btn-danger"},l(a.$t("common.buttons.delete")),1)])])):g("",!0),m.value==="profile"?(c(),i("div",ze,[e("h2",De,l(a.$t("settings.tabs.profile")),1),e("div",Be,[s[10]||(s[10]=e("label",{class:"form-label"},"Bio",-1)),p(e("textarea",{"onUpdate:modelValue":s[5]||(s[5]=t=>o.value.bio=t),class:"form-textarea",placeholder:"Tell us about yourself...",rows:"4",maxlength:"500"},null,512),[[b,o.value.bio]]),e("span",Te,l(((n=o.value.bio)==null?void 0:n.length)||0)+"/500",1)]),e("div",Le,[s[11]||(s[11]=e("label",{class:"form-label"},"Avatar",-1)),e("div",We,[e("img",{src:_.value,alt:"Avatar",class:"avatar-preview"},null,8,Me),e("input",{ref_key:"avatarFileInput",ref:D,type:"file",accept:"image/jpeg,image/png,image/webp",onChange:K,style:{display:"none"}},null,544),e("button",{onClick:q,class:"btn-secondary",disabled:y.value},l(y.value?"Uploading...":a.$t("common.actions.upload")),9,je)])])])):g("",!0),m.value==="privacy"?(c(),i("div",Ee,[e("h2",Re,l(a.$t("settings.tabs.privacy")),1),e("div",Ge,[s[12]||(s[12]=e("label",{class:"form-label"},"Default Wall Privacy",-1)),p(e("select",{"onUpdate:modelValue":s[6]||(s[6]=t=>o.value.defaultWallPrivacy=t),class:"form-select"},[e("option",Ie,l(a.$t("walls.public")),1),e("option",He,l(a.$t("walls.private")),1),e("option",Je,l(a.$t("walls.followers")),1)],512),[[j,o.value.defaultWallPrivacy]])])])):g("",!0),m.value==="notifications"?(c(),i("div",Oe,[e("h2",Xe,l(a.$t("settings.tabs.notifications")),1),e("div",qe,[e("label",Ke,[p(e("input",{"onUpdate:modelValue":s[7]||(s[7]=t=>o.value.emailNotifications=t),type:"checkbox"},null,512),[[E,o.value.emailNotifications]]),s[13]||(s[13]=e("span",null,"Email Notifications",-1))])]),e("div",Qe,[e("label",Ye,[p(e("input",{"onUpdate:modelValue":s[8]||(s[8]=t=>o.value.pushNotifications=t),type:"checkbox"},null,512),[[E,o.value.pushNotifications]]),s[14]||(s[14]=e("span",null,"Push Notifications",-1))])])])):g("",!0),m.value==="appearance"?(c(),i("div",Ze,[e("h2",xe,l(a.$t("settings.tabs.appearance")),1),e("div",ea,[e("label",aa,l(a.$t("settings.appearance.theme")),1),e("div",sa,[(c(),i($,null,C(I,t=>e("button",{key:t.id,class:P(["theme-option",{active:U.value===t.id}]),onClick:f=>O(t.id)},[e("span",{class:"theme-preview",style:le({background:t.color})},null,4),e("span",null,l(t.name),1)],10,ta)),64))])]),e("div",la,[e("label",oa,l(a.$t("settings.appearance.language")),1),e("div",na,[(c(),i($,null,C(G,t=>e("button",{key:t.code,class:P(["language-option",{active:S.value===t.code}]),onClick:f=>J(t.code)},[e("span",ca,l(t.flag),1),e("span",ra,l(t.name),1)],10,ia)),64))])]),e("div",ua,[e("label",da,l(a.$t("settings.appearance.fontSize")),1),p(e("select",{"onUpdate:modelValue":s[9]||(s[9]=t=>o.value.fontSize=t),class:"form-select"},[...s[15]||(s[15]=[e("option",{value:"small"},"Small",-1),e("option",{value:"medium"},"Medium",-1),e("option",{value:"large"},"Large",-1)])],512),[[j,o.value.fontSize]])])])):g("",!0),m.value==="bricks"?(c(),i("div",pa,[e("h2",va,l(a.$t("settings.tabs.bricks")),1),e("div",ma,[e("div",fa,[s[16]||(s[16]=e("span",{class:"balance-label"},"Current Balance",-1)),e("span",ga,l(N.value)+" ðŸ§±",1)]),e("button",{onClick:Z,disabled:!A.value,class:"btn-primary"},l(A.value?"Claim Daily Bricks":`Next claim in ${H.value}`),9,ba)]),e("div",ha,[s[17]||(s[17]=e("h3",null,"Recent Transactions",-1)),V.value.length===0?(c(),i("div",_a," No transactions yet ")):(c(),i("div",ya,[(c(!0),i($,null,C(V.value,t=>(c(),i("div",{key:t.id,class:"transaction-item"},[e("span",null,l(t.description),1),e("span",{class:P(["transaction-amount",t.amount>0?"positive":"negative"])},l(t.amount>0?"+":"")+l(t.amount)+" ðŸ§± ",3)]))),128))]))])])):g("",!0)])]),e("div",wa,[e("button",{onClick:ee,class:"btn-primary btn-large",disabled:h.value},l(h.value?"Saving...":a.$t("common.buttons.save")),9,ka)])])}}}),Na=re($a,[["__scopeId","data-v-8eb62e58"]]);export{Na as default};
//# sourceMappingURL=SettingsView-BfTOeNDt.js.map
import{f as ae,r,b as se,e as te,g as i,k as e,t as l,F as $,z as C,j as g,s as p,v as b,X as j,V as E,n as P,W as le,i as c}from"./vendor-Bfvy7Eak.js";import{u as oe,i as ne,j as ie,c as v,s as ce,_ as re}from"./index-D53KQBf3.js";import"./utils-Cb2jxgch.js";const ue={class:"settings-view"},de={class:"settings-header"},pe={class:"settings-container"},ve={class:"tabs-nav"},me=["onClick"],fe={class:"tab-icon"},ge={class:"tab-label"},be={class:"tab-content"},he={key:0,class:"tab-panel"},_e={class:"panel-title"},ye={class:"form-section"},we={class:"form-label"},ke=["placeholder"],$e={class:"form-section"},Ce={class:"form-label"},Pe=["placeholder"],Se={class:"form-section"},Ue=["placeholder"],Ne=["placeholder"],Ae=["placeholder"],Ve={class:"form-section danger-zone"},Fe={class:"warning-text"},ze={key:1,class:"tab-panel"},De={class:"panel-title"},Be={class:"form-section"},Te={class:"char-count"},Le={class:"form-section"},We={class:"avatar-upload"},Me=["src"],je=["disabled"],Ee={key:2,class:"tab-panel"},Re={class:"panel-title"},Ge={class:"form-section"},Ie={value:"public"},He={value:"private"},Je={value:"followers"},Oe={key:3,class:"tab-panel"},Xe={class:"panel-title"},qe={class:"form-section"},Ke={class:"checkbox-label"},Qe={class:"form-section"},Ye={class:"checkbox-label"},Ze={key:4,class:"tab-panel"},xe={class:"panel-title"},ea={class:"form-section"},aa={class:"form-label"},sa={class:"theme-selector"},ta=["onClick"],la={class:"form-section"},oa={class:"form-label"},na={class:"language-selector"},ia=["onClick"],ca={class:"language-flag"},ra={class:"language-name"},ua={class:"form-section"},da={class:"form-label"},pa={key:5,class:"tab-panel"},va={class:"panel-title"},ma={class:"bricks-balance"},fa={class:"balance-display"},ga={class:"balance-value"},ba=["disabled"],ha={class:"transactions-section"},_a={key:0,class:"empty-state"},ya={key:1,class:"transactions-list"},wa={class:"settings-footer"},ka=["disabled"],$a=ae({__name:"SettingsView",setup(Ca){var B,T,L,W;const u=oe(),F=ne(),m=r("appearance"),h=r(!1),S=r(ie()),R=[{id:"account",icon:"ðŸ‘¤",label:"Account"},{id:"profile",icon:"ðŸ“",label:"Profile"},{id:"privacy",icon:"ðŸ”’",label:"Privacy"},{id:"notifications",icon:"ðŸ””",label:"Notifications"},{id:"appearance",icon:"ðŸŽ¨",label:"Appearance"},{id:"bricks",icon:"ðŸ§±",label:"Bricks"}],G=[{code:"en",name:"English",flag:"ðŸ‡¬ðŸ‡§"},{code:"ru",name:"Ð ÑƒÑÑÐºÐ¸Ð¹",flag:"ðŸ‡·ðŸ‡º"}],I=[{id:"light",name:"Light",color:"#ffffff"},{id:"dark",name:"Dark",color:"#1a1a1a"},{id:"green",name:"Green",color:"#10b981"},{id:"blue",name:"Blue",color:"#3b82f6"},{id:"cream",name:"Cream",color:"#fef3c7"},{id:"high-contrast",name:"High Contrast",color:"#000000"}],o=r({username:((B=u.user)==null?void 0:B.username)||"",email:((T=u.user)==null?void 0:T.email)||"",bio:((L=u.user)==null?void 0:L.bio)||"",defaultWallPrivacy:"public",emailNotifications:!0,pushNotifications:!0,fontSize:"medium"}),d=r({current:"",new:"",confirm:""}),U=r(F.currentTheme||"light"),z=se(()=>{var a;return((a=u.user)==null?void 0:a.avatar_url)||"/assets/images/default-avatar.svg"}),_=r(z.value),y=r(!1),D=r(null),N=r(((W=u.user)==null?void 0:W.bricks_balance)||0),A=r(!0),H=r(""),V=r([]),J=async a=>{try{ce(a),S.value=a,await v.patch("/users/me/settings",{language:a}),console.log("Language changed to:",a)}catch(s){console.error("Failed to save language preference:",s)}},O=a=>{U.value=a,F.setTheme(a)},X=async()=>{var a,s;if(d.value.new!==d.value.confirm){alert("Passwords do not match");return}try{await v.post("/users/me/change-password",{current_password:d.value.current,new_password:d.value.new}),d.value={current:"",new:"",confirm:""},alert("Password changed successfully")}catch(n){alert(((s=(a=n.response)==null?void 0:a.data)==null?void 0:s.message)||"Failed to change password")}},q=()=>{var a;console.log("triggerAvatarUpload called - opening file picker"),(a=D.value)==null||a.click()},K=async a=>{var M;console.log("handleAvatarSelect called");const s=a.target,n=(M=s.files)==null?void 0:M[0];if(!n){console.log("No file selected");return}if(console.log("File selected:",n.name,n.type,n.size),!["image/jpeg","image/png","image/webp"].includes(n.type)){alert("Please select a valid image file (JPEG, PNG, or WebP)");return}const f=5*1024*1024;if(n.size>f){alert("Image must be smaller than 5MB");return}try{y.value=!0,_.value=URL.createObjectURL(n);const w=new FormData;w.append("avatar",n);const k=await v.upload("/upload/avatar",w);if(!k.success)throw new Error(k.message||"Upload failed");u.updateUser({avatar_url:k.data.avatar_url}),_.value=k.data.avatar_url,alert("Avatar uploaded successfully!")}catch(w){_.value=z.value,alert(w.message||"Failed to upload avatar. Please try again.")}finally{y.value=!1,s&&(s.value="")}},Q=()=>{confirm("Are you sure you want to delete your account? This action cannot be undone.")&&Y()},Y=async()=>{var a,s;try{await v.delete("/users/me/account"),u.logout()}catch(n){alert(((s=(a=n.response)==null?void 0:a.data)==null?void 0:s.message)||"Failed to delete account")}},Z=async()=>{var a,s;try{const n=await v.post("/bricks/claim");n.data.success&&(N.value=n.data.data.new_balance,A.value=!1)}catch(n){alert(((s=(a=n.response)==null?void 0:a.data)==null?void 0:s.message)||"Failed to claim daily bricks")}},x=async()=>{try{const[a,s]=await Promise.all([v.get("/bricks/balance"),v.get("/bricks/transactions?limit=10")]);a.success&&(N.value=a.data.balance,u.updateUser({bricks_balance:a.data.balance})),s.success&&(V.value=s.data.transactions||[])}catch(a){console.error("Failed to load bricks data:",a)}},ee=async()=>{var a,s,n,t;try{h.value=!0,await v.patch("/users/me/settings",{theme:U.value,language:S.value,default_wall_privacy:o.value.defaultWallPrivacy,email_notifications:o.value.emailNotifications,push_notifications:o.value.pushNotifications,font_size:o.value.fontSize}),(o.value.username!==((a=u.user)==null?void 0:a.username)||o.value.email!==((s=u.user)==null?void 0:s.email))&&await v.patch("/users/me",{username:o.value.username,email:o.value.email,bio:o.value.bio}),alert("Settings saved successfully")}catch(f){alert(((t=(n=f.response)==null?void 0:n.data)==null?void 0:t.message)||"Failed to save settings")}finally{h.value=!1}};return te(async()=>{try{const a=await v.get("/auth/me");a.success&&a.data.user&&u.updateUser(a.data.user)}catch(a){console.error("Failed to refresh user data:",a)}x()}),(a,s)=>{var n;return c(),i("div",ue,[e("div",de,[e("h1",null,l(a.$t("settings.title")),1)]),e("div",pe,[e("div",ve,[(c(),i($,null,C(R,t=>e("button",{key:t.id,class:P(["tab-button",{active:m.value===t.id}]),onClick:f=>m.value=t.id},[e("span",fe,l(t.icon),1),e("span",ge,l(a.$t(`settings.tabs.${t.id}`)),1)],10,me)),64))]),e("div",be,[m.value==="account"?(c(),i("div",he,[e("h2",_e,l(a.$t("settings.tabs.account")),1),e("div",ye,[e("label",we,l(a.$t("settings.account.username")),1),p(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>o.value.username=t),type:"text",class:"form-input",placeholder:a.$t("settings.account.username")},null,8,ke),[[b,o.value.username]])]),e("div",$e,[e("label",Ce,l(a.$t("settings.account.email")),1),p(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>o.value.email=t),type:"email",class:"form-input",placeholder:a.$t("settings.account.email")},null,8,Pe),[[b,o.value.email]])]),e("div",Se,[e("h3",null,l(a.$t("settings.account.changePassword")),1),p(e("input",{"onUpdate:modelValue":s[2]||(s[2]=t=>d.value.current=t),type:"password",class:"form-input",placeholder:a.$t("settings.account.currentPassword")},null,8,Ue),[[b,d.value.current]]),p(e("input",{"onUpdate:modelValue":s[3]||(s[3]=t=>d.value.new=t),type:"password",class:"form-input",placeholder:a.$t("settings.account.newPassword")},null,8,Ne),[[b,d.value.new]]),p(e("input",{"onUpdate:modelValue":s[4]||(s[4]=t=>d.value.confirm=t),type:"password",class:"form-input",placeholder:a.$t("settings.account.confirmNewPassword")},null,8,Ae),[[b,d.value.confirm]]),e("button",{onClick:X,class:"btn-primary"},l(a.$t("common.buttons.update")),1)]),e("div",Ve,[e("h3",null,l(a.$t("settings.account.deleteAccount")),1),e("p",Fe,l(a.$t("settings.account.deleteAccountWarning")),1),e("button",{onClick:Q,class:"btn-danger"},l(a.$t("common.buttons.delete")),1)])])):g("",!0),m.value==="profile"?(c(),i("div",ze,[e("h2",De,l(a.$t("settings.tabs.profile")),1),e("div",Be,[s[10]||(s[10]=e("label",{class:"form-label"},"Bio",-1)),p(e("textarea",{"onUpdate:modelValue":s[5]||(s[5]=t=>o.value.bio=t),class:"form-textarea",placeholder:"Tell us about yourself...",rows:"4",maxlength:"500"},null,512),[[b,o.value.bio]]),e("span",Te,l(((n=o.value.bio)==null?void 0:n.length)||0)+"/500",1)]),e("div",Le,[s[11]||(s[11]=e("label",{class:"form-label"},"Avatar",-1)),e("div",We,[e("img",{src:_.value,alt:"Avatar",class:"avatar-preview"},null,8,Me),e("input",{ref_key:"avatarFileInput",ref:D,type:"file",accept:"image/jpeg,image/png,image/webp",onChange:K,style:{display:"none"}},null,544),e("button",{onClick:q,class:"btn-secondary",disabled:y.value},l(y.value?"Uploading...":a.$t("common.actions.upload")),9,je)])])])):g("",!0),m.value==="privacy"?(c(),i("div",Ee,[e("h2",Re,l(a.$t("settings.tabs.privacy")),1),e("div",Ge,[s[12]||(s[12]=e("label",{class:"form-label"},"Default Wall Privacy",-1)),p(e("select",{"onUpdate:modelValue":s[6]||(s[6]=t=>o.value.defaultWallPrivacy=t),class:"form-select"},[e("option",Ie,l(a.$t("walls.public")),1),e("option",He,l(a.$t("walls.private")),1),e("option",Je,l(a.$t("walls.followers")),1)],512),[[j,o.value.defaultWallPrivacy]])])])):g("",!0),m.value==="notifications"?(c(),i("div",Oe,[e("h2",Xe,l(a.$t("settings.tabs.notifications")),1),e("div",qe,[e("label",Ke,[p(e("input",{"onUpdate:modelValue":s[7]||(s[7]=t=>o.value.emailNotifications=t),type:"checkbox"},null,512),[[E,o.value.emailNotifications]]),s[13]||(s[13]=e("span",null,"Email Notifications",-1))])]),e("div",Qe,[e("label",Ye,[p(e("input",{"onUpdate:modelValue":s[8]||(s[8]=t=>o.value.pushNotifications=t),type:"checkbox"},null,512),[[E,o.value.pushNotifications]]),s[14]||(s[14]=e("span",null,"Push Notifications",-1))])])])):g("",!0),m.value==="appearance"?(c(),i("div",Ze,[e("h2",xe,l(a.$t("settings.tabs.appearance")),1),e("div",ea,[e("label",aa,l(a.$t("settings.appearance.theme")),1),e("div",sa,[(c(),i($,null,C(I,t=>e("button",{key:t.id,class:P(["theme-option",{active:U.value===t.id}]),onClick:f=>O(t.id)},[e("span",{class:"theme-preview",style:le({background:t.color})},null,4),e("span",null,l(t.name),1)],10,ta)),64))])]),e("div",la,[e("label",oa,l(a.$t("settings.appearance.language")),1),e("div",na,[(c(),i($,null,C(G,t=>e("button",{key:t.code,class:P(["language-option",{active:S.value===t.code}]),onClick:f=>J(t.code)},[e("span",ca,l(t.flag),1),e("span",ra,l(t.name),1)],10,ia)),64))])]),e("div",ua,[e("label",da,l(a.$t("settings.appearance.fontSize")),1),p(e("select",{"onUpdate:modelValue":s[9]||(s[9]=t=>o.value.fontSize=t),class:"form-select"},[...s[15]||(s[15]=[e("option",{value:"small"},"Small",-1),e("option",{value:"medium"},"Medium",-1),e("option",{value:"large"},"Large",-1)])],512),[[j,o.value.fontSize]])])])):g("",!0),m.value==="bricks"?(c(),i("div",pa,[e("h2",va,l(a.$t("settings.tabs.bricks")),1),e("div",ma,[e("div",fa,[s[16]||(s[16]=e("span",{class:"balance-label"},"Current Balance",-1)),e("span",ga,l(N.value)+" ðŸ§±",1)]),e("button",{onClick:Z,disabled:!A.value,class:"btn-primary"},l(A.value?"Claim Daily Bricks":`Next claim in ${H.value}`),9,ba)]),e("div",ha,[s[17]||(s[17]=e("h3",null,"Recent Transactions",-1)),V.value.length===0?(c(),i("div",_a," No transactions yet ")):(c(),i("div",ya,[(c(!0),i($,null,C(V.value,t=>(c(),i("div",{key:t.id,class:"transaction-item"},[e("span",null,l(t.description),1),e("span",{class:P(["transaction-amount",t.amount>0?"positive":"negative"])},l(t.amount>0?"+":"")+l(t.amount)+" ðŸ§± ",3)]))),128))]))])])):g("",!0)])]),e("div",wa,[e("button",{onClick:ee,class:"btn-primary btn-large",disabled:h.value},l(h.value?"Saving...":a.$t("common.buttons.save")),9,ka)])])}}}),Na=re($a,[["__scopeId","data-v-8eb62e58"]]);export{Na as default};
//# sourceMappingURL=SettingsView-BfTOeNDt.js.map
