import{f as tt,r as m,b as D,e as st,o as et,g as l,k as t,z as at,j as v,t as r,U as G,F as A,x as j,R as ot,B as nt,v as lt,n as it,y as ct,u as rt,i as o}from"./vendor-B5QdKGWw.js";import{u as dt,b as g,_ as ut}from"./index-BVa0GAqF.js";import"./utils-i9HKr1_Q.js";const _t={class:"wall-view"},vt={key:0,class:"loading-container"},pt={key:1,class:"error-container"},mt={key:2,class:"wall-content"},ht={class:"wall-header"},yt={class:"wall-info"},ft={class:"wall-avatar"},wt=["src","alt"],gt={class:"wall-details"},bt={class:"wall-title"},kt={key:0,class:"wall-owner"},Ct={key:1,class:"wall-description"},Mt={class:"wall-stats"},It={class:"stat"},Tt={class:"stat-value"},$t={class:"stat"},At={class:"stat-value"},Pt={class:"posts-section"},Lt={key:0,class:"loading-posts"},St={key:1,class:"empty-state"},Ft={key:2,class:"posts-grid"},xt={key:0,class:"ai-generation-status"},Et={class:"progress-bar"},Dt={class:"status-text"},Gt={class:"post-header"},jt=["src","alt"],Ot={class:"post-meta"},Ut={class:"post-author"},Ht={class:"post-time"},Rt={class:"post-content"},Wt=["innerHTML"],Bt={key:1},Nt={key:1,class:"ai-content-preview"},qt={class:"ai-preview-prompt"},Vt={key:0,class:"ai-preview-code"},zt=["onClick"],Jt={key:2,class:"post-media"},Yt=["src","alt"],Kt={class:"post-actions"},Qt={class:"action-btn"},Xt={class:"action-btn"},Zt={class:"action-btn"},ts={key:3,class:"load-more"},ss={class:"modal-content ai-modal"},es={key:0,class:"modal-body"},as={class:"ai-modal-section"},os={class:"ai-prompt-full"},ns={key:0,class:"ai-modal-section ai-stats"},ls={class:"stats-grid"},is={class:"stat-item"},cs={class:"stat-value"},rs={key:0,class:"stat-item"},ds={class:"stat-value"},us={key:1,class:"stat-item"},_s={class:"stat-value"},vs={key:2,class:"stat-item"},ps={class:"stat-value"},ms={key:3,class:"stat-item"},hs={class:"stat-value"},ys={key:1,class:"ai-modal-section"},fs={class:"section-header"},ws={class:"code-block"},gs={key:2,class:"ai-modal-section"},bs={class:"section-header"},ks={class:"code-block"},Cs={key:3,class:"ai-modal-section"},Ms={class:"section-header"},Is={class:"code-block"},P=20,Ts=tt({__name:"WallView",props:{wallId:{}},setup(O){const U=O;rt();const H=lt(),L=dt(),b=m(!0),w=m(!1),y=m(null),_=m(null),p=m([]),k=m(1),S=m(!0);let f=null;const R=D(()=>_.value&&L.user&&_.value.user_id===L.user.id),W=D(()=>{var a;return(a=_.value)!=null&&a.theme?{backgroundColor:_.value.theme}:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"}}),B=a=>{const s=new Date(a),d=new Date().getTime()-s.getTime(),c=Math.floor(d/6e4),u=Math.floor(d/36e5),e=Math.floor(d/864e5);return c<1?"just now":c<60?`${c}m ago`:u<24?`${u}h ago`:e<7?`${e}d ago`:s.toLocaleDateString()},N=async()=>{var a,s,n,d;try{b.value=!0,y.value=null;let c=U.wallId||H.params.wallId;if(!c)throw new Error("No wall identifier provided");let u;if(c==="me"?u=await g.get("/walls/me"):u=await g.get(`/walls/${c}`),u!=null&&u.success&&((a=u==null?void 0:u.data)!=null&&a.wall))_.value=u.data.wall,await C();else throw new Error((u==null?void 0:u.message)||"Wall not found")}catch(c){console.error("Error loading wall:",c),((s=c.response)==null?void 0:s.status)===404?y.value="The requested wall could not be found. It may not exist or you may not have permission to view it.":y.value=((d=(n=c.response)==null?void 0:n.data)==null?void 0:d.message)||c.message||"Failed to load wall"}finally{b.value=!1}},C=async(a=!1)=>{var s;if(_.value)try{a||(w.value=!0);const n=(k.value-1)*P,d=await g.get(`/walls/${_.value.wall_id}/posts?limit=${P}&offset=${n}`);if(d!=null&&d.success&&((s=d==null?void 0:d.data)!=null&&s.posts)){const c=d.data.posts;k.value===1?a?q(c):p.value=c:p.value=[...p.value,...c],S.value=c.length===P,V()}}catch(n){console.error("Error loading posts:",n)}finally{a||(w.value=!1)}},q=a=>{const s=new Map(a.map(n=>[n.post_id,n]));p.value.forEach((n,d)=>{const c=s.get(n.post_id);c&&(n.ai_status!==c.ai_status&&(p.value[d]={...n,...c}),s.delete(n.post_id))}),s.size>0&&(p.value=[...Array.from(s.values()),...p.value])},V=()=>{p.value.some(s=>s.post_type==="ai_app"&&(s.ai_status==="queued"||s.ai_status==="processing"))?z():F()},z=()=>{f||(f=setInterval(async()=>{await C(!0)},3e3))},F=()=>{f&&(clearInterval(f),f=null)},J=()=>{k.value++,C()},Y=()=>{console.log("Create post functionality coming soon")},K=a=>({queued:10,processing:60,completed:100,failed:0})[a]||0,Q=a=>({queued:"Waiting in queue...",processing:"Generating your application...",completed:"Generation complete!",failed:"Generation failed"})[a]||"Processing...",x=(a,s)=>a?a.length<=s?a:a.substring(0,s)+"...":"",i=m(null),M=m(!1),X=async a=>{var s;try{const n=await g.get(`/ai/apps/${a.ai_app_id}`);n!=null&&n.success&&((s=n==null?void 0:n.data)!=null&&s.app)&&(i.value={...a,ai_content:n.data.app},M.value=!0,document.body.style.overflow="hidden")}catch(n){console.error("Error loading AI content:",n)}},I=()=>{M.value=!1,i.value=null,document.body.style.overflow=""},T=(a,s)=>{navigator.clipboard.writeText(a).then(()=>{console.log(`${s} copied to clipboard`)}).catch(n=>{console.error("Failed to copy:",n)})},Z=()=>{var E;if(!((E=i.value)!=null&&E.ai_content))return;const a=i.value.ai_content,u=`<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Generated App</title>
  <style>
${a.css_content||""}
  </style>
</head>
<body>
${a.html_content||""}
  <script>
${a.js_content||""}
  <\/script>
</body>
</html>`,e=new Blob([u],{type:"text/html"}),h=URL.createObjectURL(e),$=document.createElement("a");$.href=h,$.download=`ai-app-${i.value.post_id}.html`,$.click(),URL.revokeObjectURL(h)};return st(()=>{N()}),et(()=>{F(),document.body.style.overflow=""}),(a,s)=>{var n,d,c,u;return o(),l(A,null,[t("div",_t,[b.value?(o(),l("div",vt,[...s[4]||(s[4]=[t("div",{class:"spinner"},null,-1),t("p",null,"Loading wall...",-1)])])):y.value?(o(),l("div",pt,[s[5]||(s[5]=t("h2",null,"Error Loading Wall",-1)),t("p",null,r(y.value),1),t("button",{onClick:s[0]||(s[0]=e=>a.$router.push("/")),class:"btn-primary"},"Go Home")])):_.value?(o(),l("div",mt,[t("div",ht,[t("div",{class:"wall-banner",style:G(W.value)},null,4),t("div",yt,[t("div",ft,[t("img",{src:_.value.owner_avatar||_.value.avatar_url||"/assets/images/default-avatar.svg",alt:_.value.owner_username||_.value.display_name},null,8,wt)]),t("div",gt,[t("h1",bt,r(_.value.display_name),1),_.value.owner_username?(o(),l("p",kt,"by @"+r(_.value.owner_username),1)):v("",!0),_.value.description?(o(),l("p",Ct,r(_.value.description),1)):v("",!0)]),t("div",Mt,[t("div",It,[t("span",Tt,r(_.value.posts_count||0),1),s[6]||(s[6]=t("span",{class:"stat-label"},"Posts",-1))]),t("div",$t,[t("span",At,r(_.value.subscribers_count||0),1),s[7]||(s[7]=t("span",{class:"stat-label"},"Followers",-1))])])])]),t("div",Pt,[s[17]||(s[17]=t("h2",{class:"section-title"},"Posts",-1)),w.value?(o(),l("div",Lt,[...s[8]||(s[8]=[t("div",{class:"spinner"},null,-1),t("p",null,"Loading posts...",-1)])])):p.value.length===0?(o(),l("div",St,[s[9]||(s[9]=t("p",null,"No posts yet on this wall.",-1)),R.value?(o(),l("button",{key:0,onClick:Y,class:"btn-primary"},"Create First Post")):v("",!0)])):(o(),l("div",Ft,[(o(!0),l(A,null,j(p.value,e=>(o(),l("div",{key:e.post_id,class:it(["post-card",{"ai-post":e.post_type==="ai_app"}])},[e.post_type==="ai_app"&&e.ai_status!=="completed"?(o(),l("div",xt,[s[10]||(s[10]=t("div",{class:"status-header"},[t("span",{class:"status-icon"},"ðŸ¤–"),t("h3",null,"AI Application Generating...")],-1)),t("div",Et,[t("div",{class:"progress-fill",style:G({width:K(e.ai_status)+"%"})},null,4)]),t("p",Dt,r(Q(e.ai_status)),1)])):v("",!0),t("div",Gt,[t("img",{src:e.author_avatar||"/assets/images/default-avatar.svg",alt:e.author_username,class:"post-avatar"},null,8,jt),t("div",Ot,[t("span",Ut,"@"+r(e.author_username),1),t("span",Ht,r(B(e.created_at)),1)])]),t("div",Rt,[e.content_html?(o(),l("div",{key:0,innerHTML:e.content_html},null,8,Wt)):(o(),l("p",Bt,r(e.content_text),1))]),e.post_type==="ai_app"&&e.ai_status==="completed"&&e.ai_content?(o(),l("div",Nt,[s[13]||(s[13]=t("div",{class:"ai-preview-header"},[t("span",{class:"preview-icon"},"âœ¨"),t("h4",null,"Generated Application")],-1)),t("div",qt,[s[11]||(s[11]=t("strong",null,"Prompt:",-1)),ct(" "+r(x(e.ai_content.user_prompt,150)),1)]),e.ai_content.html_content?(o(),l("div",Vt,[t("pre",null,r(x(e.ai_content.html_content,200)),1)])):v("",!0),t("button",{onClick:h=>X(e),class:"btn-open-ai"},[...s[12]||(s[12]=[t("span",{class:"icon"},"ðŸ‘ï¸",-1),t("span",null,"Open Full Content",-1)])],8,zt)])):v("",!0),e.media_attachments&&e.media_attachments.length>0?(o(),l("div",Jt,[(o(!0),l(A,null,j(e.media_attachments,h=>(o(),l("img",{key:h.attachment_id,src:h.file_url,alt:h.file_name},null,8,Yt))),128))])):v("",!0),t("div",Kt,[t("button",Qt,[s[14]||(s[14]=t("span",{class:"icon"},"ðŸ‘",-1)),t("span",null,r(e.reaction_count||0),1)]),t("button",Xt,[s[15]||(s[15]=t("span",{class:"icon"},"ðŸ’¬",-1)),t("span",null,r(e.comment_count||0),1)]),t("button",Zt,[s[16]||(s[16]=t("span",{class:"icon"},"ðŸ‘",-1)),t("span",null,r(e.view_count||0),1)])])],2))),128))])),S.value&&!w.value?(o(),l("div",ts,[t("button",{onClick:J,class:"btn-secondary"},"Load More")])):v("",!0)])])):v("",!0)]),(o(),at(nt,{to:"body"},[M.value?(o(),l("div",{key:0,class:"modal-overlay",onClick:ot(I,["self"])},[t("div",ss,[t("div",{class:"modal-header"},[s[18]||(s[18]=t("h2",null,"âœ¨ AI Generated Application",-1)),t("button",{onClick:I,class:"btn-close"},"Ã—")]),i.value?(o(),l("div",es,[t("div",as,[s[19]||(s[19]=t("h3",null,"ðŸ“ Prompt",-1)),t("div",os,r(((n=i.value.ai_content)==null?void 0:n.user_prompt)||"No prompt available"),1)]),i.value.ai_content?(o(),l("div",ns,[s[25]||(s[25]=t("h3",null,"ðŸ“Š Generation Stats",-1)),t("div",ls,[t("div",is,[s[20]||(s[20]=t("span",{class:"stat-label"},"Model:",-1)),t("span",cs,r(i.value.ai_content.generation_model||"Unknown"),1)]),i.value.ai_content.generation_time?(o(),l("div",rs,[s[21]||(s[21]=t("span",{class:"stat-label"},"Time:",-1)),t("span",ds,r((i.value.ai_content.generation_time/1e3).toFixed(2))+"s",1)])):v("",!0),i.value.ai_content.input_tokens?(o(),l("div",us,[s[22]||(s[22]=t("span",{class:"stat-label"},"Input Tokens:",-1)),t("span",_s,r(i.value.ai_content.input_tokens.toLocaleString()),1)])):v("",!0),i.value.ai_content.output_tokens?(o(),l("div",vs,[s[23]||(s[23]=t("span",{class:"stat-label"},"Output Tokens:",-1)),t("span",ps,r(i.value.ai_content.output_tokens.toLocaleString()),1)])):v("",!0),i.value.ai_content.total_tokens?(o(),l("div",ms,[s[24]||(s[24]=t("span",{class:"stat-label"},"Total Tokens:",-1)),t("span",hs,r(i.value.ai_content.total_tokens.toLocaleString()),1)])):v("",!0)])])):v("",!0),(d=i.value.ai_content)!=null&&d.html_content?(o(),l("div",ys,[t("div",fs,[s[26]||(s[26]=t("h3",null,"ðŸŒ HTML",-1)),t("button",{onClick:s[1]||(s[1]=e=>T(i.value.ai_content.html_content,"HTML")),class:"btn-copy-small"},"ðŸ“‹ Copy")]),t("pre",ws,r(i.value.ai_content.html_content),1)])):v("",!0),(c=i.value.ai_content)!=null&&c.css_content?(o(),l("div",gs,[t("div",bs,[s[27]||(s[27]=t("h3",null,"ðŸŽ¨ CSS",-1)),t("button",{onClick:s[2]||(s[2]=e=>T(i.value.ai_content.css_content,"CSS")),class:"btn-copy-small"},"ðŸ“‹ Copy")]),t("pre",ks,r(i.value.ai_content.css_content),1)])):v("",!0),(u=i.value.ai_content)!=null&&u.js_content?(o(),l("div",Cs,[t("div",Ms,[s[28]||(s[28]=t("h3",null,"âš¡ JavaScript",-1)),t("button",{onClick:s[3]||(s[3]=e=>T(i.value.ai_content.js_content,"JavaScript")),class:"btn-copy-small"},"ðŸ“‹ Copy")]),t("pre",Is,r(i.value.ai_content.js_content),1)])):v("",!0)])):v("",!0),t("div",{class:"modal-footer"},[t("button",{onClick:Z,class:"btn-primary"},[...s[29]||(s[29]=[t("span",null,"ðŸ“¥",-1),t("span",null,"Download Full App",-1)])]),t("button",{onClick:I,class:"btn-secondary"},"Close")])])])):v("",!0)]))],64)}}}),Ls=ut(Ts,[["__scopeId","data-v-ffb3b88c"]]);export{Ls as default};
//# sourceMappingURL=WallView-0UgNm3QT.js.map
