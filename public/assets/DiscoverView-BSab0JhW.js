import{r,w as L,f as F,e as W,g as n,k as e,t as l,s as U,v as B,u as H,x as K,K as R,X as j,F as $,z as T,W as x,j as M,p as z,i as a}from"./vendor-Bfvy7Eak.js";import{c as g,g as q,_ as Q}from"./index-C0q8E0dp.js";import"./utils-Cb2jxgch.js";function X(h,w=300){const u=r(h),c=r(h);let i=null;return L(u,d=>{i&&clearTimeout(i),i=setTimeout(()=>{c.value=d},w)}),{value:u,debouncedValue:c,clearDebounce:()=>{i&&(clearTimeout(i),i=null)}}}const A={class:"discover-view"},G={class:"discover-header"},J={class:"search-section"},O={class:"search-container"},Y=["placeholder"],Z={class:"content-section"},I={class:"section-header"},ss={key:0,class:"loading-container"},es={key:1,class:"empty-state"},ts={key:2,class:"walls-carousel"},os=["onClick"],ns={class:"wall-content"},as={class:"wall-owner"},ls={key:0,class:"wall-desc"},is={class:"wall-stats"},rs={class:"content-section"},cs={key:0,class:"loading-container"},us={key:1,class:"empty-state"},ds={key:2,class:"posts-grid"},vs={class:"post-header"},_s=["src","alt"],ps={class:"post-meta"},fs={class:"post-author"},gs={class:"post-time"},ms={class:"post-content"},hs=["innerHTML"],ws={key:1},ys={class:"post-actions"},ks={class:"action-btn"},bs={class:"action-btn"},$s={class:"action-btn"},Ts={class:"content-section"},Ds={key:0,class:"loading-container"},Cs={key:1,class:"empty-state"},Ss={key:2,class:"users-grid"},Us=["src","alt"],Ms={class:"user-username"},Ls={key:0,class:"user-bio"},Ps={class:"user-stats"},Vs=["onClick"],Ns=F({__name:"DiscoverView",setup(h){const w=z(),u=q(),{value:c,debouncedValue:i}=X("",300),m=r("7d"),d=r([]),p=r([]),v=r([]),y=r(!1),k=r(!1),b=r(!1),P=o=>{const s=new Date(o),_=new Date().getTime()-s.getTime(),f=Math.floor(_/36e5),S=Math.floor(_/864e5);return f<1?"just now":f<24?`${f}h ago`:S<7?`${S}d ago`:s.toLocaleDateString()},D=()=>{i.value.trim().length>=2?w.push(`/search?q=${encodeURIComponent(i.value)}`):c.value.trim().length>0&&c.value.trim().length<2&&u.warning("Please enter at least 2 characters to search")};L(i,o=>{o.trim().length>=2&&D()});const C=async()=>{var o;try{y.value=!0;const s=await g.get(`/discover/trending-walls?timeframe=${m.value}&limit=6`);s&&s.data?d.value=s.data.walls||((o=s.data.data)==null?void 0:o.walls)||[]:d.value=[]}catch(s){console.error("Error loading trending walls:",s),d.value=[]}finally{y.value=!1}},V=async()=>{var o;try{k.value=!0;const s=await g.get("/discover/popular-posts?timeframe=7d&limit=10");s&&s.data?p.value=s.data.posts||((o=s.data.data)==null?void 0:o.posts)||[]:p.value=[]}catch(s){console.error("Error loading popular posts:",s),p.value=[]}finally{k.value=!1}},N=async()=>{var o;try{b.value=!0;const s=await g.get("/discover/suggested-users?limit=8");s&&s.data?v.value=s.data.users||((o=s.data.data)==null?void 0:o.users)||[]:v.value=[]}catch(s){console.error("Error loading suggested users:",s),v.value=[]}finally{b.value=!1}},E=async o=>{try{const s=v.value.find(f=>f.user_id===o);if(!s)return;const t=s.is_following,_=s.followers_count;s.is_following=!t,s.followers_count+=s.is_following?1:-1,t?(await g.delete(`/users/${o}/follow`),u.success("Unfollowed successfully")):(await g.post(`/users/${o}/follow`),u.success("Following successfully"))}catch(s){const t=v.value.find(_=>_.user_id===o);t&&(t.is_following=!t.is_following,t.followers_count+=t.is_following?1:-1),u.error(s.message||"Failed to update follow status")}};return W(()=>{C(),V(),N()}),(o,s)=>(a(),n("div",A,[e("div",G,[e("h1",null,l(o.$t("navigation.discover")),1)]),e("div",J,[e("div",O,[s[2]||(s[2]=e("span",{class:"search-icon"},"ðŸ”",-1)),U(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>R(c)?c.value=t:null),type:"text",placeholder:o.$t("common.actions.search")+"...",onKeyup:K(D,["enter"]),class:"search-input"},null,40,Y),[[B,H(c)]])])]),e("section",Z,[e("div",I,[s[4]||(s[4]=e("h2",null,"ðŸ”¥ Trending Walls",-1)),U(e("select",{"onUpdate:modelValue":s[1]||(s[1]=t=>m.value=t),onChange:C,class:"timeframe-select"},[...s[3]||(s[3]=[e("option",{value:"24h"},"Last 24 hours",-1),e("option",{value:"7d"},"Last 7 days",-1),e("option",{value:"30d"},"Last 30 days",-1)])],544),[[j,m.value]])]),y.value?(a(),n("div",ss,[...s[5]||(s[5]=[e("div",{class:"spinner"},null,-1)])])):d.value.length===0?(a(),n("div",es,[...s[6]||(s[6]=[e("p",null,"No trending walls found",-1)])])):(a(),n("div",ts,[(a(!0),n($,null,T(d.value,t=>(a(),n("div",{key:t.wall_id,class:"wall-card",onClick:_=>o.$router.push(`/wall/${t.wall_id}`)},[e("div",{class:"wall-banner",style:x({background:t.theme||"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"})},null,4),e("div",ns,[e("h3",null,l(t.display_name),1),e("p",as,"@"+l(t.owner_username),1),t.description?(a(),n("p",ls,l(t.description),1)):M("",!0),e("div",is,[e("span",null,"ðŸ“ "+l(t.post_count||0),1),e("span",null,"ðŸ‘¥ "+l(t.follower_count||0),1),e("span",null,"ðŸ‘ï¸ "+l(t.view_count||0),1)])])],8,os))),128))]))]),e("section",rs,[s[12]||(s[12]=e("div",{class:"section-header"},[e("h2",null,"â­ Popular Posts")],-1)),k.value?(a(),n("div",cs,[...s[7]||(s[7]=[e("div",{class:"spinner"},null,-1)])])):p.value.length===0?(a(),n("div",us,[...s[8]||(s[8]=[e("p",null,"No popular posts found",-1)])])):(a(),n("div",ds,[(a(!0),n($,null,T(p.value,t=>(a(),n("div",{key:t.post_id,class:"post-card"},[e("div",vs,[e("img",{src:t.author_avatar||"/assets/images/default-avatar.svg",alt:t.author_username,class:"post-avatar"},null,8,_s),e("div",ps,[e("span",fs,"@"+l(t.author_username),1),e("span",gs,l(P(t.created_at)),1)])]),e("div",ms,[t.content_html?(a(),n("div",{key:0,innerHTML:t.content_html},null,8,hs)):(a(),n("p",ws,l(t.content_text),1))]),e("div",ys,[e("button",ks,[s[9]||(s[9]=e("span",null,"ðŸ‘",-1)),e("span",null,l(t.reaction_count||0),1)]),e("button",bs,[s[10]||(s[10]=e("span",null,"ðŸ’¬",-1)),e("span",null,l(t.comment_count||0),1)]),e("button",$s,[s[11]||(s[11]=e("span",null,"ðŸ‘ï¸",-1)),e("span",null,l(t.view_count||0),1)])])]))),128))]))]),e("section",Ts,[s[15]||(s[15]=e("div",{class:"section-header"},[e("h2",null,"ðŸ‘¥ Suggested Users")],-1)),b.value?(a(),n("div",Ds,[...s[13]||(s[13]=[e("div",{class:"spinner"},null,-1)])])):v.value.length===0?(a(),n("div",Cs,[...s[14]||(s[14]=[e("p",null,"No user suggestions available",-1)])])):(a(),n("div",Ss,[(a(!0),n($,null,T(v.value,t=>(a(),n("div",{key:t.user_id,class:"user-card"},[e("img",{src:t.avatar_url||"/assets/images/default-avatar.svg",alt:t.username,class:"user-avatar"},null,8,Us),e("h3",Ms,"@"+l(t.username),1),t.bio?(a(),n("p",Ls,l(t.bio),1)):M("",!0),e("div",Ps,[e("span",null,l(t.followers_count||0)+" followers",1),e("span",null,l(t.posts_count||0)+" posts",1)]),e("button",{onClick:_=>E(t.user_id),class:"btn-follow"},l(t.is_following?o.$t("common.actions.unfollow"):o.$t("common.actions.follow")),9,Vs)]))),128))]))])]))}}),Bs=Q(Ns,[["__scopeId","data-v-4e7aa3a9"]]);export{Bs as default};
//# sourceMappingURL=DiscoverView-BSab0JhW.js.map
