import{c as r,_ as z}from"./index-DN_oDYf5.js";import{r as b,b as N,f as E,g as p,k as i,l as O,W as U,n as T,u as d,j as F,t as h,T as V,m as x,F as M,z as B,D as H,s as W,i as y,Z as J}from"./vendor-Bfvy7Eak.js";const ce={async getFeed(e){return r.get("/posts/feed",e)},async getWallPosts(e,s){return r.get(`/walls/${e}/posts`,s)},async getPost(e){return r.get(`/posts/${e}`)},async createPost(e){const s=new FormData;return s.append("wall_id",e.wall_id.toString()),s.append("content",e.content),e.post_type&&s.append("post_type",e.post_type),e.visibility&&s.append("visibility",e.visibility),e.ai_application_id&&s.append("ai_application_id",e.ai_application_id.toString()),e.media_files&&e.media_files.forEach((c,a)=>{s.append(`media_files[${a}]`,c)}),r.upload("/posts",s)},async updatePost(e,s){return r.patch(`/posts/${e}`,s)},async deletePost(e){return r.delete(`/posts/${e}`)},async reactToPost(e,s){return r.post(`/posts/${e}/reactions`,{reaction_type:s})},async removeReaction(e){return r.delete(`/posts/${e}/reactions`)},async sharePost(e,s,c){return r.post(`/posts/${e}/share`,{wall_id:s,content:c})},async incrementViewCount(e){return r.post(`/posts/${e}/view`)},async batchIncrementViewCounts(e){return r.post("/posts/batch-view",{post_ids:e})},async incrementOpenCount(e){return r.post(`/posts/${e}/open`)}};function L(e,s){const c=b([]),a=b({total:0,by_type:{}}),o=b(null),k=b(!1),w=b(null),R=()=>typeof e=="string"?e:e.value,$=()=>typeof s=="number"?s:s.value,P={like:"ðŸ‘",love:"â¤ï¸",haha:"ðŸ˜‚",wow:"ðŸ˜®",sad:"ðŸ˜¢",angry:"ðŸ˜ "},_={like:"#3b82f6",love:"#ef4444",haha:"#eab308",wow:"#f97316",sad:"#64748b",angry:"#dc2626"},C=async()=>{try{k.value=!0,w.value=null;const t=await r.get(`/reactions/${R()}/${$()}`);if(t&&typeof t=="object"&&"reactions"in t){c.value=Array.isArray(t.reactions)?t.reactions:[],a.value=t.stats||{total:0,by_type:{}};const m=c.value.find(u=>u.user_id===A());o.value=m?m.reaction_type:null}else Array.isArray(t)?(c.value=t,a.value={total:t.length,by_type:{}}):(c.value=[],a.value={total:0,by_type:{}})}catch(t){w.value=t.message||"Failed to load reactions",console.error("Error loading reactions:",t)}finally{k.value=!1}},f=async t=>{const m=o.value,u=a.value.total,n={...a.value.by_type};try{o.value=t,a.value.total++,a.value.by_type[t]=(a.value.by_type[t]||0)+1,await r.post("/reactions",{reactable_type:R(),reactable_id:$(),reaction_type:t}),await C()}catch(l){throw o.value=m,a.value.total=u,a.value.by_type=n,w.value=l.message||"Failed to add reaction",l}},v=async()=>{const t=o.value,m=a.value.total,u={...a.value.by_type};if(t)try{o.value=null,a.value.total--,a.value.by_type[t]&&a.value.by_type[t]--,await r.delete(`/reactions/${R()}/${$()}`),await C()}catch(n){throw o.value=t,a.value.total=m,a.value.by_type=u,w.value=n.message||"Failed to remove reaction",n}},S=async t=>{o.value===t?await v():o.value?(await v(),await f(t)):await f(t)},A=()=>{const t=localStorage.getItem("user");return t?JSON.parse(t).user_id:0},I=N(()=>o.value?P[o.value]:"ðŸ¤"),D=N(()=>o.value?_[o.value]:"#94a3b8");return{reactions:c,stats:a,currentUserReaction:o,loading:k,error:w,reactionIcons:P,reactionColors:_,displayIcon:I,displayColor:D,loadReactions:C,addReaction:f,removeReaction:v,toggleReaction:S}}const Z={class:"reaction-picker-container"},q={class:"reaction-icon"},G={key:0,class:"reaction-count"},K=["onClick","title"],Q={class:"modal-header"},X={class:"modal-body"},Y={class:"reaction-tabs"},ee=["onClick"],te={class:"reaction-users-list"},ae=["src","alt"],se={class:"username"},oe={class:"reaction-emoji"},ne={key:0,class:"empty-state"},le=E({__name:"ReactionPicker",props:{reactableType:{},reactableId:{}},setup(e){const s=e,{reactions:c,stats:a,currentUserReaction:o,reactionIcons:k,displayIcon:w,displayColor:R,loadReactions:$,toggleReaction:P}=L(b(s.reactableType),b(s.reactableId)),_=b(!1),C=b(!1),f=b("all");let v=null;const S=u=>{u.stopPropagation(),_.value=!_.value},A=()=>{v=setTimeout(()=>{_.value=!0},300)},I=()=>{v&&(clearTimeout(v),v=null),setTimeout(()=>{_.value&&(_.value=!1)},200)},D=()=>{v&&(clearTimeout(v),v=null)},t=async u=>{_.value=!1;try{await P(u)}catch(n){console.error("Failed to toggle reaction:",n)}},m=N(()=>f.value==="all"?c.value:c.value.filter(u=>u.reaction_type===f.value));return $(),(u,n)=>(y(),p("div",Z,[i("button",{onClick:S,onMouseenter:A,onMouseleave:I,class:T(["reaction-button",{active:d(o)}]),style:U({color:d(R)})},[i("span",q,h(d(w)),1),d(a).total>0?(y(),p("span",G,h(d(a).total),1)):F("",!0)],38),O(V,{name:"picker-fade"},{default:x(()=>[_.value?(y(),p("div",{key:0,class:"reaction-picker",onMouseenter:D,onMouseleave:I},[(y(!0),p(M,null,B(d(k),(l,g)=>(y(),p("button",{key:g,onClick:j=>t(g),class:T(["reaction-option",{selected:d(o)===g}]),title:g},h(l),11,K))),128))],32)):F("",!0)]),_:1}),O(V,{name:"modal-fade"},{default:x(()=>[C.value?(y(),p("div",{key:0,class:"modal-overlay",onClick:n[3]||(n[3]=l=>C.value=!1)},[i("div",{class:"modal-content",onClick:n[2]||(n[2]=H(()=>{},["stop"]))},[i("div",Q,[n[4]||(n[4]=i("h3",null,"Reactions",-1)),i("button",{onClick:n[0]||(n[0]=l=>C.value=!1),class:"btn-close"},"Ã—")]),i("div",X,[i("div",Y,[i("button",{onClick:n[1]||(n[1]=l=>f.value="all"),class:T(["tab-button",{active:f.value==="all"}])}," All "+h(d(a).total),3),(y(!0),p(M,null,B(d(a).by_type,(l,g)=>W((y(),p("button",{key:g,onClick:j=>f.value=g,class:T(["tab-button",{active:f.value===g}])},h(d(k)[g])+" "+h(l),11,ee)),[[J,l>0]])),128))]),i("div",te,[(y(!0),p(M,null,B(m.value,l=>(y(),p("div",{key:l.reaction_id,class:"reaction-user-item"},[i("img",{src:l.avatar_url||"/assets/images/default-avatar.svg",alt:l.username,class:"user-avatar"},null,8,ae),i("span",se,h(l.username),1),i("span",oe,h(d(k)[l.reaction_type]),1)]))),128)),m.value.length===0?(y(),p("div",ne," No reactions yet ")):F("",!0)])])])])):F("",!0)]),_:1})]))}}),ue=z(le,[["__scopeId","data-v-a24b23af"]]);export{ue as R,ce as p};
//# sourceMappingURL=ReactionPicker-qPdyD_3b.js.map
