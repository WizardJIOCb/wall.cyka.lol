import{f as j,r as d,b as C,e as z,o as R,g as l,j as _,k as s,t as r,U as x,F as T,x as $,v as U,n as O,u as J,i as o}from"./vendor-B5QdKGWw.js";import{u as K,b as y,_ as Q}from"./index-BdoSBcXd.js";import"./utils-i9HKr1_Q.js";const X={class:"wall-view"},Y={key:0,class:"loading-container"},Z={key:1,class:"error-container"},ss={key:2,class:"wall-content"},ts={class:"wall-header"},as={class:"wall-info"},es={class:"wall-avatar"},ls=["src","alt"],os={class:"wall-details"},ns={class:"wall-title"},is={key:0,class:"wall-owner"},rs={key:1,class:"wall-description"},us={class:"wall-stats"},cs={class:"stat"},ds={class:"stat-value"},_s={class:"stat"},vs={class:"stat-value"},ps={class:"posts-section"},ms={key:0,class:"loading-posts"},gs={key:1,class:"empty-state"},fs={key:2,class:"posts-grid"},hs={key:0,class:"ai-generation-status"},ws={class:"progress-bar"},ys={class:"status-text"},bs={class:"post-header"},ks=["src","alt"],Ps={class:"post-meta"},Is={class:"post-author"},Ms={class:"post-time"},Cs={class:"post-content"},xs=["innerHTML"],Ts={key:1},$s={key:1,class:"post-media"},As=["src","alt"],Ls={class:"post-actions"},Fs={class:"action-btn"},Ss={class:"action-btn"},Ws={class:"action-btn"},Ds={key:3,class:"load-more"},b=20,Es=j({__name:"WallView",props:{wallId:{}},setup(A){const L=A;J();const F=U(),k=K(),f=d(!0),g=d(!1),p=d(null),e=d(null),v=d([]),h=d(1),P=d(!0);let m=null;const S=C(()=>e.value&&k.user&&e.value.user_id===k.user.id),W=C(()=>{var n;return(n=e.value)!=null&&n.theme?{backgroundColor:e.value.theme}:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"}}),D=n=>{const t=new Date(n),c=new Date().getTime()-t.getTime(),u=Math.floor(c/6e4),i=Math.floor(c/36e5),M=Math.floor(c/864e5);return u<1?"just now":u<60?`${u}m ago`:i<24?`${i}h ago`:M<7?`${M}d ago`:t.toLocaleDateString()},E=async()=>{var n,t,a,c;try{f.value=!0,p.value=null;let u=L.wallId||F.params.wallId;if(!u)throw new Error("No wall identifier provided");let i;if(u==="me"?i=await y.get("/walls/me"):i=await y.get(`/walls/${u}`),i!=null&&i.success&&((n=i==null?void 0:i.data)!=null&&n.wall))e.value=i.data.wall,await w();else throw new Error((i==null?void 0:i.message)||"Wall not found")}catch(u){console.error("Error loading wall:",u),((t=u.response)==null?void 0:t.status)===404?p.value="The requested wall could not be found. It may not exist or you may not have permission to view it.":p.value=((c=(a=u.response)==null?void 0:a.data)==null?void 0:c.message)||u.message||"Failed to load wall"}finally{f.value=!1}},w=async()=>{var n;if(e.value)try{g.value=!0;const t=(h.value-1)*b,a=await y.get(`/walls/${e.value.wall_id}/posts?limit=${b}&offset=${t}`);a!=null&&a.success&&((n=a==null?void 0:a.data)!=null&&n.posts)&&(h.value===1?v.value=a.data.posts:v.value=[...v.value,...a.data.posts],P.value=a.data.posts.length===b,q())}catch(t){console.error("Error loading posts:",t)}finally{g.value=!1}},q=()=>{v.value.some(t=>t.post_type==="ai_app"&&(t.ai_status==="queued"||t.ai_status==="processing"))?G():I()},G=()=>{m||(m=setInterval(async()=>{await w()},3e3))},I=()=>{m&&(clearInterval(m),m=null)},H=()=>{h.value++,w()},N=()=>{console.log("Create post functionality coming soon")},V=n=>({queued:10,processing:60,completed:100,failed:0})[n]||0,B=n=>({queued:"Waiting in queue...",processing:"Generating your application...",completed:"Generation complete!",failed:"Generation failed"})[n]||"Processing...";return z(()=>{E()}),R(()=>{I()}),(n,t)=>(o(),l("div",X,[f.value?(o(),l("div",Y,[...t[1]||(t[1]=[s("div",{class:"spinner"},null,-1),s("p",null,"Loading wall...",-1)])])):p.value?(o(),l("div",Z,[t[2]||(t[2]=s("h2",null,"Error Loading Wall",-1)),s("p",null,r(p.value),1),s("button",{onClick:t[0]||(t[0]=a=>n.$router.push("/")),class:"btn-primary"},"Go Home")])):e.value?(o(),l("div",ss,[s("div",ts,[s("div",{class:"wall-banner",style:x(W.value)},null,4),s("div",as,[s("div",es,[s("img",{src:e.value.owner_avatar||e.value.avatar_url||"/assets/images/default-avatar.svg",alt:e.value.owner_username||e.value.display_name},null,8,ls)]),s("div",os,[s("h1",ns,r(e.value.display_name),1),e.value.owner_username?(o(),l("p",is,"by @"+r(e.value.owner_username),1)):_("",!0),e.value.description?(o(),l("p",rs,r(e.value.description),1)):_("",!0)]),s("div",us,[s("div",cs,[s("span",ds,r(e.value.posts_count||0),1),t[3]||(t[3]=s("span",{class:"stat-label"},"Posts",-1))]),s("div",_s,[s("span",vs,r(e.value.subscribers_count||0),1),t[4]||(t[4]=s("span",{class:"stat-label"},"Followers",-1))])])])]),s("div",ps,[t[11]||(t[11]=s("h2",{class:"section-title"},"Posts",-1)),g.value?(o(),l("div",ms,[...t[5]||(t[5]=[s("div",{class:"spinner"},null,-1),s("p",null,"Loading posts...",-1)])])):v.value.length===0?(o(),l("div",gs,[t[6]||(t[6]=s("p",null,"No posts yet on this wall.",-1)),S.value?(o(),l("button",{key:0,onClick:N,class:"btn-primary"},"Create First Post")):_("",!0)])):(o(),l("div",fs,[(o(!0),l(T,null,$(v.value,a=>(o(),l("div",{key:a.post_id,class:O(["post-card",{"ai-post":a.post_type==="ai_app"}])},[a.post_type==="ai_app"&&a.ai_status!=="completed"?(o(),l("div",hs,[t[7]||(t[7]=s("div",{class:"status-header"},[s("span",{class:"status-icon"},"ü§ñ"),s("h3",null,"AI Application Generating...")],-1)),s("div",ws,[s("div",{class:"progress-fill",style:x({width:V(a.ai_status)+"%"})},null,4)]),s("p",ys,r(B(a.ai_status)),1)])):_("",!0),s("div",bs,[s("img",{src:a.author_avatar||"/assets/images/default-avatar.svg",alt:a.author_username,class:"post-avatar"},null,8,ks),s("div",Ps,[s("span",Is,"@"+r(a.author_username),1),s("span",Ms,r(D(a.created_at)),1)])]),s("div",Cs,[a.content_html?(o(),l("div",{key:0,innerHTML:a.content_html},null,8,xs)):(o(),l("p",Ts,r(a.content_text),1))]),a.media_attachments&&a.media_attachments.length>0?(o(),l("div",$s,[(o(!0),l(T,null,$(a.media_attachments,c=>(o(),l("img",{key:c.attachment_id,src:c.file_url,alt:c.file_name},null,8,As))),128))])):_("",!0),s("div",Ls,[s("button",Fs,[t[8]||(t[8]=s("span",{class:"icon"},"üëç",-1)),s("span",null,r(a.reaction_count||0),1)]),s("button",Ss,[t[9]||(t[9]=s("span",{class:"icon"},"üí¨",-1)),s("span",null,r(a.comment_count||0),1)]),s("button",Ws,[t[10]||(t[10]=s("span",{class:"icon"},"üëÅ",-1)),s("span",null,r(a.view_count||0),1)])])],2))),128))])),P.value&&!g.value?(o(),l("div",Ds,[s("button",{onClick:H,class:"btn-secondary"},"Load More")])):_("",!0)])])):_("",!0)]))}}),Ns=Q(Es,[["__scopeId","data-v-97b2f9f0"]]);export{Ns as default};
//# sourceMappingURL=WallView-BodFGRTA.js.map
