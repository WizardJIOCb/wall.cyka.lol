import{d as ce,r as w,b as L,f as U,w as re,e as J,g as p,i as l,D as O,k as n,j as b,s as te,v as ae,x as se,u as k,n as G,t as C,q as Y,W as me,l as V,m as A,A as W,B as H,F as q,z as X,o as le,X as de}from"./vendor-vh-Ah70F.js";import{b as F,c as oe,_ as N,u as ie,d as ue,f as ve,e as pe,g as fe,A as Z}from"./index-CMwbdBJJ.js";import"./utils-BgL-d_zS.js";const z={async getFeed(e){return F.get("/posts/feed",e)},async getWallPosts(e,s){return F.get(`/walls/${e}/posts`,s)},async getPost(e){return F.get(`/posts/${e}`)},async createPost(e){const s=new FormData;return s.append("wall_id",e.wall_id.toString()),s.append("content",e.content),e.post_type&&s.append("post_type",e.post_type),e.visibility&&s.append("visibility",e.visibility),e.ai_application_id&&s.append("ai_application_id",e.ai_application_id.toString()),e.media_files&&e.media_files.forEach((t,i)=>{s.append(`media_files[${i}]`,t)}),F.upload("/posts",s)},async updatePost(e,s){return F.patch(`/posts/${e}`,s)},async deletePost(e){return F.delete(`/posts/${e}`)},async reactToPost(e,s){return F.post(`/posts/${e}/reactions`,{reaction_type:s})},async removeReaction(e){return F.delete(`/posts/${e}/reactions`)},async sharePost(e,s,t){return F.post(`/posts/${e}/share`,{wall_id:s,content:t})}},he=ce("posts",()=>{const e=w([]),s=w([]),t=w(1),i=w(1),a=w(!0),c=w(!1),f=w({content_type:"all",time_range:"all",sort_by:"recent"}),_=L(()=>y=>e.value.find(o=>o.id===y)),m=async(y=1,o=!1)=>{var r,P,B;c.value=!0;try{const D=await z.getFeed({page:y,per_page:20,content_type:f.value.content_type!=="all"?f.value.content_type:void 0,time_range:f.value.time_range!=="all"?f.value.time_range:void 0,sort_by:f.value.sort_by}),K=Array.isArray(D.data)?D.data:[];o?s.value=K:s.value.push(...K),t.value=((r=D.pagination)==null?void 0:r.current_page)||y,i.value=((P=D.pagination)==null?void 0:P.total_pages)||1,a.value=((B=D.pagination)==null?void 0:B.has_more)||!1,K.forEach(g=>{const h=e.value.findIndex(j=>j.id===g.id);h>=0?e.value[h]=g:e.value.push(g)})}catch(D){throw console.error("Failed to fetch feed:",D),o&&(s.value=[]),D}finally{c.value=!1}},$=async()=>{a.value&&!c.value&&await m(t.value+1,!1)},v=async()=>{t.value=1,await m(1,!0)};return{posts:e,feedPosts:s,currentPage:t,totalPages:i,hasMore:a,loading:c,filters:f,getPostById:_,fetchFeed:m,loadMore:$,refreshFeed:v,createPost:async y=>{try{const o=await z.createPost(y);return s.value.unshift(o),e.value.unshift(o),o}catch(o){throw console.error("Failed to create post:",o),o}},updatePost:async(y,o)=>{try{const r=await z.updatePost(y,o),P=s.value.findIndex(D=>D.id===y);P>=0&&(s.value[P]=r);const B=e.value.findIndex(D=>D.id===y);return B>=0&&(e.value[B]=r),r}catch(r){throw console.error("Failed to update post:",r),r}},deletePost:async y=>{try{await z.deletePost(y),s.value=s.value.filter(o=>o.id!==y),e.value=e.value.filter(o=>o.id!==y)}catch(o){throw console.error("Failed to delete post:",o),o}},reactToPost:async(y,o)=>{try{await z.reactToPost(y,o);const r=e.value.find(P=>P.id===y);r&&(r.reactions_count=(r.reactions_count||0)+1)}catch(r){throw console.error("Failed to react to post:",r),r}},removeReaction:async y=>{try{await z.removeReaction(y);const o=e.value.find(r=>r.id===y);o&&o.reactions_count>0&&o.reactions_count--}catch(o){throw console.error("Failed to remove reaction:",o),o}},setFilters:y=>{f.value={...f.value,...y},v()},clearFilters:()=>{f.value={content_type:"all",time_range:"all",sort_by:"recent"},v()}}}),ye={class:"form-group"},ge=["placeholder","rows","onKeydown"],_e={class:"form-footer"},we={class:"form-actions"},Ce=["disabled"],$e=["disabled"],be={key:0,class:"error-message"},ke=U({__name:"CommentForm",props:{postId:{},parentCommentId:{},commentId:{},initialContent:{},placeholder:{},rows:{default:3},showCancel:{type:Boolean,default:!0}},emits:["comment-created","comment-updated","cancel"],setup(e,{emit:s}){const t=e,i=s,{t:a}=oe(),c=w(t.initialContent||""),f=w(!1),_=w(null),m=w(null),$=L(()=>c.value.length),v=L(()=>{const S=c.value.trim();return S.length>0&&S.length<=2e3&&!f.value}),d=L(()=>t.commentId?a("comments.updateComment"):t.parentCommentId?a("comments.reply"):a("comments.comment")),u=S=>{const I=m.value;I&&(I.style.height="auto",I.style.height=I.scrollHeight+"px")},R=async()=>{var S,I;if(v.value){f.value=!0,_.value=null;try{let x;t.commentId?(x=await F.patch(`/comments/${t.commentId}`,{content:c.value.trim()}),i("comment-updated",x.data.data)):t.parentCommentId?(x=await F.post(`/comments/${t.parentCommentId}/replies`,{content:c.value.trim()}),i("comment-created",x.data.data)):t.postId&&(x=await F.post(`/posts/${t.postId}/comments`,{content:c.value.trim()}),i("comment-created",x.data.data)),c.value="",m.value&&(m.value.style.height="auto")}catch(x){_.value=((I=(S=x.response)==null?void 0:S.data)==null?void 0:I.message)||a("comments.errorPosting")}finally{f.value=!1}}},E=()=>{c.value=t.initialContent||"",_.value=null,i("cancel")};return re(()=>t.initialContent,S=>{c.value=S||""}),J(()=>{u()}),(S,I)=>(l(),p("form",{onSubmit:O(R,["prevent"]),class:"comment-form"},[n("div",ye,[te(n("textarea",{ref_key:"textareaRef",ref:m,"onUpdate:modelValue":I[0]||(I[0]=x=>c.value=x),placeholder:e.placeholder||k(a)("comments.write"),maxlength:2e3,rows:e.rows,onInput:u,onKeydown:[se(O(R,["meta"]),["enter"]),se(O(R,["ctrl"]),["enter"])],class:"comment-textarea"},null,40,ge),[[ae,c.value]]),n("div",_e,[n("span",{class:G(["char-count",{warning:$.value>1800,error:$.value>2e3}])},C($.value)+" / 2000 ",3),n("div",we,[e.showCancel?(l(),p("button",{key:0,type:"button",onClick:E,class:"btn btn-secondary",disabled:f.value},C(k(a)("comments.cancel")),9,Ce)):b("",!0),n("button",{type:"submit",disabled:!v.value||f.value,class:"btn btn-primary"},C(f.value?k(a)("comments.posting"):d.value),9,$e)])])]),_.value?(l(),p("div",be,C(_.value),1)):b("",!0)],32))}}),ee=N(ke,[["__scopeId","data-v-818beb56"]]),Pe={class:"comment-header"},Ie=["src","alt"],xe={class:"comment-meta"},Se={class:"timestamp"},Me={key:0,class:"edited-badge"},Re={key:0,class:"comment-actions"},Fe=["disabled","title"],De=["title"],Ee={class:"comment-content"},Te=["innerHTML"],Le={class:"comment-footer"},Ve={key:0,class:"user-reaction"},Ae={key:1},Be={key:2,class:"count"},je={key:0,class:"count"},He=["onClick","title"],Ue={key:1,class:"reply-form"},Ne={key:2,class:"replies"},ze=U({__name:"CommentItem",props:{comment:{},postId:{},depth:{default:0},maxDepth:{default:4}},emits:["reply-created","comment-updated","comment-deleted"],setup(e,{emit:s}){const t=e,i=s,{t:a}=oe(),c=ie(),f=w(!1),_=w(!1),m=w(!1),$=w(!0),v=[{type:"like",emoji:"ðŸ‘",label:"Like"},{type:"dislike",emoji:"ðŸ‘Ž",label:"Dislike"},{type:"heart",emoji:"â¤ï¸",label:"Love"},{type:"laugh",emoji:"ðŸ˜‚",label:"Laugh"},{type:"wow",emoji:"ðŸ˜®",label:"Wow"},{type:"sad",emoji:"ðŸ˜¢",label:"Sad"},{type:"angry",emoji:"ðŸ˜ ",label:"Angry"}],d=L(()=>{var g;return((g=c.user)==null?void 0:g.user_id)===t.comment.author_id}),u=L(()=>{const g=new Date(t.comment.created_at).getTime();return(Date.now()-g)/1e3/60<15}),R=L(()=>{if(t.depth===0)return"0";const g=window.innerWidth>768?24:12;return`${t.depth*g}px`}),E=g=>{const h=new Date(g),Q=new Date().getTime()-h.getTime(),M=Math.floor(Q/6e4);if(M<1)return a("comments.justNow");if(M<60)return a("comments.minutesAgo",{count:M});const T=Math.floor(M/60);if(T<24)return a("comments.hoursAgo",{count:T});const ne=Math.floor(T/24);return ne<7?a("comments.daysAgo",{count:ne}):h.toLocaleDateString()},S=g=>g>=1e6?(g/1e6).toFixed(1)+"M":g>=1e3?(g/1e3).toFixed(1)+"K":g.toString(),I=g=>{const h=v.find(j=>j.type===g);return(h==null?void 0:h.emoji)||"ðŸ‘"},x=()=>{u.value&&(f.value=!0)},y=async()=>{if(confirm(a("comments.deleteConfirm")))try{await F.delete(`/comments/${t.comment.comment_id}`),i("comment-deleted",t.comment.comment_id)}catch(g){console.error("Failed to delete comment:",g)}},o=()=>{_.value=!_.value,_.value&&(m.value=!1)},r=()=>{$.value=!$.value},P=()=>{m.value=!m.value,m.value&&(_.value=!1)},B=async g=>{try{const h=await F.post(`/comments/${t.comment.comment_id}/reactions`,{reaction_type:g});t.comment.reaction_count=h.data.data.reaction_count,t.comment.like_count=h.data.data.like_count,t.comment.dislike_count=h.data.data.dislike_count,h.data.data.action==="removed"?t.comment.user_reaction=null:t.comment.user_reaction=g,m.value=!1}catch(h){console.error("Failed to react:",h)}},D=g=>{f.value=!1,i("comment-updated",g)},K=g=>{_.value=!1,t.comment.replies||(t.comment.replies=[]),t.comment.replies.push(g),t.comment.reply_count++,i("reply-created",g)};return(g,h)=>{const j=Y("router-link"),Q=Y("CommentItem",!0);return l(),p("div",{class:G(["comment-item",`depth-${e.depth}`]),style:me({marginLeft:R.value})},[n("div",Pe,[n("img",{src:e.comment.author_avatar||"/default-avatar.png",alt:e.comment.author_name,class:"avatar"},null,8,Ie),n("div",xe,[V(j,{to:`/users/${e.comment.author_id}`,class:"author-name"},{default:A(()=>[W(C(e.comment.author_name),1)]),_:1},8,["to"]),n("span",Se,C(E(e.comment.created_at)),1),e.comment.is_edited?(l(),p("span",Me,C(k(a)("comments.edited")),1)):b("",!0)]),d.value?(l(),p("div",Re,[n("button",{onClick:x,disabled:!u.value,title:u.value?k(a)("comments.edit"):k(a)("comments.editExpired"),class:"action-btn"},[...h[7]||(h[7]=[n("span",null,"âœï¸",-1)])],8,Fe),n("button",{onClick:y,title:k(a)("comments.delete"),class:"action-btn"},[...h[8]||(h[8]=[n("span",null,"ðŸ—‘ï¸",-1)])],8,De)])):b("",!0)]),n("div",Ee,[f.value?(l(),H(ee,{key:1,"comment-id":e.comment.comment_id,"initial-content":e.comment.content_text,"show-cancel":!0,rows:2,onCommentUpdated:D,onCancel:h[0]||(h[0]=M=>f.value=!1)},null,8,["comment-id","initial-content"])):(l(),p("p",{key:0,innerHTML:e.comment.content_html},null,8,Te))]),n("div",Le,[n("button",{class:G(["reaction-btn",{active:e.comment.user_reaction}]),onClick:P},[e.comment.user_reaction?(l(),p("span",Ve,C(I(e.comment.user_reaction)),1)):(l(),p("span",Ae,"ðŸ‘")),e.comment.reaction_count>0?(l(),p("span",Be,C(S(e.comment.reaction_count)),1)):b("",!0)],2),e.depth<e.maxDepth?(l(),p("button",{key:0,onClick:o,class:"reply-btn"},[W(C(k(a)("comments.reply"))+" ",1),e.comment.reply_count>0?(l(),p("span",je," ("+C(e.comment.reply_count)+") ",1)):b("",!0)])):b("",!0),e.comment.reply_count>0&&e.comment.replies?(l(),p("button",{key:1,onClick:r,class:"collapse-btn"},C($.value?k(a)("comments.hideReplies"):k(a)("comments.showReplies")),1)):b("",!0)]),m.value?(l(),p("div",{key:0,class:"reaction-picker",onClick:h[2]||(h[2]=O(()=>{},["stop"]))},[(l(),p(q,null,X(v,M=>n("button",{key:M.type,onClick:T=>B(M.type),class:G(["reaction-option",{selected:e.comment.user_reaction===M.type}]),title:M.label},C(M.emoji),11,He)),64)),n("button",{onClick:h[1]||(h[1]=M=>m.value=!1),class:"close-picker"}," âœ• ")])):b("",!0),_.value?(l(),p("div",Ue,[V(ee,{"post-id":e.postId,"parent-comment-id":e.comment.comment_id,placeholder:k(a)("comments.writeReply"),rows:2,onCommentCreated:K,onCancel:h[3]||(h[3]=M=>_.value=!1)},null,8,["post-id","parent-comment-id","placeholder"])])):b("",!0),$.value&&e.comment.replies&&e.comment.replies.length>0?(l(),p("div",Ne,[(l(!0),p(q,null,X(e.comment.replies,M=>(l(),H(Q,{key:M.comment_id,comment:M,"post-id":e.postId,depth:e.depth+1,"max-depth":e.maxDepth,onReplyCreated:h[4]||(h[4]=T=>g.$emit("reply-created",T)),onCommentUpdated:h[5]||(h[5]=T=>g.$emit("comment-updated",T)),onCommentDeleted:h[6]||(h[6]=T=>g.$emit("comment-deleted",T))},null,8,["comment","post-id","depth","max-depth"]))),128))])):b("",!0)],6)}}}),We=N(ze,[["__scopeId","data-v-eb97aa55"]]),Ke={class:"comment-section"},Oe={class:"comment-section-header"},qe={class:"section-title"},Xe={class:"comment-controls"},Ge={value:"created_asc"},Je={value:"created_desc"},Qe={value:"reactions"},Ye={key:0,class:"comment-form-container"},Ze={key:1,class:"loading-state"},et={key:2,class:"empty-state"},tt={key:3,class:"comments-list"},ot={key:5,class:"loading-more"},nt=U({__name:"CommentSection",props:{postId:{},initialComments:{default:()=>[]},allowComments:{type:Boolean,default:!0}},setup(e){const s=e,{t}=oe(),i=w(s.initialComments),a=w(!1),c=w(!1),f=w("created_asc"),_=w(0),m=w(null),$=L(()=>i.value.filter(o=>!o.parent_comment_id)),v=async()=>{a.value=!0;try{const o=await F.get(`/posts/${s.postId}/comments`,{params:{sort:f.value,limit:50}});i.value=o.data.data.comments||[],c.value=o.data.data.has_more||!1,_.value=o.data.data.count||0,d()}catch(o){console.error("Failed to fetch comments:",o)}finally{a.value=!1}},d=()=>{const o=new Map;i.value.forEach(r=>{r.replies=[],o.set(r.comment_id,r)}),i.value.forEach(r=>{if(r.parent_comment_id){const P=o.get(r.parent_comment_id);P&&P.replies&&P.replies.push(r)}})},u=async()=>{console.log("Load more comments")},R=o=>{i.value.unshift(o),_.value++,d()},E=o=>{_.value++},S=o=>{const r=i.value.findIndex(P=>P.comment_id===o.comment_id);r!==-1&&(i.value[r]={...i.value[r],...o},d())},I=o=>{i.value=i.value.filter(r=>r.comment_id!==o),_.value--,d()},x=()=>{m.value=window.setInterval(()=>{a.value||v()},1e4)},y=()=>{m.value&&(clearInterval(m.value),m.value=null)};return J(()=>{i.value.length===0?v():(d(),_.value=i.value.length),x()}),le(()=>{y()}),(o,r)=>(l(),p("div",Ke,[n("div",Oe,[n("h3",qe,C(k(t)("comments.title"))+" ("+C(_.value)+") ",1),n("div",Xe,[te(n("select",{"onUpdate:modelValue":r[0]||(r[0]=P=>f.value=P),class:"sort-select",onChange:v},[n("option",Ge,C(k(t)("comments.sortOldest")),1),n("option",Je,C(k(t)("comments.sortNewest")),1),n("option",Qe,C(k(t)("comments.sortReactions")),1)],544),[[de,f.value]])])]),e.allowComments?(l(),p("div",Ye,[V(ee,{"post-id":e.postId,"show-cancel":!1,onCommentCreated:R},null,8,["post-id"])])):b("",!0),a.value&&i.value.length===0?(l(),p("div",Ze,[r[1]||(r[1]=n("div",{class:"spinner"},null,-1)),n("p",null,C(k(t)("comments.loading")),1)])):i.value.length===0?(l(),p("div",et,[n("p",null,C(k(t)("comments.noComments")),1)])):(l(),p("div",tt,[(l(!0),p(q,null,X($.value,P=>(l(),H(We,{key:P.comment_id,comment:P,"post-id":e.postId,depth:0,"max-depth":4,onReplyCreated:E,onCommentUpdated:S,onCommentDeleted:I},null,8,["comment","post-id"]))),128))])),c.value&&!a.value?(l(),p("button",{key:4,onClick:u,class:"load-more-btn"},C(k(t)("comments.loadMore")),1)):b("",!0),a.value&&i.value.length>0?(l(),p("div",ot,[...r[2]||(r[2]=[n("div",{class:"spinner-small"},null,-1)])])):b("",!0)]))}}),st=N(nt,[["__scopeId","data-v-972002bb"]]),at={class:"post-card"},lt={class:"post-header"},it={class:"post-author"},ct={class:"post-time"},rt=["innerHTML"],mt={key:0,class:"post-media"},dt=["src"],ut={class:"post-actions"},vt={key:0},pt={key:0},ft={key:0},ht=U({__name:"PostCard",props:{post:{}},emits:["edit","delete","comment","share","react"],setup(e,{emit:s}){const t=e,i=s,a=ie(),c=w(!1),f=L(()=>!1),_=L(()=>{var d;return((d=a.user)==null?void 0:d.id)===t.post.user_id}),m=d=>ve(d),$=()=>i("react","like"),v=()=>{c.value=!c.value};return(d,u)=>{var E,S,I,x;const R=Y("router-link");return l(),p("article",at,[n("div",lt,[V(ue,{src:(E=e.post.user)==null?void 0:E.avatar_url,name:((S=e.post.user)==null?void 0:S.display_name)||((I=e.post.user)==null?void 0:I.username),size:"md"},null,8,["src","name"]),n("div",it,[V(R,{to:`/profile/${(x=e.post.user)==null?void 0:x.username}`,class:"author-name"},{default:A(()=>{var y,o;return[W(C(((y=e.post.user)==null?void 0:y.display_name)||((o=e.post.user)==null?void 0:o.username)),1)]}),_:1},8,["to"]),n("span",ct,C(m(e.post.created_at)),1)]),_.value?(l(),H(pe,{key:0,position:"bottom-right"},{trigger:A(()=>[...u[3]||(u[3]=[n("button",{class:"btn-icon"},"â‹®",-1)])]),default:A(()=>[n("button",{class:"dropdown-item",onClick:u[0]||(u[0]=y=>d.$emit("edit"))},"Edit"),n("button",{class:"dropdown-item danger",onClick:u[1]||(u[1]=y=>d.$emit("delete"))},"Delete")]),_:1})):b("",!0)]),n("div",{class:"post-content",innerHTML:e.post.content_html||e.post.content},null,8,rt),e.post.media&&e.post.media.length?(l(),p("div",mt,[(l(!0),p(q,null,X(e.post.media,y=>(l(),p("img",{key:y.id,src:y.file_path,alt:"Media"},null,8,dt))),128))])):b("",!0),n("div",ut,[n("button",{class:"action-btn",onClick:$},[n("span",null,C(f.value?"â¤ï¸":"ðŸ¤"),1),e.post.reactions_count?(l(),p("span",vt,C(e.post.reactions_count),1)):b("",!0)]),n("button",{class:"action-btn",onClick:v},[u[4]||(u[4]=n("span",null,"ðŸ’¬",-1)),e.post.comments_count?(l(),p("span",pt,C(e.post.comments_count),1)):b("",!0)]),n("button",{class:"action-btn",onClick:u[2]||(u[2]=y=>d.$emit("share"))},[u[5]||(u[5]=n("span",null,"ðŸ”„",-1)),e.post.shares_count?(l(),p("span",ft,C(e.post.shares_count),1)):b("",!0)])]),c.value?(l(),H(st,{key:1,"post-id":e.post.post_id,"allow-comments":!0},null,8,["post-id"])):b("",!0)])}}}),yt=N(ht,[["__scopeId","data-v-1391c0e5"]]),gt={class:"post-list"},_t={key:0,class:"loading"},wt={key:1,class:"end-message"},Ct=U({__name:"PostList",props:{posts:{},loading:{type:Boolean},hasMore:{type:Boolean}},emits:["react","comment","share","edit","delete"],setup(e,{emit:s}){const t=s,i=(m,$)=>t("react",m,$),a=m=>t("comment",m),c=m=>t("share",m),f=m=>t("edit",m),_=m=>t("delete",m);return(m,$)=>(l(),p("div",gt,[(l(!0),p(q,null,X(e.posts,v=>(l(),H(yt,{key:v.id,post:v,onReact:d=>i(v.id,d),onComment:d=>a(v.id),onShare:d=>c(v.id),onEdit:d=>f(v.id),onDelete:d=>_(v.id)},null,8,["post","onReact","onComment","onShare","onEdit","onDelete"]))),128)),e.loading?(l(),p("div",_t,[...$[0]||($[0]=[n("div",{class:"spinner"},null,-1),n("p",null,"Loading posts...",-1)])])):b("",!0),!e.loading&&!e.hasMore?(l(),p("div",wt,"No more posts")):b("",!0)]))}}),$t=N(Ct,[["__scopeId","data-v-220026a9"]]),bt={class:"form-actions"},kt=U({__name:"PostCreator",props:{modelValue:{type:Boolean},wallId:{}},emits:["update:modelValue","submit"],setup(e,{emit:s}){const t=e,i=s,a=w(t.modelValue),c=w(""),f=w([]),_=w(),m=w(!1),$=d=>{const u=d.target;u.files&&(f.value=Array.from(u.files))},v=()=>{c.value.trim()&&(i("submit",{wall_id:t.wallId,content:c.value,media_files:f.value}),c.value="",f.value=[],i("update:modelValue",!1))};return(d,u)=>(l(),H(fe,{modelValue:a.value,"onUpdate:modelValue":u[2]||(u[2]=R=>a.value=R),title:"Create Post",size:"md"},{default:A(()=>[n("form",{onSubmit:O(v,["prevent"])},[te(n("textarea",{"onUpdate:modelValue":u[0]||(u[0]=R=>c.value=R),placeholder:"What's on your mind?",rows:"6",class:"post-input"},null,512),[[ae,c.value]]),n("div",bt,[n("input",{type:"file",ref_key:"fileInput",ref:_,onChange:$,accept:"image/*,video/*",multiple:"",hidden:""},null,544),V(Z,{type:"button",variant:"ghost",onClick:u[1]||(u[1]=R=>{var E;return(E=_.value)==null?void 0:E.click()})},{default:A(()=>[...u[3]||(u[3]=[W("ðŸ“Ž Add Media",-1)])]),_:1}),V(Z,{type:"submit",variant:"primary",loading:m.value},{default:A(()=>[...u[4]||(u[4]=[W("Post",-1)])]),_:1},8,["loading"])])],32)]),_:1},8,["modelValue"]))}}),Pt=N(kt,[["__scopeId","data-v-3d8180a6"]]),It=(e,s={threshold:.8})=>{const t=w(),i=w(!1),a=()=>{if(!t.value||i.value)return;const{scrollTop:c,scrollHeight:f,clientHeight:_}=t.value;(c+_)/f>=s.threshold&&(i.value=!0,e(),setTimeout(()=>{i.value=!1},1e3))};return J(()=>{var c;(c=t.value)==null||c.addEventListener("scroll",a),window.addEventListener("scroll",a)}),le(()=>{var c;(c=t.value)==null||c.removeEventListener("scroll",a),window.removeEventListener("scroll",a)}),{targetRef:t,isLoading:i}},xt={class:"home-view"},St={class:"feed-header"},Mt=U({__name:"HomeView",setup(e){const s=he(),t=w(!1),i=w(1);J(()=>{s.fetchFeed()}),It(()=>{s.hasMore&&!s.loading&&s.loadMore()});const a=async v=>{await s.createPost(v)},c=(v,d)=>{s.reactToPost(v,d)},f=v=>{console.log("Comment on post",v)},_=v=>{console.log("Share post",v)},m=v=>{console.log("Edit post",v)},$=async v=>{confirm("Delete this post?")&&await s.deletePost(v)};return(v,d)=>(l(),p("div",xt,[n("div",St,[d[3]||(d[3]=n("h1",null,"Home Feed",-1)),V(Z,{variant:"primary",onClick:d[0]||(d[0]=u=>t.value=!0)},{default:A(()=>[...d[2]||(d[2]=[W("+ Create Post",-1)])]),_:1})]),V($t,{posts:k(s).feedPosts,loading:k(s).loading,"has-more":k(s).hasMore,onReact:c,onComment:f,onShare:_,onEdit:m,onDelete:$},null,8,["posts","loading","has-more"]),V(Pt,{modelValue:t.value,"onUpdate:modelValue":d[1]||(d[1]=u=>t.value=u),"wall-id":i.value,onSubmit:a},null,8,["modelValue","wall-id"])]))}}),Et=N(Mt,[["__scopeId","data-v-b469c97f"]]);export{Et as default};
//# sourceMappingURL=HomeView-COprR5TE.js.map
