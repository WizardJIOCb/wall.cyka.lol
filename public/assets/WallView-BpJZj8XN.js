import{f as st,r as f,b as M,e as et,o as ot,g as a,k as t,j as u,n as K,t as l,U as at,i as e,z as Z,F as Q,x as tt,R as lt,B as it,v as rt,y as ct,u as dt}from"./vendor-B5QdKGWw.js";import{_ as nt,u as ut,b as R}from"./index-DbEcB6fw.js";import"./utils-i9HKr1_Q.js";const vt={class:"ai-generation-progress"},_t={class:"progress-header"},pt={class:"status-icon-container"},mt={class:"status-info"},ft={class:"status-subtitle"},ht={class:"progress-bar-container"},gt={class:"progress-bar"},kt={key:0,class:"progress-text"},yt={class:"progress-label"},bt={key:0,class:"stats-grid"},wt={key:0,class:"stat-card"},$t={class:"stat-content"},Ct={class:"stat-value"},Tt={key:1,class:"stat-card"},It={class:"stat-content"},St={class:"stat-value"},Mt={class:"stat-card"},Pt={class:"stat-content"},Et={class:"stat-value"},At={key:2,class:"stat-card"},Lt={class:"stat-content"},Gt={class:"stat-value"},Ft={key:1,class:"completion-stats"},jt={class:"token-breakdown"},Dt={class:"token-item"},Ut={class:"token-value"},xt={class:"token-item"},Ot={class:"token-value"},Nt={class:"token-item total"},Rt={class:"token-value"},Bt={key:2,class:"error-message"},Ht=st({__name:"AIGenerationProgress",props:{jobId:{},autoStart:{type:Boolean}},emits:["complete","error"],setup(B,{expose:H,emit:q}){const F=B,P=q,h=f("queued"),y=f(0),_=f(0),g=f(0),I=f(0),E=f(0),T=f(0),O=f(0),S=f(0),A=f("");let b=null,w=null,L=0;const j=M(()=>h.value==="processing"),W=M(()=>{switch(h.value){case"queued":return"⏳";case"processing":return"🤖";case"completed":return"✅";case"failed":return"❌";default:return"❓"}}),D=M(()=>`status-${h.value}`),J=M(()=>{switch(h.value){case"queued":return"Generation Queued";case"processing":return"AI is Generating...";case"completed":return"Generation Complete";case"failed":return"Generation Failed";default:return"Unknown Status"}}),V=M(()=>h.value==="processing"&&_.value>0?`Generating content at ${g.value.toFixed(1)} tokens/sec`:"");function G(C){return C.toLocaleString()}function N(C){const i=Math.floor(C/1e3),k=Math.floor(i/60),d=Math.floor(k/60);return d>0?`${d}h ${k%60}m ${i%60}s`:k>0?`${k}m ${i%60}s`:`${i}s`}function U(){if(b)return;const i=`http://localhost:8080/api/v1/ai/generation/${F.jobId}/progress`;L=Date.now(),w=window.setInterval(()=>{h.value==="processing"&&(I.value=Date.now()-L)},100),b=new EventSource(i),b.addEventListener("progress",k=>{const d=JSON.parse(k.data);if(h.value=d.status,y.value=d.progress||0,_.value=d.current_tokens||0,g.value=d.tokens_per_second||0,E.value=d.estimated_remaining||0,T.value=d.prompt_tokens||0,O.value=d.completion_tokens||0,S.value=d.total_tokens||0,d.elapsed_time){const x=d.elapsed_time,n=Date.now()-L;Math.abs(x-n)>1e3&&(L=Date.now()-x)}}),b.addEventListener("complete",k=>{const d=JSON.parse(k.data);h.value="completed",y.value=100,S.value=d.total_tokens||S.value,d.elapsed_time&&(I.value=d.elapsed_time),r(),P("complete",d)}),b.addEventListener("error",k=>{let d={};try{d=JSON.parse(k.data)}catch{d={error:"Connection error"}}h.value="failed",A.value=d.error||"Unknown error occurred",r(),P("error",A.value)}),b.onerror=()=>{console.error("SSE connection error")}}function r(){b&&(b.close(),b=null),w&&(clearInterval(w),w=null)}return et(()=>{F.autoStart!==!1&&U()}),ot(()=>{r()}),H({startTracking:U,stopTracking:r}),(C,i)=>(e(),a("div",vt,[t("div",_t,[t("div",pt,[t("span",{class:K(["status-icon",D.value])},l(W.value),3)]),t("div",mt,[t("h3",null,l(J.value),1),t("p",ft,l(V.value),1)])]),t("div",ht,[t("div",gt,[t("div",{class:K(["progress-fill",{"progress-pulsing":j.value}]),style:at({width:y.value+"%"})},[y.value>10?(e(),a("span",kt,l(y.value)+"%",1)):u("",!0)],6)]),t("span",yt,l(y.value)+"%",1)]),j.value||h.value==="completed"?(e(),a("div",bt,[_.value>0?(e(),a("div",wt,[i[1]||(i[1]=t("div",{class:"stat-icon"},"🔢",-1)),t("div",$t,[t("div",Ct,l(G(_.value)),1),i[0]||(i[0]=t("div",{class:"stat-label"},"Tokens Generated",-1))])])):u("",!0),g.value>0?(e(),a("div",Tt,[i[3]||(i[3]=t("div",{class:"stat-icon"},"⚡",-1)),t("div",It,[t("div",St,l(g.value.toFixed(1)),1),i[2]||(i[2]=t("div",{class:"stat-label"},"Tokens/sec",-1))])])):u("",!0),t("div",Mt,[i[5]||(i[5]=t("div",{class:"stat-icon"},"⏱️",-1)),t("div",Pt,[t("div",Et,l(N(I.value)),1),i[4]||(i[4]=t("div",{class:"stat-label"},"Elapsed Time",-1))])]),E.value>0&&j.value?(e(),a("div",At,[i[7]||(i[7]=t("div",{class:"stat-icon"},"⏳",-1)),t("div",Lt,[t("div",Gt,l(N(E.value)),1),i[6]||(i[6]=t("div",{class:"stat-label"},"Est. Remaining",-1))])])):u("",!0)])):u("",!0),h.value==="completed"&&S.value>0?(e(),a("div",Ft,[i[11]||(i[11]=t("div",{class:"completion-badge"},[t("span",{class:"badge-icon"},"✨"),t("span",{class:"badge-text"},"Generation Complete!")],-1)),t("div",jt,[t("div",Dt,[i[8]||(i[8]=t("span",{class:"token-label"},"Input Tokens:",-1)),t("span",Ut,l(G(T.value)),1)]),t("div",xt,[i[9]||(i[9]=t("span",{class:"token-label"},"Output Tokens:",-1)),t("span",Ot,l(G(O.value)),1)]),t("div",Nt,[i[10]||(i[10]=t("span",{class:"token-label"},"Total:",-1)),t("span",Rt,l(G(S.value)),1)])])])):u("",!0),h.value==="failed"&&A.value?(e(),a("div",Bt,[i[12]||(i[12]=t("span",{class:"error-icon"},"⚠️",-1)),t("span",null,l(A.value),1)])):u("",!0)]))}}),qt=nt(Ht,[["__scopeId","data-v-79aeb680"]]),Wt={class:"wall-view"},Jt={key:0,class:"loading-container"},Vt={key:1,class:"error-container"},zt={key:2,class:"wall-content"},Qt={class:"wall-header"},Yt={class:"wall-info"},Kt={class:"wall-avatar"},Xt=["src","alt"],Zt={class:"wall-details"},ts={class:"wall-title"},ss={key:0,class:"wall-owner"},es={key:1,class:"wall-description"},os={class:"wall-stats"},as={class:"stat"},ns={class:"stat-value"},ls={class:"stat"},is={class:"stat-value"},rs={class:"posts-section"},cs={key:0,class:"loading-posts"},ds={key:1,class:"empty-state"},us={key:2,class:"posts-grid"},vs={class:"post-header"},_s=["src","alt"],ps={class:"post-meta"},ms={class:"post-author"},fs={class:"post-time"},hs={class:"post-content"},gs=["innerHTML"],ks={key:1},ys={key:1,class:"ai-content-preview"},bs={class:"ai-preview-prompt"},ws={key:0,class:"ai-preview-code"},$s=["onClick"],Cs={key:2,class:"post-media"},Ts=["src","alt"],Is={class:"post-actions"},Ss={class:"action-btn"},Ms={class:"action-btn"},Ps={class:"action-btn"},Es={key:3,class:"load-more"},As={class:"modal-content ai-modal"},Ls={key:0,class:"modal-body"},Gs={class:"ai-modal-section"},Fs={class:"ai-prompt-full"},js={key:0,class:"ai-modal-section ai-stats"},Ds={class:"stats-grid"},Us={class:"stat-item"},xs={class:"stat-value"},Os={key:0,class:"stat-item"},Ns={class:"stat-value"},Rs={key:1,class:"stat-item"},Bs={class:"stat-value"},Hs={key:2,class:"stat-item"},qs={class:"stat-value"},Ws={key:3,class:"stat-item"},Js={class:"stat-value"},Vs={key:1,class:"ai-modal-section"},zs={class:"section-header"},Qs={class:"code-block"},Ys={key:2,class:"ai-modal-section"},Ks={class:"section-header"},Xs={class:"code-block"},Zs={key:3,class:"ai-modal-section"},te={class:"section-header"},se={class:"code-block"},Y=20,ee=st({__name:"WallView",props:{wallId:{}},setup(B){const H=B;dt();const q=rt(),F=ut(),P=f(!0),h=f(!1),y=f(null),_=f(null),g=f([]),I=f(1),E=f(!0);let T=null;const O=M(()=>_.value&&F.user&&_.value.user_id===F.user.id),S=M(()=>{var n;return(n=_.value)!=null&&n.theme?{backgroundColor:_.value.theme}:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"}}),A=n=>{const s=new Date(n),p=new Date().getTime()-s.getTime(),v=Math.floor(p/6e4),m=Math.floor(p/36e5),o=Math.floor(p/864e5);return v<1?"just now":v<60?`${v}m ago`:m<24?`${m}h ago`:o<7?`${o}d ago`:s.toLocaleDateString()},b=async()=>{var n,s,c,p;try{P.value=!0,y.value=null;let v=H.wallId||q.params.wallId;if(!v)throw new Error("No wall identifier provided");let m;if(v==="me"?m=await R.get("/walls/me"):m=await R.get(`/walls/${v}`),m!=null&&m.success&&((n=m==null?void 0:m.data)!=null&&n.wall))_.value=m.data.wall,await w();else throw new Error((m==null?void 0:m.message)||"Wall not found")}catch(v){console.error("Error loading wall:",v),((s=v.response)==null?void 0:s.status)===404?y.value="The requested wall could not be found. It may not exist or you may not have permission to view it.":y.value=((p=(c=v.response)==null?void 0:c.data)==null?void 0:p.message)||v.message||"Failed to load wall"}finally{P.value=!1}},w=async(n=!1)=>{var s;if(_.value)try{n||(h.value=!0);const c=(I.value-1)*Y,p=await R.get(`/walls/${_.value.wall_id}/posts?limit=${Y}&offset=${c}`);if(p!=null&&p.success&&((s=p==null?void 0:p.data)!=null&&s.posts)){const v=p.data.posts;I.value===1?n?L(v):g.value=v:g.value=[...g.value,...v],E.value=v.length===Y,j()}}catch(c){console.error("Error loading posts:",c)}finally{n||(h.value=!1)}},L=n=>{const s=new Map(n.map(c=>[c.post_id,c]));g.value.forEach((c,p)=>{const v=s.get(c.post_id);v&&(c.ai_status!==v.ai_status&&(g.value[p]={...c,...v}),s.delete(c.post_id))}),s.size>0&&(g.value=[...Array.from(s.values()),...g.value])},j=()=>{g.value.some(s=>s.post_type==="ai_app"&&(s.ai_status==="queued"||s.ai_status==="processing"))?W():D()},W=()=>{T||(T=setInterval(async()=>{await w(!0)},3e3))},D=()=>{T&&(clearInterval(T),T=null)},J=()=>{I.value++,w()},V=()=>{console.log("Create post functionality coming soon")},G=async n=>{console.log("Generation completed for post:",n.post_id),await w(),D()},N=(n,s)=>{console.error("Generation failed for post:",n.post_id,s),w()},U=(n,s)=>n?n.length<=s?n:n.substring(0,s)+"...":"",r=f(null),C=f(!1),i=async n=>{var s;try{const c=await R.get(`/ai/apps/${n.ai_app_id}`);c!=null&&c.success&&((s=c==null?void 0:c.data)!=null&&s.app)&&(r.value={...n,ai_content:c.data.app},C.value=!0,document.body.style.overflow="hidden")}catch(c){console.error("Error loading AI content:",c)}},k=()=>{C.value=!1,r.value=null,document.body.style.overflow=""},d=(n,s)=>{navigator.clipboard.writeText(n).then(()=>{console.log(`${s} copied to clipboard`)}).catch(c=>{console.error("Failed to copy:",c)})},x=()=>{var X;if(!((X=r.value)!=null&&X.ai_content))return;const n=r.value.ai_content,m=`<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Generated App</title>
  <style>
${n.css_content||""}
  </style>
</head>
<body>
${n.html_content||""}
  <script>
${n.js_content||""}
  <\/script>
</body>
</html>`,o=new Blob([m],{type:"text/html"}),$=URL.createObjectURL(o),z=document.createElement("a");z.href=$,z.download=`ai-app-${r.value.post_id}.html`,z.click(),URL.revokeObjectURL($)};return et(()=>{b()}),ot(()=>{D(),document.body.style.overflow=""}),(n,s)=>{var c,p,v,m;return e(),a(Q,null,[t("div",Wt,[P.value?(e(),a("div",Jt,[...s[4]||(s[4]=[t("div",{class:"spinner"},null,-1),t("p",null,"Loading wall...",-1)])])):y.value?(e(),a("div",Vt,[s[5]||(s[5]=t("h2",null,"Error Loading Wall",-1)),t("p",null,l(y.value),1),t("button",{onClick:s[0]||(s[0]=o=>n.$router.push("/")),class:"btn-primary"},"Go Home")])):_.value?(e(),a("div",zt,[t("div",Qt,[t("div",{class:"wall-banner",style:at(S.value)},null,4),t("div",Yt,[t("div",Kt,[t("img",{src:_.value.owner_avatar||_.value.avatar_url||"/assets/images/default-avatar.svg",alt:_.value.owner_username||_.value.display_name},null,8,Xt)]),t("div",Zt,[t("h1",ts,l(_.value.display_name),1),_.value.owner_username?(e(),a("p",ss,"by @"+l(_.value.owner_username),1)):u("",!0),_.value.description?(e(),a("p",es,l(_.value.description),1)):u("",!0)]),t("div",os,[t("div",as,[t("span",ns,l(_.value.posts_count||0),1),s[6]||(s[6]=t("span",{class:"stat-label"},"Posts",-1))]),t("div",ls,[t("span",is,l(_.value.subscribers_count||0),1),s[7]||(s[7]=t("span",{class:"stat-label"},"Followers",-1))])])])]),t("div",rs,[s[16]||(s[16]=t("h2",{class:"section-title"},"Posts",-1)),h.value?(e(),a("div",cs,[...s[8]||(s[8]=[t("div",{class:"spinner"},null,-1),t("p",null,"Loading posts...",-1)])])):g.value.length===0?(e(),a("div",ds,[s[9]||(s[9]=t("p",null,"No posts yet on this wall.",-1)),O.value?(e(),a("button",{key:0,onClick:V,class:"btn-primary"},"Create First Post")):u("",!0)])):(e(),a("div",us,[(e(!0),a(Q,null,tt(g.value,o=>(e(),a("div",{key:o.post_id,class:K(["post-card",{"ai-post":o.post_type==="ai_app"}])},[o.post_type==="ai_app"&&(o.ai_status==="queued"||o.ai_status==="processing")&&o.job_id?(e(),Z(qt,{key:0,jobId:o.job_id,"auto-start":!0,onComplete:$=>G(o),onError:$=>N(o,$)},null,8,["jobId","onComplete","onError"])):u("",!0),t("div",vs,[t("img",{src:o.author_avatar||"/assets/images/default-avatar.svg",alt:o.author_username,class:"post-avatar"},null,8,_s),t("div",ps,[t("span",ms,"@"+l(o.author_username),1),t("span",fs,l(A(o.created_at)),1)])]),t("div",hs,[o.content_html?(e(),a("div",{key:0,innerHTML:o.content_html},null,8,gs)):(e(),a("p",ks,l(o.content_text),1))]),o.post_type==="ai_app"&&o.ai_status==="completed"&&o.ai_content?(e(),a("div",ys,[s[12]||(s[12]=t("div",{class:"ai-preview-header"},[t("span",{class:"preview-icon"},"✨"),t("h4",null,"Generated Application")],-1)),t("div",bs,[s[10]||(s[10]=t("strong",null,"Prompt:",-1)),ct(" "+l(U(o.ai_content.user_prompt,150)),1)]),o.ai_content.html_content?(e(),a("div",ws,[t("pre",null,l(U(o.ai_content.html_content,200)),1)])):u("",!0),t("button",{onClick:$=>i(o),class:"btn-open-ai"},[...s[11]||(s[11]=[t("span",{class:"icon"},"👁️",-1),t("span",null,"Open Full Content",-1)])],8,$s)])):u("",!0),o.media_attachments&&o.media_attachments.length>0?(e(),a("div",Cs,[(e(!0),a(Q,null,tt(o.media_attachments,$=>(e(),a("img",{key:$.attachment_id,src:$.file_url,alt:$.file_name},null,8,Ts))),128))])):u("",!0),t("div",Is,[t("button",Ss,[s[13]||(s[13]=t("span",{class:"icon"},"👍",-1)),t("span",null,l(o.reaction_count||0),1)]),t("button",Ms,[s[14]||(s[14]=t("span",{class:"icon"},"💬",-1)),t("span",null,l(o.comment_count||0),1)]),t("button",Ps,[s[15]||(s[15]=t("span",{class:"icon"},"👁",-1)),t("span",null,l(o.view_count||0),1)])])],2))),128))])),E.value&&!h.value?(e(),a("div",Es,[t("button",{onClick:J,class:"btn-secondary"},"Load More")])):u("",!0)])])):u("",!0)]),(e(),Z(it,{to:"body"},[C.value?(e(),a("div",{key:0,class:"modal-overlay",onClick:lt(k,["self"])},[t("div",As,[t("div",{class:"modal-header"},[s[17]||(s[17]=t("h2",null,"✨ AI Generated Application",-1)),t("button",{onClick:k,class:"btn-close"},"×")]),r.value?(e(),a("div",Ls,[t("div",Gs,[s[18]||(s[18]=t("h3",null,"📝 Prompt",-1)),t("div",Fs,l(((c=r.value.ai_content)==null?void 0:c.user_prompt)||"No prompt available"),1)]),r.value.ai_content?(e(),a("div",js,[s[24]||(s[24]=t("h3",null,"📊 Generation Stats",-1)),t("div",Ds,[t("div",Us,[s[19]||(s[19]=t("span",{class:"stat-label"},"Model:",-1)),t("span",xs,l(r.value.ai_content.generation_model||"Unknown"),1)]),r.value.ai_content.generation_time?(e(),a("div",Os,[s[20]||(s[20]=t("span",{class:"stat-label"},"Time:",-1)),t("span",Ns,l((r.value.ai_content.generation_time/1e3).toFixed(2))+"s",1)])):u("",!0),r.value.ai_content.input_tokens?(e(),a("div",Rs,[s[21]||(s[21]=t("span",{class:"stat-label"},"Input Tokens:",-1)),t("span",Bs,l(r.value.ai_content.input_tokens.toLocaleString()),1)])):u("",!0),r.value.ai_content.output_tokens?(e(),a("div",Hs,[s[22]||(s[22]=t("span",{class:"stat-label"},"Output Tokens:",-1)),t("span",qs,l(r.value.ai_content.output_tokens.toLocaleString()),1)])):u("",!0),r.value.ai_content.total_tokens?(e(),a("div",Ws,[s[23]||(s[23]=t("span",{class:"stat-label"},"Total Tokens:",-1)),t("span",Js,l(r.value.ai_content.total_tokens.toLocaleString()),1)])):u("",!0)])])):u("",!0),(p=r.value.ai_content)!=null&&p.html_content?(e(),a("div",Vs,[t("div",zs,[s[25]||(s[25]=t("h3",null,"🌐 HTML",-1)),t("button",{onClick:s[1]||(s[1]=o=>d(r.value.ai_content.html_content,"HTML")),class:"btn-copy-small"},"📋 Copy")]),t("pre",Qs,l(r.value.ai_content.html_content),1)])):u("",!0),(v=r.value.ai_content)!=null&&v.css_content?(e(),a("div",Ys,[t("div",Ks,[s[26]||(s[26]=t("h3",null,"🎨 CSS",-1)),t("button",{onClick:s[2]||(s[2]=o=>d(r.value.ai_content.css_content,"CSS")),class:"btn-copy-small"},"📋 Copy")]),t("pre",Xs,l(r.value.ai_content.css_content),1)])):u("",!0),(m=r.value.ai_content)!=null&&m.js_content?(e(),a("div",Zs,[t("div",te,[s[27]||(s[27]=t("h3",null,"⚡ JavaScript",-1)),t("button",{onClick:s[3]||(s[3]=o=>d(r.value.ai_content.js_content,"JavaScript")),class:"btn-copy-small"},"📋 Copy")]),t("pre",se,l(r.value.ai_content.js_content),1)])):u("",!0)])):u("",!0),t("div",{class:"modal-footer"},[t("button",{onClick:x,class:"btn-primary"},[...s[28]||(s[28]=[t("span",null,"📥",-1),t("span",null,"Download Full App",-1)])]),t("button",{onClick:k,class:"btn-secondary"},"Close")])])])):u("",!0)]))],64)}}}),le=nt(ee,[["__scopeId","data-v-ebbe8737"]]);export{le as default};
//# sourceMappingURL=WallView-BpJZj8XN.js.map
